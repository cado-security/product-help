"use strict";(self.webpackChunkproduct_help=self.webpackChunkproduct_help||[]).push([[455],{26859:(e,o,s)=>{s.r(o),s.d(o,{assets:()=>a,contentTitle:()=>i,default:()=>m,frontMatter:()=>r,metadata:()=>c,toc:()=>l});var t=s(74848),n=s(28453);const r={title:"Memory analysis",hide_title:!0,sidebar_position:3},i="How to Collect Process Memory with Cado",c={id:"cado/discovery-import/data-types/memory",title:"Memory analysis",description:"You can perform a memory acquisition of a Windows or Linux system using Cado Host by navigating to Import > Cado Host within the platform and running the pre-generated script on the host device. For detailed instructions, see here. Note that process memory collection is not currently supported on macOS.",source:"@site/docs/cado/discovery-import/data-types/memory.md",sourceDirName:"cado/discovery-import/data-types",slug:"/cado/discovery-import/data-types/memory",permalink:"/cado/discovery-import/data-types/memory",draft:!1,unlisted:!1,editUrl:"https://github.com/cado-security/product-help/tree/master/docs/cado/discovery-import/data-types/memory.md",tags:[],version:"current",lastUpdatedAt:1738331018,formattedLastUpdatedAt:"Jan 31, 2025",sidebarPosition:3,frontMatter:{title:"Memory analysis",hide_title:!0,sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Log & artifact types",permalink:"/cado/discovery-import/data-types/logs"},next:{title:"Cloud import sources",permalink:"/cado/discovery-import/data-types/import-types"}},a={},l=[{value:"Enabling Memory Collection",id:"enabling-memory-collection",level:3},{value:"Acquiring Memory from AWS EC2",id:"acquiring-memory-from-aws-ec2",level:2},{value:"Collecting Memory from Containers",id:"collecting-memory-from-containers",level:2},{value:"Processed Memory",id:"processed-memory",level:2}];function d(e){const o={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,n.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.h1,{id:"how-to-collect-process-memory-with-cado",children:"How to Collect Process Memory with Cado"}),"\n",(0,t.jsxs)(o.p,{children:["You can perform a memory acquisition of a Windows or Linux system using Cado Host by navigating to ",(0,t.jsx)(o.strong,{children:"Import > Cado Host"})," within the platform and running the pre-generated script on the host device. For detailed instructions, see ",(0,t.jsx)(o.a,{href:"https://docs.cadosecurity.com/cado-host/deploy",children:"here"}),". Note that process memory collection is not currently supported on macOS."]}),"\n",(0,t.jsx)(o.h3,{id:"enabling-memory-collection",children:"Enabling Memory Collection"}),"\n",(0,t.jsxs)(o.p,{children:["In the console and within Cado Host, make sure to enable the options to collect memory. You can also optionally enable ",(0,t.jsx)(o.strong,{children:"Extended Memory Collection"})," to capture larger process memory files, particularly useful on Windows systems, although this can slow down the collection process."]}),"\n",(0,t.jsx)(o.p,{children:(0,t.jsx)(o.img,{alt:"Enable Memory",src:s(77950).A+"",width:"2120",height:"644"})}),"\n",(0,t.jsxs)(o.p,{children:["Cado collects memory from individual processes as ",(0,t.jsx)(o.code,{children:".mem"}),' files, which can be found in the "process_dumps" folder. This method provides more reliable analysis compared to older versions, using the Cado-branded open-source tool ',(0,t.jsx)(o.a,{href:"https://github.com/cado-security/varc",children:"varc"}),"."]}),"\n",(0,t.jsx)(o.h2,{id:"acquiring-memory-from-aws-ec2",children:"Acquiring Memory from AWS EC2"}),"\n",(0,t.jsxs)(o.p,{children:["To acquire memory from Linux systems in EC2, use the ",(0,t.jsx)(o.strong,{children:"Alternate Acquisition"})," option under ",(0,t.jsx)(o.strong,{children:"Import > EC2"}),":"]}),"\n",(0,t.jsx)(o.p,{children:(0,t.jsx)(o.img,{alt:"AWS Memory",src:s(36010).A+"",width:"1648",height:"284"})}),"\n",(0,t.jsxs)(o.p,{children:["This requires that the AWS SSM agent is running on the EC2 instance and registered within AWS Systems Manager. If the SSM agent is not available, you can still acquire memory by connecting to the machine via SSH or RDP and running Cado Host from ",(0,t.jsx)(o.strong,{children:"Import > Cado Host"}),". This method also works for Windows systems."]}),"\n",(0,t.jsx)(o.h2,{id:"collecting-memory-from-containers",children:"Collecting Memory from Containers"}),"\n",(0,t.jsxs)(o.p,{children:["Cado will attempt to collect memory from containers (e.g., ECS, EKS, AKS) by default. Some specifics from our ",(0,t.jsx)(o.a,{href:"https://github.com/cado-security/varc",children:"testing"}),":"]}),"\n",(0,t.jsxs)(o.ul,{children:["\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.strong,{children:"AWS Lambda"}),": Successfully dumps process memory by default, but requires manual execution within the Lambda function."]}),"\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.strong,{children:"EKS on EC2"}),": Successfully dumps process memory by default."]}),"\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.strong,{children:"ECS on Fargate"}),": Requires enabling ",(0,t.jsx)(o.code,{children:"CAP_SYS_PTRACE"})," in the task definition to collect process memory."]}),"\n"]}),"\n",(0,t.jsx)(o.h2,{id:"processed-memory",children:"Processed Memory"}),"\n",(0,t.jsx)(o.p,{children:"Once the memory collection is complete, you can browse the file system through the Cado UI, view file contents that were in memory at the time, and analyze information on running processes and network connections."}),"\n",(0,t.jsxs)(o.ul,{children:["\n",(0,t.jsxs)(o.li,{children:["\n",(0,t.jsxs)(o.p,{children:[(0,t.jsx)(o.strong,{children:"Collected memory files"}),' are stored in the "process_dumps" folder:']}),"\n",(0,t.jsx)(o.p,{children:(0,t.jsx)(o.img,{alt:"Collected Memory",src:s(18274).A+"",width:"1138",height:"1028"})}),"\n"]}),"\n",(0,t.jsxs)(o.li,{children:["\n",(0,t.jsxs)(o.p,{children:[(0,t.jsx)(o.strong,{children:"Running process information"})," is stored in ",(0,t.jsx)(o.code,{children:"processes.json"}),":"]}),"\n",(0,t.jsx)(o.p,{children:(0,t.jsx)(o.img,{alt:"Process Info",src:s(95326).A+"",width:"3144",height:"936"})}),"\n"]}),"\n",(0,t.jsxs)(o.li,{children:["\n",(0,t.jsxs)(o.p,{children:[(0,t.jsx)(o.strong,{children:"Network connections"})," are recorded in ",(0,t.jsx)(o.code,{children:"network.json"}),", open files in ",(0,t.jsx)(o.code,{children:"open_files.json"}),", and files collected from memory are stored in the ",(0,t.jsx)(o.code,{children:"collected_files"})," folder."]}),"\n"]}),"\n"]})]})}function m(e={}){const{wrapper:o}={...(0,n.R)(),...e.components};return o?(0,t.jsx)(o,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},36010:(e,o,s)=>{s.d(o,{A:()=>t});const t=s.p+"assets/images/alternate-ec2-1d44379783163049a09c15fbf9a92565.png"},18274:(e,o,s)=>{s.d(o,{A:()=>t});const t=s.p+"assets/images/collected-memory-ac9e487a30fdc244204f920483edb251.png"},77950:(e,o,s)=>{s.d(o,{A:()=>t});const t=s.p+"assets/images/enable-memory-611c6a142978636715479e16a276acf5.png"},95326:(e,o,s)=>{s.d(o,{A:()=>t});const t=s.p+"assets/images/proccess-info-318e967e706cca9767f7ae2f2533b8c3.png"},28453:(e,o,s)=>{s.d(o,{R:()=>i,x:()=>c});var t=s(96540);const n={},r=t.createContext(n);function i(e){const o=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(o):{...o,...e}}),[o,e])}function c(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:i(e.components),t.createElement(r.Provider,{value:o},e.children)}}}]);