"use strict";(self.webpackChunkproduct_help=self.webpackChunkproduct_help||[]).push([[6843],{48575:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>c,toc:()=>a});var r=t(74848),n=t(28453);const i={title:"Cross account permissions",hide_title:!0,sidebar_position:3},o="Minimal Permissions for cross account imports",c={id:"cado/deploy/azure/azure-scoping",title:"Cross account permissions",description:"By default, the Cado platform uses Azure contributor roles for cross-account permissions, it is possible to use custom roles to granularly scope the permissions required.",source:"@site/docs/cado/deploy/azure/azure-scoping.md",sourceDirName:"cado/deploy/azure",slug:"/cado/deploy/azure/azure-scoping",permalink:"/cado/deploy/azure/azure-scoping",draft:!1,unlisted:!1,editUrl:"https://github.com/cado-security/product-help/tree/master/docs/cado/deploy/azure/azure-scoping.md",tags:[],version:"current",lastUpdatedAt:1748356963,formattedLastUpdatedAt:"May 27, 2025",sidebarPosition:3,frontMatter:{title:"Cross account permissions",hide_title:!0,sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Minimal Deployment Guide",permalink:"/cado/deploy/azure/azure-quickstart-deployment"},next:{title:"Platform encryption in Azure",permalink:"/cado/deploy/azure/data-encryption-overview"}},d={},a=[{value:"Valid Scopes",id:"valid-scopes",level:2},{value:"Storage Account",id:"storage-account",level:2},{value:"Example",id:"example",level:3},{value:"Compute and Activity Logs",id:"compute-and-activity-logs",level:2},{value:"Example",id:"example-1",level:3},{value:"Azure Kubernetes Service",id:"azure-kubernetes-service",level:2},{value:"Example",id:"example-2",level:3}];function l(e){const s={code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,n.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.h1,{id:"minimal-permissions-for-cross-account-imports",children:"Minimal Permissions for cross account imports"}),"\n",(0,r.jsx)(s.p,{children:"By default, the Cado platform uses Azure contributor roles for cross-account permissions, it is possible to use custom roles to granularly scope the permissions required."}),"\n",(0,r.jsx)(s.h2,{id:"valid-scopes",children:"Valid Scopes"}),"\n",(0,r.jsx)(s.p,{children:"There are three ways to assign scope to the following permissions, these and their effects are explained below:"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Assignable Scope"}),(0,r.jsx)(s.th,{children:"Effect"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"/providers/Microsoft.Management/managementGroups/<<GROUP ID>>"})}),(0,r.jsx)(s.td,{children:"Allows access to all resources in the management group where the Cado app registration was created, typically allows access at the root of an Azure tenancy."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"/subscription/<<Subscription ID>>"})}),(0,r.jsx)(s.td,{children:"Allows access to all resources, within a given subscription, in the tenant where the Cado app registration was created."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"/subscription/<<Subscription ID>>/resourceGroups/<<Resource Group>>"})}),(0,r.jsx)(s.td,{children:"Allows access to a specific resource group, within a given subscription, in the tenant where the Cado app registration was created."})]})]})]}),"\n",(0,r.jsx)(s.h2,{id:"storage-account",children:"Storage Account"}),"\n",(0,r.jsx)(s.p,{children:"This is a scoped down replacement for the Storage Account Contributor role, the following are a list of permissions required for Azure blob storage acquisitions:"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Permission"}),(0,r.jsx)(s.th,{children:"Purpose"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"Microsoft.Resources/subscriptions/resourceGroups/read"})}),(0,r.jsx)(s.td,{children:"Retrieves or lists resource groups."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"Microsoft.Storage/storageAccounts/read"})}),(0,r.jsx)(s.td,{children:"Retrieves the storage account with the given account."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"Microsoft.Storage/storageAccounts/listKeys/action"})}),(0,r.jsx)(s.td,{children:"Retrieves access keys for the storage account."})]})]})]}),"\n",(0,r.jsx)(s.h3,{id:"example",children:"Example"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-json",children:'{\n    "properties": {\n        "roleName": "Cado Storage Role",\n        "description": "Required by Cado for blob based acquisitions",\n        "assignableScopes": [\n            "<<YOUR SCOPE HERE>>"\n        ],\n        "permissions": [\n            {\n                "actions": [\n                    "Microsoft.Resources/subscriptions/resourceGroups/read",\n                    "Microsoft.Storage/storageAccounts/read",\n                    "Microsoft.Storage/storageAccounts/listKeys/action"\n                ],\n                "notActions": [],\n                "dataActions": [],\n                "notDataActions": []\n            }\n        ]\n    }\n}\n'})}),"\n",(0,r.jsx)(s.h2,{id:"compute-and-activity-logs",children:"Compute and Activity Logs"}),"\n",(0,r.jsx)(s.p,{children:"This is a scoped down replacement for the Virtual Machine Contributor, Disk Snapshot Contributor, and Monitoring Contributor roles.  The following are the permissions needed for virtual machine and activity log acquisitions:"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Permission"}),(0,r.jsx)(s.th,{children:"Effect"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"Microsoft.Compute/snapshots/write"})}),(0,r.jsx)(s.td,{children:"Create a new snapshot, or update an existing one."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"Microsoft.Compute/snapshots/read"})}),(0,r.jsx)(s.td,{children:"Retrieve the properties of a snapshot."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"Microsoft.Compute/snapshots/delete"})}),(0,r.jsx)(s.td,{children:"Delete a snapshot."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"Microsoft.Compute/snapshots/beginGetAccess/action"})}),(0,r.jsx)(s.td,{children:"Get the SAS URI of a snapshot for download."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"endGetAccess/actionMicrosoft.Compute/snapshots/"})}),(0,r.jsx)(s.td,{children:"Revoke a SAS URI of a given snapshot."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"Microsoft.Compute/disks/beginGetAccess/action"})}),(0,r.jsx)(s.td,{children:"Get the SAS URI of a disk for download."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"Microsoft.Compute/disks/read"})}),(0,r.jsx)(s.td,{children:"Retrieve the properties of a disk."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"Microsoft.Compute/virtualMachines/read"})}),(0,r.jsx)(s.td,{children:"Retrieve the properties of a virtual machine"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"Microsoft.Compute/virtualMachines/runCommand/action"})}),(0,r.jsx)(s.td,{children:"Execute a predefined script on a virtual machine."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"Microsoft.Insights/eventtypes/values/read"})}),(0,r.jsx)(s.td,{children:"Retrieve activity log events."})]})]})]}),"\n",(0,r.jsx)(s.h3,{id:"example-1",children:"Example"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-json",children:'{\n    "properties": {\n        "roleName": "Cado Compute and Activity Log Role",\n        "description": "Required by Cado for virtual machine based acquisitions",\n        "assignableScopes": [\n            "<<YOUR SCOPE HERE>>"\n        ],\n        "permissions": [\n            {\n                "actions": [\n                    "Microsoft.Compute/snapshots/read",\n                    "Microsoft.Compute/snapshots/write",\n                    "Microsoft.Compute/snapshots/delete",\n                    "Microsoft.Compute/snapshots/beginGetAccess/action",\n                    "Microsoft.Compute/snapshots/endGetAccess/action",\n                    "Microsoft.Compute/disks/beginGetAccess/action",\n                    "Microsoft.Compute/disks/read",\n                    "Microsoft.Compute/virtualMachines/read",\n                    "Microsoft.Compute/virtualMachines/runCommand/action",\n                    "Microsoft.Insights/eventtypes/values/read"\n                ],\n                "notActions": [],\n                "dataActions": [],\n                "notDataActions": []\n            }\n        ]\n    }\n}\n'})}),"\n",(0,r.jsx)(s.h2,{id:"azure-kubernetes-service",children:"Azure Kubernetes Service"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Permission"}),(0,r.jsx)(s.th,{children:"Effect"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"Microsoft.Resources/subscriptions/operationresults/read"})}),(0,r.jsx)(s.td,{children:"Retrieve subscription operation results."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"Microsoft.Resources/subscriptions/read"})}),(0,r.jsx)(s.td,{children:"Retrieve a list of subscriptions."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"Microsoft.Resources/subscriptions/resourceGroups/read"})}),(0,r.jsx)(s.td,{children:"Retrieve or list resource groups."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"Microsoft.ContainerService/managedClusters/read"})}),(0,r.jsx)(s.td,{children:"Retrieve a managed cluster."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"Microsoft.ContainerService/managedClusters/runCommand/action"})}),(0,r.jsx)(s.td,{children:"Run a command against a managed kubernetes cluster."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"Microsoft.ContainerService/managedClusters/commandResults/read"})}),(0,r.jsx)(s.td,{children:"Retrieve the result of a previously issued command."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"Microsoft.ContainerService/managedClusters/privateEndpointConnections/read"})}),(0,r.jsx)(s.td,{children:"Retrieve a private endpoint connection."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"Microsoft.ContainerService/managedClusters/listClusterAdminCredential/action"})}),(0,r.jsx)(s.td,{children:"List the cluster admin credential of a managed cluster."})]})]})]}),"\n",(0,r.jsx)(s.h3,{id:"example-2",children:"Example"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-json",children:'{\n    "properties": {\n        "roleName": "Cado Kubernetes role",\n        "description": "Required by Cado for AKS based acquisitions",\n        "assignableScopes": [\n            "<<YOUR SCOPE HERE>>"\n        ],\n        "permissions": [\n            {\n                "actions": [\n                    "Microsoft.Resources/subscriptions/operationresults/read",\n                    "Microsoft.Resources/subscriptions/read",\n                    "Microsoft.Resources/subscriptions/resourceGroups/read",\n                    "Microsoft.ContainerService/managedClusters/read",\n                    "Microsoft.ContainerService/managedClusters/runCommand/action",\n                    "Microsoft.ContainerService/managedClusters/commandResults/read",\n                    "Microsoft.ContainerService/managedClusters/privateEndpointConnections/read",\n                    "Microsoft.ContainerService/managedClusters/listClusterAdminCredential/action"\n                ],\n                "notActions": [],\n                "dataActions": [],\n                "notDataActions": []\n            }\n        ]\n    }\n}\n'})})]})}function h(e={}){const{wrapper:s}={...(0,n.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},28453:(e,s,t)=>{t.d(s,{R:()=>o,x:()=>c});var r=t(96540);const n={},i=r.createContext(n);function o(e){const s=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),r.createElement(i.Provider,{value:s},e.children)}}}]);