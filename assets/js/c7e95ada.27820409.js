"use strict";(self.webpackChunkproduct_help=self.webpackChunkproduct_help||[]).push([[4942],{7250:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>l});var i=n(5893),s=n(1151);const o={title:"Automation Rules (Beta)",hide_title:!0,sidebar_position:3},a="Configuring Automation Rules",r={id:"cado-response/discovery-import/automation",title:"Automation Rules (Beta)",description:"This feature is currently in beta - to enable this feature go to Settings > Experiments",source:"@site/docs/cado-response/discovery-import/automation.md",sourceDirName:"cado-response/discovery-import",slug:"/cado-response/discovery-import/automation",permalink:"/cado-response/discovery-import/automation",draft:!1,unlisted:!1,editUrl:"https://github.com/cado-security/product-help/tree/master/docs/cado-response/discovery-import/automation.md",tags:[],version:"current",lastUpdatedAt:1711466913,formattedLastUpdatedAt:"Mar 26, 2024",sidebarPosition:3,frontMatter:{title:"Automation Rules (Beta)",hide_title:!0,sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Managing Projects",permalink:"/cado-response/discovery-import/projects"},next:{title:"Readiness (Beta)",permalink:"/cado-response/discovery-import/readiness"}},c={},l=[{value:"Creating a Scope",id:"creating-a-scope",level:2},{value:"Creating an Environment",id:"creating-an-environment",level:2},{value:"Creating a Rule",id:"creating-a-rule",level:2},{value:"Permissions Required",id:"permissions-required",level:3},{value:"Managing Rules",id:"managing-rules",level:2},{value:"Example Scenario",id:"example-scenario",level:2}];function d(e){const t={em:"em",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h1,{id:"configuring-automation-rules",children:"Configuring Automation Rules"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"This feature is currently in beta - to enable this feature go to Settings > Experiments"})}),"\n",(0,i.jsx)(t.p,{children:"The Cado platform allows you to define automation rules to better prepare for incidents in cloud environments. These automation rules allow you to define in advance"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"What data you want to collect"}),"\n",(0,i.jsx)(t.li,{children:"The alert triggers that will trigger a response"}),"\n",(0,i.jsx)(t.li,{children:"Against which cloud resources, and"}),"\n",(0,i.jsx)(t.li,{children:"What response actions you want to take"}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"Automation in Cado is based upon three main concepts"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Scopes"})," - Scopes are sets of cloud resources within a single cloud provider (currently only AWS supported). These cloud resources may be defined by the region and/or account in which they reside, the service (e.g. EC2, S3), and any tags applied to those resources"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Environments"})," - Environments are sets of one or more scopes that you want to treat similarly - for example an application that spans multiple services across multiple cloud environments"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Rules"})," - Rules are sets of actions that will automatically take place in the event that an alert gets triggered"]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"to give an example of how the rules work lets take the following. A GuardDuty Alert has been raised with a severirty level of 5, the alert is for an EC2 that has been compromised, we then check the automation rules to determine if ther is a rule set up for GuardDuty alerts for EC2  in region & accouint the EC2 reside in. If a rule matches we then prform the investigation based on the Investigation type defined in the rule i.e full investigation. After the import is complete we can check the click the automated investigation tab to see if all malicous and suspispious activity in relation to the compromised EC2. You can then select the piece of evidence and view the cloud resource there a panel will open with the metadata and actions tab. the metadata tab is just metadata about the resource and the actions tab is the remediationactions that can be preformed on the compromised resource. To autmate the remediation actions you can enable this in the settings -> advanced which will do the above until the full investiagation is complete and will automatically invoke the actions defined in the automation rules for malicious or suspicious activity"}),"\n",(0,i.jsx)(t.h2,{id:"creating-a-scope",children:"Creating a Scope"}),"\n",(0,i.jsx)(t.p,{children:'To create a scope, navigate to the Scopes tab and hit "Create Scope" button. Enter the name of the scope, the regions, the accounts, the services covered and any tags that identify your services. If you specify multiple tags, resources tagged with any one of those tags will be included.'}),"\n",(0,i.jsx)(t.p,{children:"Hit 'Save' to create the scope"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Create Scope",src:n(9486).Z+"",width:"1061",height:"812"})}),"\n",(0,i.jsx)(t.h2,{id:"creating-an-environment",children:"Creating an Environment"}),"\n",(0,i.jsx)(t.p,{children:'To create an Environment, navigate to the Environments tab and hit "Create Environment" button. Enter the name of the environment, and choose the scopes to add to the environment from the bottom of the screen. Click "Add scope" and these will add to the list of selected scopes.'}),"\n",(0,i.jsx)(t.p,{children:"Hit 'Save' to create the environment"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Create Environments",src:n(1024).Z+"",width:"1632",height:"811"})}),"\n",(0,i.jsx)(t.h2,{id:"creating-a-rule",children:"Creating a Rule"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.em,{children:"NOTE: You can create rules without necessarily creating scopes or environments"})}),"\n",(0,i.jsx)(t.p,{children:'To create an rule, navigate to the Rules tab and hit "Create Rule" button.'}),"\n",(0,i.jsx)(t.p,{children:"Enter the name of the rule and a description. Specify"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.em,{children:(0,i.jsx)(t.strong,{children:"Environments (optional)"})})," - the environments specifying the assets against which the rule will run. If this is left blank, this rule will trigger against any alert identifying an affected workloads","\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.em,{children:"Monitoring Enabled"})," - if monitoring is checked then GuardDuty Monitoring will be enabled on all regions in the cloud accounts specified within a particular Environment(s), this will run every 5 minutes to check for new alerts that contain a minimum severity of 5"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.em,{children:(0,i.jsx)(t.strong,{children:"Alert Type"})}),"  - the type of alert that will trigger the rule (e.g. GuardDuty)"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.em,{children:(0,i.jsx)(t.strong,{children:"Asset Type"})})," - the type of cloud resource to which the rule will apply (e.g. EC2)"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.em,{children:(0,i.jsx)(t.strong,{children:"Investigation Type"})})," - the type of invesigation to perform. This currently has three options","\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.em,{children:"Default"})," - Performs triage collection from any workload specified in the alert"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.em,{children:"Triage"})," - Performs triage collection from any workload specified in the alert"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.em,{children:"Full"})," - Performs full disk collection from any workload specified in the alert"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.em,{children:(0,i.jsx)(t.strong,{children:"Response Actions (optional)"})})," - the actions to take against machines upon which malicious activities have been detected, and machines upon which suspicous activities have been detected. Cado currently supports shutting down EC2 instances, isolating the IAM roles of that the EC2 instance assumes and isolate security group attached to the EC2."]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"Hit 'Save' to create the rule"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Create Rule",src:n(476).Z+"",width:"2170",height:"1614"})}),"\n",(0,i.jsx)(t.h3,{id:"permissions-required",children:"Permissions Required"}),"\n",(0,i.jsx)(t.p,{children:"Each action requires different permissions and is controlled using IAM roles. The table below details a description of each action and the permissions required. Add these permissions to your Cado role, and ensure it has scope to cover the resource you wish to invoke an action on."}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Action"}),(0,i.jsx)(t.th,{children:"Description"}),(0,i.jsx)(t.th,{children:"Required Permissions"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Stop Instance"}),(0,i.jsx)(t.td,{children:"Stops an EC2 instance using the AWS API"}),(0,i.jsxs)(t.td,{children:["ec2",":StopInstances"]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Isolate Role"}),(0,i.jsx)(t.td,{children:"Isolates the IAM role attached to an EC2 instance. Isolated by adding a deny all inline policy to the given IAM role."}),(0,i.jsxs)(t.td,{children:["iam",":GetInstanceProfile"," iam",":PutRolePolicy"]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Isolate Security Group"}),(0,i.jsx)(t.td,{children:"Isolates the security group attached to and EC2 instance. Isolated by creating a security group, blanking it and replacing it on the EC2."}),(0,i.jsxs)(t.td,{children:["ec2",":CreateSecurityGroup"," ec2",":RevokeSecurityGroupEgress"," ec2",":ModifyInstanceAttribute"]})]})]})]}),"\n",(0,i.jsx)(t.h2,{id:"managing-rules",children:"Managing Rules"}),"\n",(0,i.jsx)(t.p,{children:"You can configure multiple response rules. In the event that a resource is covered by multiple rules, the first rule in the list applies"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Manage Rules",src:n(7228).Z+"",width:"1667",height:"282"})}),"\n",(0,i.jsx)(t.h2,{id:"example-scenario",children:"Example Scenario"}),"\n",(0,i.jsx)(t.p,{children:"A GuardDuty Alert has been raised with a severity level of 5. The alert is for an EC2 that has been compromised. An investigation will be triggered, but before this, we check the Automation Rules defined - if there is a rule set up for GuardDuty alerts for EC2  in the Region & Account the compromised EC2 resides in.\nIf a rule matches, we then perform the investigation based on the Investigation type defined in the rule (i.e full investigation)."}),"\n",(0,i.jsx)(t.p,{children:"After the import is complete we can check the automated investigation tab to view all malicious and suspicious activity in relation to the compromised EC2.\nYou can then select the cloud resource and view the cloud resource. A panel will open with the metadata and actions tab. The metadata tab contains metadata about the resource and the Actions tab contains actions which can be performed on the compromised resource."}),"\n",(0,i.jsx)(t.p,{children:"To automate the remediation actions on the compromised resource, you can enable this under the Settings -> Advanced tab, this would avoid you having to manually invoke the actions via the cloud resource panel. This will automatically invoke the actions defined in the Automation Rule for malicious or suspicious activity after the investigation is complete."})]})}function h(e={}){const{wrapper:t}={...(0,s.a)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},1024:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/environments-72cb069d871104cc1b13d33bdfb68916.png"},7228:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/rules-list-079383494a28c8acafa4ad624d3e6231.png"},476:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/rules-7cbd5b97c7cefd78bd295d0cfec3194d.png"},9486:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/scopes-50355401cc62813c6ace8390e10b75bb.png"},1151:(e,t,n)=>{n.d(t,{Z:()=>r,a:()=>a});var i=n(7294);const s={},o=i.createContext(s);function a(e){const t=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),i.createElement(o.Provider,{value:t},e.children)}}}]);