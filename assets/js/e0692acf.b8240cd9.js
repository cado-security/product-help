"use strict";(self.webpackChunkproduct_help=self.webpackChunkproduct_help||[]).push([[968],{1930:(e,o,s)=>{s.r(o),s.d(o,{assets:()=>a,contentTitle:()=>i,default:()=>m,frontMatter:()=>r,metadata:()=>c,toc:()=>d});var t=s(5893),n=s(1151);const r={title:"Memory Analysis",hide_title:!0,sidebar_position:3},i="Memory Analysis",c={id:"cado-response/discovery-import/import/data-types/memory",title:"Memory Analysis",description:"You can perform a memory acquisition of a Windows or Linux system using Cado Host simply by clicking Import > Cado Host within the platform and running the pre-generated script on the host device. For more details on these steps, click here. Process memory collection is not currently supported on OSX.",source:"@site/docs/cado-response/discovery-import/import/data-types/memory.md",sourceDirName:"cado-response/discovery-import/import/data-types",slug:"/cado-response/discovery-import/import/data-types/memory",permalink:"/cado-response/discovery-import/import/data-types/memory",draft:!1,unlisted:!1,editUrl:"https://github.com/cado-security/product-help/tree/master/docs/cado-response/discovery-import/import/data-types/memory.md",tags:[],version:"current",lastUpdatedAt:1728399791,formattedLastUpdatedAt:"Oct 8, 2024",sidebarPosition:3,frontMatter:{title:"Memory Analysis",hide_title:!0,sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Log & Artifact Types",permalink:"/cado-response/discovery-import/import/data-types/logs"},next:{title:"Supported Import Types",permalink:"/cado-response/discovery-import/import/data-types/import-types"}},a={},d=[{value:"Acquiring Memory from AWS EC2",id:"acquiring-memory-from-aws-ec2",level:2},{value:"Containers",id:"containers",level:2},{value:"Processed Memory",id:"processed-memory",level:2}];function l(e){const o={a:"a",code:"code",h1:"h1",h2:"h2",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,n.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.h1,{id:"memory-analysis",children:"Memory Analysis"}),"\n",(0,t.jsxs)(o.p,{children:["You can perform a memory acquisition of a Windows or Linux system using Cado Host simply by clicking ",(0,t.jsx)(o.code,{children:"Import > Cado Host"})," within the platform and running the pre-generated script on the host device. For more details on these steps, click ",(0,t.jsx)(o.a,{href:"https://docs.cadosecurity.com/cado-host/deploy",children:"here"}),". Process memory collection is not currently supported on OSX."]}),"\n",(0,t.jsxs)(o.p,{children:["In your console and within Cado Host, ensure to enable the options to collect memory, and optionally collect larger process memory files:\n",(0,t.jsx)(o.img,{alt:"Enable Memory",src:s(2205).Z+"",width:"2120",height:"644"}),"\nWindows systems can have particularly large process memory files which can result in a slow collection process, so we recommend only enabling the ",(0,t.jsx)(o.strong,{children:"Enable Extended Memory Collection"})," option on Windows systems where required."]}),"\n",(0,t.jsxs)(o.p,{children:['Cado collects memory from individual processes as .mem files, viewable under the "process_dumps" folder.\nThis allows for more reliable analysis than previous versions of Cado which collected a single capture of memory, and (also) utilizes the Cado-branded open source tool ',(0,t.jsx)(o.a,{href:"https://github.com/cado-security/varc",children:"varc"})]}),"\n",(0,t.jsx)(o.h2,{id:"acquiring-memory-from-aws-ec2",children:"Acquiring Memory from AWS EC2"}),"\n",(0,t.jsx)(o.p,{children:'You can acquire memory of Linux systems in EC2 by using the "Alternate Acquisition" option under Import > EC2:'}),"\n",(0,t.jsx)(o.p,{children:(0,t.jsx)(o.img,{alt:"AWS Memory",src:s(877).Z+"",width:"1648",height:"284"})}),"\n",(0,t.jsxs)(o.p,{children:["This requires the AWS SSM agent to be running on the EC2 and registered within the AWS Systems Manager.\nIf it is not, you can acquire memory by connecting to the machine over SSH or RDP and executing Cado Host from ",(0,t.jsx)(o.strong,{children:"Import"})," > ",(0,t.jsx)(o.strong,{children:"Cado Host"}),".\nYou can also use this method to acquire from Windows systems."]}),"\n",(0,t.jsx)(o.h2,{id:"containers",children:"Containers"}),"\n",(0,t.jsxs)(o.p,{children:["Any acquisition from a container (e.g. ECS/EKS/AKS) will attempt to collect memory by default.\nIn our ",(0,t.jsx)(o.a,{href:"https://github.com/cado-security/varc",children:"testing"}),":"]}),"\n",(0,t.jsxs)(o.ul,{children:["\n",(0,t.jsx)(o.li,{children:"AWS Lambda successfully dumped process memory by default, however requires manual execution within the Lambda function."}),"\n",(0,t.jsx)(o.li,{children:"EKS on EC2 successfully dumped process memory by default."}),"\n",(0,t.jsx)(o.li,{children:"ECS on Fargate required us to enable CAP_SYS_PTRACE in our task definition."}),"\n"]}),"\n",(0,t.jsx)(o.h2,{id:"processed-memory",children:"Processed Memory"}),"\n",(0,t.jsx)(o.p,{children:"Once the memory is processed, you will be able to browse the file system in the Cado UI, including the contents of files (if they were in memory at the time) and view information from running processes and network connections."}),"\n",(0,t.jsxs)(o.p,{children:['Collected memory files are under the "process_dumps" folder:\n',(0,t.jsx)(o.img,{alt:"Import Evidence",src:s(615).Z+"",width:"1138",height:"1028"})]}),"\n",(0,t.jsx)(o.p,{children:"And running process information is recorded in processes.json:"}),"\n",(0,t.jsx)(o.p,{children:(0,t.jsx)(o.img,{alt:"Process Info",src:s(5870).Z+"",width:"3144",height:"936"})}),"\n",(0,t.jsx)(o.p,{children:"Information on network connections is recorded in network.json, open files in open_files.json, and open files are collected in the collected_files folder."})]})}function m(e={}){const{wrapper:o}={...(0,n.a)(),...e.components};return o?(0,t.jsx)(o,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},877:(e,o,s)=>{s.d(o,{Z:()=>t});const t=s.p+"assets/images/alternate-ec2-1d44379783163049a09c15fbf9a92565.png"},615:(e,o,s)=>{s.d(o,{Z:()=>t});const t=s.p+"assets/images/collected-memory-ac9e487a30fdc244204f920483edb251.png"},2205:(e,o,s)=>{s.d(o,{Z:()=>t});const t=s.p+"assets/images/enable-memory-09ab82739929f71230a6cbd5bb0d337e.png"},5870:(e,o,s)=>{s.d(o,{Z:()=>t});const t=s.p+"assets/images/proccess-info-54e66b0e418d23146cc12b46fcbe6ee2.png"},1151:(e,o,s)=>{s.d(o,{Z:()=>c,a:()=>i});var t=s(7294);const n={},r=t.createContext(n);function i(e){const o=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(o):{...o,...e}}),[o,e])}function c(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:i(e.components),t.createElement(r.Provider,{value:o},e.children)}}}]);