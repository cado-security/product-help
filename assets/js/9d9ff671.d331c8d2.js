"use strict";(self.webpackChunkproduct_help=self.webpackChunkproduct_help||[]).push([[954],{3905:function(e,t,a){a.d(t,{Zo:function(){return c},kt:function(){return h}});var n=a(7294);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var s=n.createContext({}),d=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},c=function(e){var t=d(e.components);return n.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),u=d(a),h=o,m=u["".concat(s,".").concat(h)]||u[h]||p[h]||r;return a?n.createElement(m,l(l({ref:t},c),{},{components:a})):n.createElement(m,l({ref:t},c))}));function h(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=a.length,l=new Array(r);l[0]=u;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:o,l[1]=i;for(var d=2;d<r;d++)l[d]=a[d];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},9104:function(e,t,a){a.r(t),a.d(t,{assets:function(){return c},contentTitle:function(){return s},default:function(){return h},frontMatter:function(){return i},metadata:function(){return d},toc:function(){return p}});var n=a(7462),o=a(3366),r=(a(7294),a(3905)),l=["components"],i={title:"AWS Adding a Load Balancer",hide_title:!0,sidebar_position:1},s="How to Add a Load Balancer in AWS",d={unversionedId:"cado-response/guides/aws-load-balancer",id:"cado-response/guides/aws-load-balancer",title:"AWS Adding a Load Balancer",description:"An Application Load Balancer can be placed in front of the Cado Response web server in order to provide a valid HTTPS connection and add a Web Application Firewall. Cado Response currently doesn\u2019t scale across multiple Availability Zones so this doesn\u2019t provide redundancy- but this will be added in the future.",source:"@site/docs/cado-response/guides/aws-load-balancer.md",sourceDirName:"cado-response/guides",slug:"/cado-response/guides/aws-load-balancer",permalink:"/cado-response/guides/aws-load-balancer",editUrl:"https://github.com/cado-security/product-help/tree/master/docs/cado-response/guides/aws-load-balancer.md",tags:[],version:"current",lastUpdatedAt:1647618346,formattedLastUpdatedAt:"3/18/2022",sidebarPosition:1,frontMatter:{title:"AWS Adding a Load Balancer",hide_title:!0,sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"AWS Backups and Recovery",permalink:"/cado-response/guides/aws-backups"},next:{title:"AWS Security Considerations",permalink:"/cado-response/guides/aws-security"}},c={},p=[{value:"Get a SSL/TLS Certificate for your domain",id:"get-a-ssltls-certificate-for-your-domain",level:2},{value:"Create the Target Group",id:"create-the-target-group",level:2},{value:"Create the Load Balancer",id:"create-the-load-balancer",level:2},{value:"(Optional) Adding a Web Application Firewall to your Load Balancer",id:"optional-adding-a-web-application-firewall-to-your-load-balancer",level:2},{value:"You will need to Update the Load Balancer when you Update Cado Response",id:"you-will-need-to-update-the-load-balancer-when-you-update-cado-response",level:2},{value:"Troubleshooting the Load Balancer",id:"troubleshooting-the-load-balancer",level:2}],u={toc:p};function h(e){var t=e.components,i=(0,o.Z)(e,l);return(0,r.kt)("wrapper",(0,n.Z)({},u,i,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"how-to-add-a-load-balancer-in-aws"},"How to Add a Load Balancer in AWS"),(0,r.kt)("p",null,"An Application Load Balancer can be placed in front of the Cado Response web server in order to provide a valid HTTPS connection and add a Web Application Firewall. Cado Response currently doesn\u2019t scale across multiple Availability Zones so this doesn\u2019t provide redundancy- but this will be added in the future."),(0,r.kt)("p",null,(0,r.kt)("img",{loading:"lazy",alt:"AWS Load Balancer 1",src:a(1543).Z,width:"1421",height:"767"})),(0,r.kt)("h2",{id:"get-a-ssltls-certificate-for-your-domain"},"Get a SSL/TLS Certificate for your domain"),(0,r.kt)("p",null,"If you want to have a valid SSL/TLS certificate for a domain name you own to connect to Cado Response, e.g. ",(0,r.kt)("inlineCode",{parentName:"p"},"https://cado-response.your-company.com"),", you will need to request a certificate for a domain you own from the Amazon Certificate Manager. Click ",(0,r.kt)("strong",{parentName:"p"},"Request")," and follow the instructions."),(0,r.kt)("h2",{id:"create-the-target-group"},"Create the Target Group"),(0,r.kt)("p",null,"First we need to create a ",(0,r.kt)("strong",{parentName:"p"},"Target Group")," which will tell our Load Balancer how to connect to the Cado Response server.\nOpen Target Groups in EC2, and click ",(0,r.kt)("strong",{parentName:"p"},"Create Target Group"),":"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Select ",(0,r.kt)("strong",{parentName:"li"},"Instances")," as the target type"),(0,r.kt)("li",{parentName:"ul"},"Select Port 443 and HTTPS Protocol"),(0,r.kt)("li",{parentName:"ul"},"Select HTTP and the Cado Response VPC"),(0,r.kt)("li",{parentName:"ul"},"Select HTTPS as the health check protocol and / as the url\nThen select the Cado Response instance as the target and click ",(0,r.kt)("strong",{parentName:"li"},"Include as Pending"),".\nClick ",(0,r.kt)("strong",{parentName:"li"},"Create Target Group"),".")),(0,r.kt)("p",null,"Depending on your settings, the Target Group should look something like this:\n",(0,r.kt)("img",{loading:"lazy",alt:"AWS Load Balancer 1",src:a(369).Z,width:"1999",height:"926"})),(0,r.kt)("h2",{id:"create-the-load-balancer"},"Create the Load Balancer"),(0,r.kt)("p",null,"Open the Load Balancer wizard and select ",(0,r.kt)("strong",{parentName:"p"},"Application Load Balancer"),":"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Select ",(0,r.kt)("strong",{parentName:"li"},"Internet Facing")," as Scheme (this may change depending on your desired architecture)"),(0,r.kt)("li",{parentName:"ul"},"Select IP Address Type: IPv4"),(0,r.kt)("li",{parentName:"ul"},"Select The Cado Response VPC as the VPC"),(0,r.kt)("li",{parentName:"ul"},"Under mappings select both Subnets. Older deployments of Cado Response prior to v1.4.0 only had a single subnet - if you only see a single subnet please contact support for advice on adding a second subnet."),(0,r.kt)("li",{parentName:"ul"},"Under Listeners and Routing, select HTTPS and port 443. Select the ACM certificate if you chose to create one above."),(0,r.kt)("li",{parentName:"ul"},"Click ",(0,r.kt)("strong",{parentName:"li"},"Create Load Balancer"))),(0,r.kt)("p",null,"Once created, you should see something like this:\n",(0,r.kt)("img",{loading:"lazy",alt:"AWS Load Balancer 1",src:a(2343).Z,width:"1861",height:"771"})),(0,r.kt)("p",null,"Once the load balancer has been created, select the Load Balancer and open the domain name listed under DNS name e.g. ",(0,r.kt)("inlineCode",{parentName:"p"},"https://cado-alb-test.us-east-1.elb.amazonaws.com/")),(0,r.kt)("p",null,"If you are using your own domain name, you will then need to point your custom domain name to this DNS name. For example, this is a typical record to point a domain you own (example: ",(0,r.kt)("inlineCode",{parentName:"p"},"cado-alb.your-company.com"),") to the ",(0,r.kt)("inlineCode",{parentName:"p"},"*.amazonaws.com")," DNS name of your Load Balancer:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Type: ",(0,r.kt)("inlineCode",{parentName:"li"},"CNAME")),(0,r.kt)("li",{parentName:"ul"},"Name: ",(0,r.kt)("inlineCode",{parentName:"li"},"cado-alb")),(0,r.kt)("li",{parentName:"ul"},"Target: ",(0,r.kt)("inlineCode",{parentName:"li"},"cado-alb-test.us-east-1.elb.amazonaws.com"))),(0,r.kt)("p",null,"You should then be able to visit the domain in your browser and login to Cado Response."),(0,r.kt)("h2",{id:"optional-adding-a-web-application-firewall-to-your-load-balancer"},"(Optional) Adding a Web Application Firewall to your Load Balancer"),(0,r.kt)("p",null,"You can also add a WAF by:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Selecting your Load Balancer, then ",(0,r.kt)("strong",{parentName:"li"},"Integrated Services")," then ",(0,r.kt)("strong",{parentName:"li"},"Create Web ACL"),"."),(0,r.kt)("li",{parentName:"ul"},"Under ",(0,r.kt)("strong",{parentName:"li"},"Associated AWS resources")," select your Load Balancer."),(0,r.kt)("li",{parentName:"ul"},"Under ",(0,r.kt)("strong",{parentName:"li"},"Add rules and rule groups")," select the pre-built Firewall rules you want to enable."),(0,r.kt)("li",{parentName:"ul"},"Click through to ",(0,r.kt)("strong",{parentName:"li"},"Create Web ACL"))),(0,r.kt)("h2",{id:"you-will-need-to-update-the-load-balancer-when-you-update-cado-response"},"You will need to Update the Load Balancer when you Update Cado Response"),(0,r.kt)("p",null,"The Application Load Balancer is tied to a specific EC2 Instance ID (or local 10.x IP Address if you select this instead). Both the Instance ID and Local IP Address update when the platform is updated. You will need to update the target in the Target Group to the new Instance ID or IP Address after the platform has updated. We are working on removing this requirement."),(0,r.kt)("p",null,"If you are deploying Cado Response and your Load Balancer by Terraform, this can be updated automatically."),(0,r.kt)("h2",{id:"troubleshooting-the-load-balancer"},"Troubleshooting the Load Balancer"),(0,r.kt)("p",null,"If your ALB shows a status as unhealthy, check that you have selected 443 (not 80) as the port and HTTPS (not HTTP) as the protocol in all instances."),(0,r.kt)("p",null,"If the Connection Times Out or you get the error \u201c504 Gateway Timeout\u201d, check that Security Group on both the load balancer and the Cado Response server allow traffic from Cado Response to the ALB to the User. Also select the Target Group, and check that under ",(0,r.kt)("strong",{parentName:"p"},"Registered targets")," the Instance is listed."))}h.isMDXComponent=!0},1543:function(e,t,a){t.Z=a.p+"assets/images/aws-lb-1-cb787acc8f3821d5ce8f41527f37a4fa.png"},369:function(e,t,a){t.Z=a.p+"assets/images/aws-lb-2-478246c9c7f90a8c926c5270b1bbcc22.png"},2343:function(e,t,a){t.Z=a.p+"assets/images/aws-lb-3-4c96f57eec71bf591e0c631fb50470fb.png"}}]);