"use strict";(self.webpackChunkproduct_help=self.webpackChunkproduct_help||[]).push([[3707],{7674:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>i,metadata:()=>a,toc:()=>l});var n=t(74848),o=t(28453);const i={title:"EKS",hide_title:!0,sidebar_position:5},r="How to Import Data from AWS EKS",a={id:"cado/discovery-import/aws/aws-eks",title:"EKS",description:"The Cado platform enables the collection of key logs and forensic artifacts from containers running in an AWS EKS cluster. There are three main options when acquiring data from EKS:",source:"@site/docs/cado/discovery-import/aws/aws-eks.md",sourceDirName:"cado/discovery-import/aws",slug:"/cado/discovery-import/aws/aws-eks",permalink:"/cado/discovery-import/aws/aws-eks",draft:!1,unlisted:!1,editUrl:"https://github.com/cado-security/product-help/tree/master/docs/cado/discovery-import/aws/aws-eks.md",tags:[],version:"current",lastUpdatedAt:1759920551,formattedLastUpdatedAt:"Oct 8, 2025",sidebarPosition:5,frontMatter:{title:"EKS",hide_title:!0,sidebar_position:5},sidebar:"tutorialSidebar",previous:{title:"ECS",permalink:"/cado/discovery-import/aws/aws-ecs"},next:{title:"Lambda",permalink:"/cado/discovery-import/aws/aws-lambda"}},c={},l=[{value:"Import Steps",id:"import-steps",level:2},{value:"Known Limitations",id:"known-limitations",level:2},{value:"Linking AWS IAM to Your Cluster RBAC",id:"linking-aws-iam-to-your-cluster-rbac",level:2},{value:"Data Flow Diagram",id:"data-flow-diagram",level:2}];function d(e){const s={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.h1,{id:"how-to-import-data-from-aws-eks",children:"How to Import Data from AWS EKS"}),"\n",(0,n.jsx)(s.p,{children:"The Cado platform enables the collection of key logs and forensic artifacts from containers running in an AWS EKS cluster. There are three main options when acquiring data from EKS:"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"EKS Options",src:t(74679).A+"",width:"1674",height:"732"})}),"\n",(0,n.jsx)(s.h2,{id:"import-steps",children:"Import Steps"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:["Go to ",(0,n.jsx)(s.strong,{children:"Import > Cloud"}),"."]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"Cado Import Screen showing the AWS EKS options",src:t(43913).A+"",width:"1522",height:"363"})}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:["Follow the prompts to select your ",(0,n.jsx)(s.strong,{children:"Cluster"}),", ",(0,n.jsx)(s.strong,{children:"Pod"}),", and ",(0,n.jsx)(s.strong,{children:"Container"}),"."]}),"\n",(0,n.jsx)(s.admonition,{type:"tip",children:(0,n.jsx)(s.p,{children:"When choosing the role in the UI, make sure to select the role configured for the account where your EKS cluster resides."})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"Cado Import Screen showing the available AWS EKS Clusters",src:t(21930).A+"",width:"1842",height:"563"})}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(s.p,{children:"Cado will automatically collect key logs and forensic artifacts from the selected container to facilitate your investigation. The import and processing typically take a few minutes to complete."}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"Cado showing the confirmation screen of a successful AWS EKS container capture",src:t(60787).A+"",width:"2684",height:"340"})}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"known-limitations",children:"Known Limitations"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["Cado can acquire artifacts from containers built with ",(0,n.jsx)(s.strong,{children:"distroless containers"})," and ",(0,n.jsx)(s.strong,{children:"private clusters"})," using Cado Host only. Containers with the ",(0,n.jsx)(s.code,{children:"gcr.io/distroless"})," image tag will be hidden. For more details, see ",(0,n.jsx)(s.a,{href:"/cado/discovery-import/kubernetes#alternate-collection-by-using-cado-host-with-a-sidecar-container",children:"Kubernetes Deployments"}),"."]}),"\n",(0,n.jsxs)(s.li,{children:["Cado will hide pods running under the following namespaces, which are generally system-level namespaces running a distroless environment:","\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"kube-system"}),", ",(0,n.jsx)(s.code,{children:"kube-public"}),", ",(0,n.jsx)(s.code,{children:"kube-node-lease"})]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"gke-gmp-system"}),", ",(0,n.jsx)(s.code,{children:"aks-command"})]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"gmp-system"}),", ",(0,n.jsx)(s.code,{children:"calico-system"}),", ",(0,n.jsx)(s.code,{children:"tigera-operator"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"linking-aws-iam-to-your-cluster-rbac",children:"Linking AWS IAM to Your Cluster RBAC"}),"\n",(0,n.jsx)(s.admonition,{type:"info",children:(0,n.jsxs)(s.p,{children:["Use the role ARN added in the ",(0,n.jsx)(s.a,{href:"/cado/deploy/cross/cross-account-creation#step-2-add-target-aws-role-arn-to-the-cado-platform",children:"Cross Account Creation"})," that corresponds to the AWS Account ID where the cluster resides."]})}),"\n",(0,n.jsxs)(s.p,{children:["You need to add the appropriate Cado IAM role to your EKS RBAC configuration. Without this, you will encounter an error stating: ",(0,n.jsx)(s.code,{children:"This role is not configured to authorize with this EKS cluster"}),"."]}),"\n",(0,n.jsxs)(s.p,{children:["Refer to ",(0,n.jsx)(s.a,{href:"https://aws.amazon.com/premiumsupport/knowledge-center/eks-api-server-unauthorized-error/",children:"this AWS guide"})," for instructions on adding your role to the EKS RBAC. If you have ",(0,n.jsx)(s.code,{children:"eksctl"})," configured, you can run the following command:"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"eksctl create iamidentitymapping --cluster=<cluster_name> --region=<region> --arn=<iam_role> --group=<group>\n"})}),"\n",(0,n.jsxs)(s.p,{children:["If you added the ClusterRole and ClusterRoleBindings as shown above, the group will be ",(0,n.jsx)(s.code,{children:"cado"}),":"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"eksctl create iamidentitymapping --cluster=<cluster_name> --region=<region> --arn=<iam_role> --group=cado\n"})}),"\n",(0,n.jsx)(s.p,{children:"Ensure the following IAM permissions are attached to your IAM role:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{children:'\t"eks:ListClusters",\n\t"eks:DescribeCluster",\n'})}),"\n",(0,n.jsx)(s.h2,{id:"data-flow-diagram",children:"Data Flow Diagram"}),"\n",(0,n.jsx)(s.p,{children:"Below is a diagram illustrating how EKS acquisitions operate:"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"EKS Data Flow",src:t(19733).A+"",width:"2308",height:"1342"})})]})}function h(e={}){const{wrapper:s}={...(0,o.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},19733:(e,s,t)=>{t.d(s,{A:()=>n});const n=t.p+"assets/images/eks-collection-b09e91900a42cf41175a7ca3637b8c45.png"},74679:(e,s,t)=>{t.d(s,{A:()=>n});const n=t.p+"assets/images/eks-options-c8ae61eb3df024a44ad4155fdcc299b3.png"},21930:(e,s,t)=>{t.d(s,{A:()=>n});const n=t.p+"assets/images/eks2-61bad122854ee7bda7589ab4d9c32e68.png"},60787:(e,s,t)=>{t.d(s,{A:()=>n});const n=t.p+"assets/images/eks3-1d4a0615141570987cd405548b7ab73e.png"},43913:(e,s,t)=>{t.d(s,{A:()=>n});const n=t.p+"assets/images/import-cloud-focus-2430bd09657ad2f5e88391377ba1dc53.png"},28453:(e,s,t)=>{t.d(s,{R:()=>r,x:()=>a});var n=t(96540);const o={},i=n.createContext(o);function r(e){const s=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),n.createElement(i.Provider,{value:s},e.children)}}}]);