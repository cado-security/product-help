"use strict";(self.webpackChunkproduct_help=self.webpackChunkproduct_help||[]).push([[3707],{7674:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>a,toc:()=>l});var s=i(74848),t=i(28453);const o={title:"EKS",hide_title:!0,sidebar_position:5},r="How to Import Data from AWS EKS",a={id:"cado/discovery-import/aws/aws-eks",title:"EKS",description:"The / Forensic Acquisition and Investigation platform enables the collection of key logs and forensic artifacts from containers running in an AWS EKS cluster. There are three main options when acquiring data from EKS:",source:"@site/docs/cado/discovery-import/aws/aws-eks.md",sourceDirName:"cado/discovery-import/aws",slug:"/cado/discovery-import/aws/aws-eks",permalink:"/cado/discovery-import/aws/aws-eks",draft:!1,unlisted:!1,editUrl:"https://github.com/cado-security/product-help/tree/master/docs/cado/discovery-import/aws/aws-eks.md",tags:[],version:"current",lastUpdatedAt:1761752682,formattedLastUpdatedAt:"Oct 29, 2025",sidebarPosition:5,frontMatter:{title:"EKS",hide_title:!0,sidebar_position:5},sidebar:"tutorialSidebar",previous:{title:"ECS",permalink:"/cado/discovery-import/aws/aws-ecs"},next:{title:"Lambda",permalink:"/cado/discovery-import/aws/aws-lambda"}},c={},l=[{value:"Import Steps",id:"import-steps",level:2},{value:"Known Limitations",id:"known-limitations",level:2},{value:"Linking AWS IAM to Your Cluster RBAC",id:"linking-aws-iam-to-your-cluster-rbac",level:2},{value:"Data Flow Diagram",id:"data-flow-diagram",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"how-to-import-data-from-aws-eks",children:"How to Import Data from AWS EKS"}),"\n",(0,s.jsx)(n.p,{children:"The / Forensic Acquisition and Investigation platform enables the collection of key logs and forensic artifacts from containers running in an AWS EKS cluster. There are three main options when acquiring data from EKS:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"EKS Options",src:i(74679).A+"",width:"1674",height:"732"})}),"\n",(0,s.jsx)(n.h2,{id:"import-steps",children:"Import Steps"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Go to ",(0,s.jsx)(n.strong,{children:"Import > Cloud"}),"."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Cado Import Screen showing the AWS EKS options",src:i(43913).A+"",width:"1522",height:"363"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Follow the prompts to select your ",(0,s.jsx)(n.strong,{children:"Cluster"}),", ",(0,s.jsx)(n.strong,{children:"Pod"}),", and ",(0,s.jsx)(n.strong,{children:"Container"}),"."]}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsx)(n.p,{children:"When choosing the role in the UI, make sure to select the role configured for the account where your EKS cluster resides."})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Cado Import Screen showing the available AWS EKS Clusters",src:i(21930).A+"",width:"1842",height:"563"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"/ Forensic Acquisition and Investigation will automatically collect key logs and forensic artifacts from the selected container to facilitate your investigation. The import and processing typically take a few minutes to complete."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Cado showing the confirmation screen of a successful AWS EKS container capture",src:i(60787).A+"",width:"2684",height:"340"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"known-limitations",children:"Known Limitations"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["/ Forensic Acquisition and Investigation can acquire artifacts from containers built with ",(0,s.jsx)(n.strong,{children:"distroless containers"})," and ",(0,s.jsx)(n.strong,{children:"private clusters"})," using / Forensic Acquisition and Investigation Host only. Containers with the ",(0,s.jsx)(n.code,{children:"gcr.io/distroless"})," image tag will be hidden. For more details, see ",(0,s.jsx)(n.a,{href:"/cado/discovery-import/kubernetes#alternate-collection-by-using-cado-host-with-a-sidecar-container",children:"Kubernetes Deployments"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["/ Forensic Acquisition and Investigation will hide pods running under the following namespaces, which are generally system-level namespaces running a distroless environment:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"kube-system"}),", ",(0,s.jsx)(n.code,{children:"kube-public"}),", ",(0,s.jsx)(n.code,{children:"kube-node-lease"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"gke-gmp-system"}),", ",(0,s.jsx)(n.code,{children:"aks-command"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"gmp-system"}),", ",(0,s.jsx)(n.code,{children:"calico-system"}),", ",(0,s.jsx)(n.code,{children:"tigera-operator"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"linking-aws-iam-to-your-cluster-rbac",children:"Linking AWS IAM to Your Cluster RBAC"}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["Use the role ARN added in the ",(0,s.jsx)(n.a,{href:"/cado/deploy/cross/cross-account-creation#step-2-add-target-aws-role-arn-to-the-cado-platform",children:"Cross Account Creation"})," that corresponds to the AWS Account ID where the cluster resides."]})}),"\n",(0,s.jsxs)(n.p,{children:["You need to add the appropriate / Forensic Acquisition and Investigation IAM role to your EKS RBAC configuration. Without this, you will encounter an error stating: ",(0,s.jsx)(n.code,{children:"This role is not configured to authorize with this EKS cluster"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["Refer to ",(0,s.jsx)(n.a,{href:"https://aws.amazon.com/premiumsupport/knowledge-center/eks-api-server-unauthorized-error/",children:"this AWS guide"})," for instructions on adding your role to the EKS RBAC. If you have ",(0,s.jsx)(n.code,{children:"eksctl"})," configured, you can run the following command:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"eksctl create iamidentitymapping --cluster=<cluster_name> --region=<region> --arn=<iam_role> --group=<group>\n"})}),"\n",(0,s.jsxs)(n.p,{children:["If you added the ClusterRole and ClusterRoleBindings as shown above, the group will be ",(0,s.jsx)(n.code,{children:"cado"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"eksctl create iamidentitymapping --cluster=<cluster_name> --region=<region> --arn=<iam_role> --group=cado\n"})}),"\n",(0,s.jsx)(n.p,{children:"Ensure the following IAM permissions are attached to your IAM role:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'\t"eks:ListClusters",\n\t"eks:DescribeCluster",\n'})}),"\n",(0,s.jsx)(n.h2,{id:"data-flow-diagram",children:"Data Flow Diagram"}),"\n",(0,s.jsx)(n.p,{children:"Below is a diagram illustrating how EKS acquisitions operate:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"EKS Data Flow",src:i(19733).A+"",width:"2308",height:"1342"})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},19733:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/eks-collection-b09e91900a42cf41175a7ca3637b8c45.png"},74679:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/eks-options-c8ae61eb3df024a44ad4155fdcc299b3.png"},21930:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/eks2-61bad122854ee7bda7589ab4d9c32e68.png"},60787:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/eks3-1d4a0615141570987cd405548b7ab73e.png"},43913:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/import-cloud-focus-2430bd09657ad2f5e88391377ba1dc53.png"},28453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>a});var s=i(96540);const t={},o=s.createContext(t);function r(e){const n=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);