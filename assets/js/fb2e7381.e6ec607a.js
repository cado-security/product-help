"use strict";(self.webpackChunkcado_test=self.webpackChunkcado_test||[]).push([[766],{3905:function(e,t,a){a.d(t,{Zo:function(){return p},kt:function(){return d}});var n=a(7294);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var s=n.createContext({}),c=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},p=function(e){var t=c(e.components);return n.createElement(s.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),u=c(a),d=o,k=u["".concat(s,".").concat(d)]||u[d]||m[d]||r;return a?n.createElement(k,l(l({ref:t},p),{},{components:a})):n.createElement(k,l({ref:t},p))}));function d(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=a.length,l=new Array(r);l[0]=u;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:o,l[1]=i;for(var c=2;c<r;c++)l[c]=a[c];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},8858:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return i},contentTitle:function(){return s},metadata:function(){return c},toc:function(){return p},default:function(){return u}});var n=a(7462),o=a(3366),r=(a(7294),a(3905)),l=["components"],i={title:"Deploy and Run",hide_title:!0,sidebar_position:2},s="Deployment",c={unversionedId:"cado-host/run",id:"cado-host/run",isDocsHomePage:!1,title:"Deploy and Run",description:"You can execute Cado Host individually on a machine or you may also want to deploy it to a number of machines that may be compromised, for example through Group Policy or other systems management software.",source:"@site/docs/cado-host/run.md",sourceDirName:"cado-host",slug:"/cado-host/run",permalink:"/docs/cado-host/run",editUrl:"https://github.com/cado-security/product-help/tree/master/docs/cado-host/run.md",version:"current",lastUpdatedAt:1629598646,formattedLastUpdatedAt:"8/21/2021",sidebarPosition:2,frontMatter:{title:"Deploy and Run",hide_title:!0,sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Summary",permalink:"/docs/cado-host/intro"},next:{title:"AWS Credentials",permalink:"/docs/cado-host/aws-credentials"}},p=[{value:"Deploy through Cado Response Platform",id:"deploy-through-cado-response-platform",children:[]},{value:"Considerations",id:"considerations",children:[]},{value:"Creating Secure Cloud Storage Credentials",id:"creating-secure-cloud-storage-credentials",children:[]},{value:"Using Local Storage",id:"using-local-storage",children:[{value:"Command Line Parameters",id:"command-line-parameters",children:[]},{value:"Example Command Line",id:"example-command-line",children:[]},{value:"Example config.cfg",id:"example-configcfg",children:[]}]},{value:"Collected Artifacts",id:"collected-artifacts",children:[]}],m={toc:p};function u(e){var t=e.components,i=(0,o.Z)(e,l);return(0,r.kt)("wrapper",(0,n.Z)({},m,i,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"deployment"},"Deployment"),(0,r.kt)("p",null,"You can execute Cado Host individually on a machine or you may also want to deploy it to a number of machines that may be compromised, for example through ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("a",{parentName:"strong",href:"https://support.microsoft.com/en-gb/help/816102/how-to-use-group-policy-to-remotely-install-software-in-windows-server"},"Group Policy"))," or other systems management software."),(0,r.kt)("h2",{id:"deploy-through-cado-response-platform"},"Deploy through Cado Response Platform"),(0,r.kt)("p",null,"In order to deploy through the Cado Response platform, follow the instructions below:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Find the Cado Host deployment options on the platform under ",(0,r.kt)("inlineCode",{parentName:"p"},"Project > Import > Host Artifacts > Cado Host"),"."),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{alt:"Import Evidence",src:a(5528).Z}))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select your OS & platform"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{alt:"Select OS and Platform",src:a(284).Z}))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Choose between Manual and Command Line Deployment")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"If Manual Deployment, download the installer and execute on your machine. Then copy and paste the command generated for you, into your terminal."),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{alt:"Manual Import",src:a(2503).Z}))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"If Command Line Deployment, then paste the command generated into your terminal. This command will automatically install Cado Host and put your machines files into your S3 bucket."),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{alt:"Automatic Import",src:a(4414).Z})))),(0,r.kt)("h2",{id:"considerations"},"Considerations"),(0,r.kt)("p",null,"\u200bCado Host is designed to be executed through the command line. If you do not execute the application with administrative privileges there are some files you will not be able to acquire.\nCado Host can take parameters from a file (named ",(0,r.kt)("inlineCode",{parentName:"p"},"config.cfg"),") or on the command line.  On Microsoft Windows, if you execute it without the use of the command line, you may be prompted by the Windows SmartScreen. If you wish to run cado-host.exe by manually clicking it, you will have to select Properties and Untick this box:"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Properties",src:a(8311).Z})),(0,r.kt)("p",null,"When running on Linux or OSX, you may need to set the binary as executable:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"chmod +x ./cado-host\n./cado-host\n")),(0,r.kt)("h2",{id:"creating-secure-cloud-storage-credentials"},"Creating Secure Cloud Storage Credentials"),(0,r.kt)("p",null,"It is important to use credentials with access limited to only write objects to your cloud storage. Otherwise, if an attacker finds your credentials they could compromise data.\n\u200bBefore using Cado Host, you will need to create secure credentials to upload with:"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("a",{parentName:"strong",href:"azure-credentials"},"Creating Secure Credentials for Azure"))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("a",{parentName:"strong",href:"aws-credentials"},"Creating Secure Credentials for AWS"))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("a",{parentName:"strong",href:"google-credentials"},"Creating Secure Credentials for Google Cloud Storage"))),(0,r.kt)("h2",{id:"using-local-storage"},"Using Local Storage"),(0,r.kt)("p",null,"\u200bIf you do not set a cloud storage option, files will be saved to the same folder that Cado Host is run from. You can not set a different storage location at this time."),(0,r.kt)("h3",{id:"command-line-parameters"},"Command Line Parameters"),(0,r.kt)("p",null,"\u200bIt is very important to follow the advice above on creating write-only credentials if you are entering credentials on the command line."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"cado-host:\n  Cado Host\n\nUsage:\n  cado-host [options]\n\nOptions:\n  --light                           Exclude large files (over 100 Mb) from the collection\n  --storage <storage>               The cloud storage to use (File will be stored locally if none selected)\n  --bucket <bucket>                 The Bucket to store data in\n  --access_key <access_key>         The Access Key\n  --secret_key <secret_key>         The Secret Key\n  --region <region>                 The bucket region eg; US-EAST-1 (Optional)\n  --account_name <account_name>     The Azure Account Name\n  --container_name <container_name> The Azure Container Name\n  --sas_string <sas_string>         The Azure SAS string\n  --gcp_bucket <gcp_bucket>         The Google Cloud Bucket to store data in\n  --gcp_access_key <gcp_access_key> The Google Cloud Access Key\n  --gcp_secret_key <gcp_secret_key> The Google Cloud Secret Key\n  --version                         Show version information\n  -?, -h, --help                    Show help and usage information\n")),(0,r.kt)("h3",{id:"example-command-line"},"Example Command Line"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"cado-host.exe \u2013storage aws \u2013access_key xxx \u2013secret_key xxx \u2013bucket cado-live-test\n")),(0,r.kt)("h3",{id:"example-configcfg"},"Example config.cfg"),(0,r.kt)("p",null,"\u200bThe file ",(0,r.kt)("inlineCode",{parentName:"p"},"config.cfg")," should be in the same current working directory as the cado-host binary."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"[CORE]\nstorage = google\nlight = true\n\n[AWS]\naccess_key = xxx\nsecret_key = xxx\nbucket = xxx\n\n[GOOGLE]\ngcp_access_key = xxx\ngcp_secret_key = xxx\ngcp_bucket = xxx\n\n[AZURE]\naccess_signature= xxx\naccount_name = xxx\ncontainer_name = xxx\n\n[LOCAL]\ndestination_folder = /tmp/ or c:\\windows\\tmp\\\n")),(0,r.kt)("h2",{id:"collected-artifacts"},"Collected Artifacts"),(0,r.kt)("p",null,"Cado Host collects the following artifacts on Linux and OSX, where available:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},".bash_history"),(0,r.kt)("li",{parentName:"ul"},".ssh/known_hosts"),(0,r.kt)("li",{parentName:"ul"},"/.fseventsd"),(0,r.kt)("li",{parentName:"ul"},"/Library/LaunchAgents"),(0,r.kt)("li",{parentName:"ul"},"/Library/LaunchDaemons"),(0,r.kt)("li",{parentName:"ul"},"/Library/Preferences/SystemConfiguration"),(0,r.kt)("li",{parentName:"ul"},"/Library/Receipts/InstallHistory.plist"),(0,r.kt)("li",{parentName:"ul"},"/Library/StartupItems"),(0,r.kt)("li",{parentName:"ul"},"/System/Library/LaunchAgents"),(0,r.kt)("li",{parentName:"ul"},"/System/Library/LaunchDaemons"),(0,r.kt)("li",{parentName:"ul"},"/System/Library/StartupItems"),(0,r.kt)("li",{parentName:"ul"},"/etc/group"),(0,r.kt)("li",{parentName:"ul"},"/etc/hosts"),(0,r.kt)("li",{parentName:"ul"},"/etc/hosts.allow"),(0,r.kt)("li",{parentName:"ul"},"/etc/hosts.deny"),(0,r.kt)("li",{parentName:"ul"},"/etc/httpd/logs/"),(0,r.kt)("li",{parentName:"ul"},"/etc/passwd"),(0,r.kt)("li",{parentName:"ul"},"/etc/rc.d"),(0,r.kt)("li",{parentName:"ul"},"/etc/utmp"),(0,r.kt)("li",{parentName:"ul"},"/private/var/log/"),(0,r.kt)("li",{parentName:"ul"},"/root/.bash_history"),(0,r.kt)("li",{parentName:"ul"},"/var/adm/wtmp"),(0,r.kt)("li",{parentName:"ul"},"/var/db/application_usage.sqlite"),(0,r.kt)("li",{parentName:"ul"},"/var/log"),(0,r.kt)("li",{parentName:"ul"},"/var/run/utmp"),(0,r.kt)("li",{parentName:"ul"},"/var/run/wtmp")),(0,r.kt)("p",null,"Cado Host collects the following artifacts on Windows, where available:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Running Processes"),(0,r.kt)("li",{parentName:"ul"},"Active Network Connections"),(0,r.kt)("li",{parentName:"ul"},"$MFT"),(0,r.kt)("li",{parentName:"ul"},"ALLUSERSPROFILE\\McAfee\\DesktopProtection\\AccessProtectionLog.txt"),(0,r.kt)("li",{parentName:"ul"},"APPDATA\\LocalLow\\Sun\\Java\\Deployment\\cache\\6.0"),(0,r.kt)("li",{parentName:"ul"},"APPDATA\\Local\\Apple Computer\\Safari\\Cookies\\Cookies.binarycookies"),(0,r.kt)("li",{parentName:"ul"},"APPDATA\\Local\\ConnectedDevicesPlatform"),(0,r.kt)("li",{parentName:"ul"},"APPDATA\\Local\\Google\\Chrome\\User Data\\Default\\Extensions"),(0,r.kt)("li",{parentName:"ul"},"APPDATA\\Local\\Google\\Chrome\\User Data\\Default\\History"),(0,r.kt)("li",{parentName:"ul"},"APPDATA\\Local\\Google\\Chrome\\User Data\\Default\\Web Data"),(0,r.kt)("li",{parentName:"ul"},"APPDATA\\Local\\Microsoft\\Windows\\Explorer"),(0,r.kt)("li",{parentName:"ul"},"APPDATA\\Local\\Microsoft\\Windows\\FileHistory\\Configuration"),(0,r.kt)("li",{parentName:"ul"},"APPDATA\\Local\\Microsoft\\Windows\\UsrClass.dat"),(0,r.kt)("li",{parentName:"ul"},"APPDATA\\Local\\Microsoft\\Windows\\UsrClass.dat.LOG1"),(0,r.kt)("li",{parentName:"ul"},"APPDATA\\Local\\Microsoft\\Windows\\UsrClass.dat.LOG2"),(0,r.kt)("li",{parentName:"ul"},"APPDATA\\Local\\Microsoft\\Windows\\WebCache"),(0,r.kt)("li",{parentName:"ul"},"APPDATA\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadline\\ConsoleHost_history.txt"),(0,r.kt)("li",{parentName:"ul"},"APPDATA\\Roaming\\Microsoft\\Windows\\Recent"),(0,r.kt)("li",{parentName:"ul"},"APPDATA\\Roaming\\Microsoft\\Windows\\Recent\\AutomaticDestinations\\"),(0,r.kt)("li",{parentName:"ul"},"APPDATA\\Roaming\\Mozilla\\Firefox\\Profiles\\"),(0,r.kt)("li",{parentName:"ul"},"APPDATA\\Roaming\\Opera\\Opera\\global_history.dat"),(0,r.kt)("li",{parentName:"ul"},"APPDATA\\Roaming\\Opera\\Opera\\typed_history.xml"),(0,r.kt)("li",{parentName:"ul"},"NTUSER.DAT"),(0,r.kt)("li",{parentName:"ul"},"NTUSER.DAT.LOG1"),(0,r.kt)("li",{parentName:"ul"},"NTUSER.DAT.LOG2"),(0,r.kt)("li",{parentName:"ul"},"PROGRAMDATA\\McAfee\\DesktopProtection\\AccessProtectionLog.txt"),(0,r.kt)("li",{parentName:"ul"},"PROGRAMDATA\\Microsoft\\Windows\\Start Menu\\Programs\\Startup"),(0,r.kt)("li",{parentName:"ul"},"SYSTEMROOT\\AppCompat\\Programs\\AmCache.hve"),(0,r.kt)("li",{parentName:"ul"},"SYSTEMROOT\\Prefetch"),(0,r.kt)("li",{parentName:"ul"},"SYSTEMROOT\\SchedLgU.Txt"),(0,r.kt)("li",{parentName:"ul"},"SYSTEMROOT\\System32\\Config\\AppEvent.evt"),(0,r.kt)("li",{parentName:"ul"},"SYSTEMROOT\\System32\\Config\\SecEvent.evt"),(0,r.kt)("li",{parentName:"ul"},"SYSTEMROOT\\System32\\Config\\SysEvent.evt"),(0,r.kt)("li",{parentName:"ul"},"SYSTEMROOT\\System32\\LogFiles\\W3SVC1"),(0,r.kt)("li",{parentName:"ul"},"SYSTEMROOT\\System32\\Tasks"),(0,r.kt)("li",{parentName:"ul"},"SYSTEMROOT\\System32\\config\\SAM"),(0,r.kt)("li",{parentName:"ul"},"SYSTEMROOT\\System32\\config\\SAM.LOG1"),(0,r.kt)("li",{parentName:"ul"},"SYSTEMROOT\\System32\\config\\SAM.LOG2"),(0,r.kt)("li",{parentName:"ul"},"SYSTEMROOT\\System32\\config\\SECURITY"),(0,r.kt)("li",{parentName:"ul"},"SYSTEMROOT\\System32\\config\\SECURITY.LOG1"),(0,r.kt)("li",{parentName:"ul"},"SYSTEMROOT\\System32\\config\\SECURITY.LOG2"),(0,r.kt)("li",{parentName:"ul"},"SYSTEMROOT\\System32\\config\\SOFTWARE"),(0,r.kt)("li",{parentName:"ul"},"SYSTEMROOT\\System32\\config\\SOFTWARE.LOG1"),(0,r.kt)("li",{parentName:"ul"},"SYSTEMROOT\\System32\\config\\SOFTWARE.LOG2"),(0,r.kt)("li",{parentName:"ul"},"SYSTEMROOT\\System32\\config\\SYSTEM"),(0,r.kt)("li",{parentName:"ul"},"SYSTEMROOT\\System32\\config\\SYSTEM.LOG1"),(0,r.kt)("li",{parentName:"ul"},"SYSTEMROOT\\System32\\config\\SYSTEM.LOG2"),(0,r.kt)("li",{parentName:"ul"},"SYSTEMROOT\\System32\\drivers\\etc\\hosts"),(0,r.kt)("li",{parentName:"ul"},"SYSTEMROOT\\System32\\sru"),(0,r.kt)("li",{parentName:"ul"},"SYSTEMROOT\\System32\\winevt\\logs"),(0,r.kt)("li",{parentName:"ul"},"SYSTEMROOT\\Tasks"),(0,r.kt)("li",{parentName:"ul"},"SYSTEMROOT\\inf\\setupapi.dev.log"),(0,r.kt)("li",{parentName:"ul"},"SYSTEMROOT\\inf\\setupapi.log"),(0,r.kt)("li",{parentName:"ul"},"inetpub\\logs\\LogFiles")))}u.isMDXComponent=!0},4414:function(e,t,a){t.Z=a.p+"assets/images/import-cmdline-7f3906f9ddd3a6e6aca6ed713d87809c.png"},2503:function(e,t,a){t.Z=a.p+"assets/images/import-manual-92430de42abd4064db49bb605d5e6f88.png"},8311:function(e,t,a){t.Z=a.p+"assets/images/import-security-856f56febba6db2d8b739dc366096cd4.png"},284:function(e,t,a){t.Z=a.p+"assets/images/import-step2-0df3a0706afd6cf1d38eac93bb0b2183.png"},5528:function(e,t,a){t.Z=a.p+"assets/images/import-bcdc3d8570e6673a76e8bfb2cff1f154.png"}}]);