"use strict";(self.webpackChunkproduct_help=self.webpackChunkproduct_help||[]).push([[6941],{69253:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>r,contentTitle:()=>c,default:()=>h,frontMatter:()=>i,metadata:()=>a,toc:()=>l});var o=t(74848),s=t(28453);const i={title:"Automatically add cross-account roles to / Forensic Acquisition and Investigation with AWS Organizations",hide_title:!0,sidebar_position:5},c="How to automatically add cross-account roles to / Forensic Acquisition and Investigation with AWS Organizations",a={id:"cado/deploy/cross/aws-organizations",title:"Automatically add cross-account roles to / Forensic Acquisition and Investigation with AWS Organizations",description:"This guide will walk you through how to integrate AWS roles into the platform using AWS Organizations.",source:"@site/docs/cado/deploy/cross/aws-organizations.md",sourceDirName:"cado/deploy/cross",slug:"/cado/deploy/cross/aws-organizations",permalink:"/cado/deploy/cross/aws-organizations",draft:!1,unlisted:!1,editUrl:"https://github.com/cado-security/product-help/tree/master/docs/cado/deploy/cross/aws-organizations.md",tags:[],version:"current",lastUpdatedAt:1761839835,formattedLastUpdatedAt:"Oct 30, 2025",sidebarPosition:5,frontMatter:{title:"Automatically add cross-account roles to / Forensic Acquisition and Investigation with AWS Organizations",hide_title:!0,sidebar_position:5},sidebar:"tutorialSidebar",previous:{title:"Manually add a cross-account role to / Forensic Acquisition and Investigation in AWS",permalink:"/cado/deploy/cross/add-cross-account-manual"},next:{title:"Add cross-account roles in AWS to / Forensic Acquisition and Investigation with the API",permalink:"/cado/deploy/cross/cross-account-creation-api"}},r={},l=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"1. <strong>Setting Permissions for Account Discovery</strong>",id:"1-setting-permissions-for-account-discovery",level:3},{value:"2. <strong>Select List Accounts Role in / Forensic Acquisition and Investigation</strong>",id:"2-select-list-accounts-role-in--forensic-acquisition-and-investigation",level:3},{value:"3. <strong>Set Cross-Account IAM Role</strong>",id:"3-set-cross-account-iam-role",level:3},{value:"4. <strong>Pipeline execution</strong>",id:"4-pipeline-execution",level:3},{value:"Performing Account Checks",id:"performing-account-checks",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h1,{id:"how-to-automatically-add-cross-account-roles-to--forensic-acquisition-and-investigation-with-aws-organizations",children:"How to automatically add cross-account roles to / Forensic Acquisition and Investigation with AWS Organizations"}),"\n",(0,o.jsx)(n.p,{children:"This guide will walk you through how to integrate AWS roles into the platform using AWS Organizations."}),"\n",(0,o.jsx)(n.p,{children:"This is the recommended way to add cross-account roles you have deployed to the Platform, to enable the platform to import data from multiple AWS accounts."}),"\n",(0,o.jsxs)(n.p,{children:["Alternatively, you can use the ",(0,o.jsx)(n.a,{href:"/cado/deploy/cross/cross-account-creation-api",children:"Cado API"})," to add cross-account roles to the platform."]}),"\n",(0,o.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,o.jsx)(n.p,{children:"Before starting, ensure that you have the following in place:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"AWS Organizations"})," configured with multiple AWS accounts under a single management account."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"IAM roles"})," with the necessary cross-account permissions applied to all AWS accounts using ",(0,o.jsx)(n.a,{href:"/cado/deploy/cross/cross-account-creation-auto",children:"AWS StackSets"})," or ",(0,o.jsx)(n.a,{href:"/cado/deploy/cross/cross-account-creation",children:"manual deployment"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"/ Forensic Acquisition and Investigation Access"}),", specifically with admin rights to manage cloud accounts."]}),"\n"]}),"\n",(0,o.jsxs)(n.h3,{id:"1-setting-permissions-for-account-discovery",children:["1. ",(0,o.jsx)(n.strong,{children:"Setting Permissions for Account Discovery"})]}),"\n",(0,o.jsxs)(n.p,{children:["The ",(0,o.jsx)(n.a,{href:"https://docs.aws.amazon.com/organizations/latest/APIReference/API_ListAccounts.html",children:"ListAccounts"})," operation is used by / Forensic Acquisition and Investigation to retrieve a list of all accounts within your organization. It can only be executed from the management account of the AWS Organization."]}),"\n",(0,o.jsx)(n.p,{children:"For the code to function correctly, the IAM role used for discovery must have the necessary permissions to list accounts in AWS Organizations. Here\u2019s a minimal example of an IAM policy:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:'{\n  "Version": "2012-10-17",\n  "Statement": [\n    {\n      "Sid": "ListAccounts",\n      "Effect": "Allow",\n      "Action": [\n        "organizations:ListAccounts",\n        "organizations:ListTagsForResource"\n      ],\n      "Resource": "*"\n    }\n  ]\n}\n'})}),"\n",(0,o.jsx)(n.p,{children:"This policy must be attached to the role that the platform will assume."}),"\n",(0,o.jsx)(n.p,{children:"The ListAccounts permission should be set in the root account, and the / Forensic Acquisition and Investigation role (or a role that has trust with the / Forensic Acquisition and Investigation role) should be allowed to assume it."}),"\n",(0,o.jsxs)(n.h3,{id:"2-select-list-accounts-role-in--forensic-acquisition-and-investigation",children:["2. ",(0,o.jsx)(n.strong,{children:"Select List Accounts Role in / Forensic Acquisition and Investigation"})]}),"\n",(0,o.jsx)(n.p,{children:"To enable cross-account discovery on the platform, follow these steps:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Go to ",(0,o.jsx)(n.strong,{children:"Settings > Accounts"})," and click ",(0,o.jsx)(n.strong,{children:"Create an account"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:["Select ",(0,o.jsx)(n.strong,{children:"AWS"})," from the set of providers."]}),"\n",(0,o.jsxs)(n.li,{children:["Select the ",(0,o.jsx)(n.strong,{children:"AWS Organizations"})," option."]}),"\n",(0,o.jsx)(n.li,{children:'Under the "Role with ListAccounts Permission" dropdown, select the role with permissions to list accounts in your AWS Organization.'}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["You will need to select the role containing the organizations",":ListAccounts"," permission to the platform via Settings > Accounts. This role should have a ",(0,o.jsx)(n.a,{href:"/cado/deploy/aws/iam/iam-description#using-an-existing-iam-role",children:"trust policy"})," allowing the CadoResponseRole to assume it, and added to the platform manually via Settings > Accounts."]}),"\n",(0,o.jsx)(n.p,{children:"The dropdown will only list roles that have been added to the platform. Since / Forensic Acquisition and Investigation validates the roles before adding them, all roles shown should be assumable by the CadoResponseRole."}),"\n",(0,o.jsx)(n.p,{children:"An example is below:"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"Select List Accounts Role 1",src:t(1153).A+"",width:"1316",height:"1254"})}),"\n",(0,o.jsxs)(n.h3,{id:"3-set-cross-account-iam-role",children:["3. ",(0,o.jsx)(n.strong,{children:"Set Cross-Account IAM Role"})]}),"\n",(0,o.jsx)(n.p,{children:"Next, configure the cross-account IAM role that the / Forensic Acquisition and Investigation platform will use to interact with other accounts:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Enter the role name (e.g., ",(0,o.jsx)(n.code,{children:"CadoResponseRole"}),") in the ",(0,o.jsx)(n.code,{children:"Cross Account IAM Role Name"})," field."]}),"\n",(0,o.jsxs)(n.li,{children:["Click ",(0,o.jsx)(n.code,{children:"Discover accounts"})," to trigger the discovery process using the provided role."]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"Ensure that only the role name is used, not the entire ARN. The role name should be the name of the role that was applied to all AWS accounts using the StackSet."}),"\n",(0,o.jsx)(n.p,{children:"An example is below:"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"Select List Accounts Role 2",src:t(61600).A+"",width:"1368",height:"500"})}),"\n",(0,o.jsxs)(n.h3,{id:"4-pipeline-execution",children:["4. ",(0,o.jsx)(n.strong,{children:"Pipeline execution"})]}),"\n",(0,o.jsx)(n.p,{children:"The pipeline to add accounts will then execute, and can be monitored in the pipeline view."}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"Pipeline View",src:t(42557).A+"",width:"1300",height:"296"})}),"\n",(0,o.jsx)(n.h2,{id:"performing-account-checks",children:"Performing Account Checks"}),"\n",(0,o.jsxs)(n.p,{children:["Once the accounts are added to the / Forensic Acquisition and Investigation platform, it's recommended to regularly run Account Checks to ensure the necessary permissions are still in place for acquisitions. For details on running these checks, refer to ",(0,o.jsx)(n.a,{href:"/cado/manage/monitoring#account-check",children:"Account Check"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},61600:(e,n,t)=>{t.d(n,{A:()=>o});const o=t.p+"assets/images/aws-orgs-list-accounts-role-2-2fbc76e6c1d38cd57bae5f81efd7141d.png"},1153:(e,n,t)=>{t.d(n,{A:()=>o});const o=t.p+"assets/images/aws-orgs-list-accounts-role-3f4052b4ac5476782e4a72c1e5ccb421.png"},42557:(e,n,t)=>{t.d(n,{A:()=>o});const o=t.p+"assets/images/aws-orgs-pipeline-281f923cbaca6bc90af353ae6c88fd0d.png"},28453:(e,n,t)=>{t.d(n,{R:()=>c,x:()=>a});var o=t(96540);const s={},i=o.createContext(s);function c(e){const n=o.useContext(i);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),o.createElement(i.Provider,{value:n},e.children)}}}]);