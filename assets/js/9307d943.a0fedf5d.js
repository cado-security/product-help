"use strict";(self.webpackChunkproduct_help=self.webpackChunkproduct_help||[]).push([[2957],{7745:(e,o,s)=>{s.r(o),s.d(o,{assets:()=>a,contentTitle:()=>r,default:()=>h,frontMatter:()=>n,metadata:()=>c,toc:()=>d});var t=s(5893),i=s(1151);const n={title:"Google Workspace logs",hide_title:!0,sidebar_position:10},r="How to Import Google Workspace Logs",c={id:"cado/discovery-import/google-workspace-logs",title:"Google Workspace logs",description:"Introduction",source:"@site/docs/cado/discovery-import/google-workspace-logs.md",sourceDirName:"cado/discovery-import",slug:"/cado/discovery-import/google-workspace-logs",permalink:"/cado/discovery-import/google-workspace-logs",draft:!1,unlisted:!1,editUrl:"https://github.com/cado-security/product-help/tree/master/docs/cado/discovery-import/google-workspace-logs.md",tags:[],version:"current",lastUpdatedAt:1730885743,formattedLastUpdatedAt:"Nov 6, 2024",sidebarPosition:10,frontMatter:{title:"Google Workspace logs",hide_title:!0,sidebar_position:10},sidebar:"tutorialSidebar",previous:{title:"Kubernetes",permalink:"/cado/discovery-import/kubernetes"},next:{title:"Microsoft 365 and Entra ID",permalink:"/cado/discovery-import/m365-logs"}},a={},d=[{value:"Introduction",id:"introduction",level:3},{value:"Log Acquisition",id:"log-acquisition",level:3},{value:"Log Field Mapping",id:"log-field-mapping",level:3}];function l(e){const o={a:"a",br:"br",code:"code",h1:"h1",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.h1,{id:"how-to-import-google-workspace-logs",children:"How to Import Google Workspace Logs"}),"\n",(0,t.jsx)(o.h3,{id:"introduction",children:"Introduction"}),"\n",(0,t.jsxs)(o.p,{children:["The Cado platform supports the acquisition and processing of Google Workspace logs. Activity logs from various Google Workspace applications can be captured, as listed ",(0,t.jsx)(o.a,{href:"https://developers.google.com/admin-sdk/reports/reference/rest/v1/activities",children:"here"}),"."]}),"\n",(0,t.jsxs)(o.p,{children:['Note: This feature is currently in Beta. To use it, enable the "SaaS Imports" feature on the ',(0,t.jsx)(o.strong,{children:"/settings/experiments"})," page."]}),"\n",(0,t.jsx)(o.p,{children:"Before importing Google Workspace logs into Cado, follow these steps:"}),"\n",(0,t.jsxs)(o.ol,{children:["\n",(0,t.jsxs)(o.li,{children:["Ensure that ",(0,t.jsx)(o.strong,{children:"Workspace API access"})," for your Google Cloud project is enabled (Admin SDK API access)."]}),"\n"]}),"\n",(0,t.jsxs)(o.ul,{children:["\n",(0,t.jsxs)(o.li,{children:["Open the ",(0,t.jsx)(o.a,{href:"https://console.cloud.google.com/workspace-api/products",children:"product library in Google Cloud"})]}),"\n"]}),"\n",(0,t.jsxs)(o.p,{children:[(0,t.jsx)(o.img,{alt:"SDK 1",src:s(6896).Z+"",width:"1916",height:"1190"}),"\n",(0,t.jsx)(o.img,{alt:"SDK 1",src:s(4217).Z+"",width:"2632",height:"1078"})]}),"\n",(0,t.jsxs)(o.ol,{start:"2",children:["\n",(0,t.jsxs)(o.li,{children:["Enable the ",(0,t.jsx)(o.a,{href:"https://developers.google.com/workspace/guides/configure-oauth-consent",children:"Internal OAuth Consent Screen"})," to allow authentication with a service account."]}),"\n"]}),"\n",(0,t.jsx)(o.p,{children:(0,t.jsx)(o.img,{alt:"OAuth Consent Screen",src:s(4921).Z+"",width:"1292",height:"1534"})}),"\n",(0,t.jsxs)(o.ol,{start:"3",children:["\n",(0,t.jsxs)(o.li,{children:["\n",(0,t.jsxs)(o.p,{children:[(0,t.jsx)(o.a,{href:"https://developers.google.com/identity/protocols/oauth2/service-account",children:"Create a service account"})," in Google Cloud, and download the JSON file of the access key created for the service account."]}),"\n"]}),"\n",(0,t.jsxs)(o.li,{children:["\n",(0,t.jsxs)(o.p,{children:["Note the email address of a ",(0,t.jsx)(o.strong,{children:"Google Workspace admin account"})," for the Impersonation Email field, which will be entered into the Cado platform."]}),"\n"]}),"\n",(0,t.jsxs)(o.li,{children:["\n",(0,t.jsxs)(o.p,{children:["Grant the service account permission to access the Workspace API via ",(0,t.jsx)(o.strong,{children:"domain-wide delegation"}),", with read-only access to audit logs:",(0,t.jsx)(o.br,{}),"\n",(0,t.jsx)(o.code,{children:"https://www.googleapis.com/auth/admin.reports.audit.readonly"}),"."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(o.h3,{id:"log-acquisition",children:"Log Acquisition"}),"\n",(0,t.jsxs)(o.p,{children:["After completing the setup, you can add the service account credentials to the Cado platform by navigating to ",(0,t.jsx)(o.strong,{children:"Settings > Integrations > Google Workspace"})," (/settings/integrations/google-workspace) and selecting ",(0,t.jsx)(o.strong,{children:"Add Credentials"}),". Provide the following details:"]}),"\n",(0,t.jsxs)(o.ul,{children:["\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.strong,{children:"Name"}),": A friendly name for your credentials, such as \u201cGoogle Workspace.\u201d"]}),"\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.strong,{children:"Impersonation Email"}),": The Google Workspace admin email."]}),"\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.strong,{children:"Service Account Credentials"}),": Upload the JSON file for the service account."]}),"\n"]}),"\n",(0,t.jsx)(o.p,{children:(0,t.jsx)(o.img,{alt:"Google Workspace - Add Creds",src:s(7999).Z+"",width:"3844",height:"1876"})}),"\n",(0,t.jsxs)(o.p,{children:["Once the credentials are set, you can acquire Google Workspace logs. In an investigation, use the import wizard and select ",(0,t.jsx)(o.strong,{children:"SaaS"}),", then choose ",(0,t.jsx)(o.strong,{children:"Google Workspace"}),"."]}),"\n",(0,t.jsx)(o.p,{children:(0,t.jsx)(o.img,{alt:"Google Workspace - Import",src:s(725).Z+"",width:"1910",height:"1164"})}),"\n",(0,t.jsx)(o.p,{children:"Next, select the credentials you entered in the integrations page."}),"\n",(0,t.jsx)(o.p,{children:(0,t.jsx)(o.img,{alt:"Google Workspace - Select credentials",src:s(9095).Z+"",width:"5098",height:"1120"})}),"\n",(0,t.jsx)(o.p,{children:"You will then have the option to refine the acquisition by timeframe, application, or user."}),"\n",(0,t.jsx)(o.p,{children:(0,t.jsx)(o.img,{alt:"Google Workspace - Import Configuration",src:s(3514).Z+"",width:"3132",height:"1240"})}),"\n",(0,t.jsx)(o.p,{children:"Review your selections and proceed with the import. Once the acquisition and processing are complete, the logs will be available for viewing and searching on the main timeline page."}),"\n",(0,t.jsx)(o.h3,{id:"log-field-mapping",children:"Log Field Mapping"}),"\n",(0,t.jsx)(o.p,{children:"To help with analysis, certain Google Workspace fields are mapped to Cado fields:"}),"\n",(0,t.jsxs)(o.table,{children:[(0,t.jsx)(o.thead,{children:(0,t.jsxs)(o.tr,{children:[(0,t.jsx)(o.th,{children:"Google Workspace Field"}),(0,t.jsx)(o.th,{children:"Cado Field"}),(0,t.jsx)(o.th,{children:"Cado Facet Name"})]})}),(0,t.jsxs)(o.tbody,{children:[(0,t.jsxs)(o.tr,{children:[(0,t.jsx)(o.td,{children:(0,t.jsx)(o.code,{children:"ipAddress"})}),(0,t.jsx)(o.td,{children:(0,t.jsx)(o.code,{children:"source_hostname"})}),(0,t.jsx)(o.td,{children:"Source Hostname"})]}),(0,t.jsxs)(o.tr,{children:[(0,t.jsx)(o.td,{children:(0,t.jsx)(o.code,{children:"actor.email"})}),(0,t.jsx)(o.td,{children:(0,t.jsx)(o.code,{children:"user"})}),(0,t.jsx)(o.td,{children:"Users"})]}),(0,t.jsxs)(o.tr,{children:[(0,t.jsx)(o.td,{children:(0,t.jsx)(o.code,{children:"id.applicationName"})}),(0,t.jsx)(o.td,{children:(0,t.jsx)(o.code,{children:"sourcetype"})}),(0,t.jsx)(o.td,{children:"Datatype"})]})]})]}),"\n",(0,t.jsx)(o.p,{children:"For example, you can filter the dataset by the 'Mobile' application by selecting it under the \"Datatype\" facet."}),"\n",(0,t.jsx)(o.p,{children:(0,t.jsx)(o.img,{alt:"Google Workspace - Timeline Filtering",src:s(871).Z+"",width:"2906",height:"1588"})})]})}function h(e={}){const{wrapper:o}={...(0,i.a)(),...e.components};return o?(0,t.jsx)(o,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},7999:(e,o,s)=>{s.d(o,{Z:()=>t});const t=s.p+"assets/images/gws-add-creds-6f7439102c83af59244f8c1db827e23e.png"},3514:(e,o,s)=>{s.d(o,{Z:()=>t});const t=s.p+"assets/images/gws-import-config-15d5f8e8effe51a8f9ce32f4edddbae3.png"},9095:(e,o,s)=>{s.d(o,{Z:()=>t});const t=s.p+"assets/images/gws-import-select-creds-cd592c792560fc2f7031dbfcaffd4b8c.png"},725:(e,o,s)=>{s.d(o,{Z:()=>t});const t=s.p+"assets/images/gws-import-bac5b586a56f4a34c72d557f0a996ed5.png"},871:(e,o,s)=>{s.d(o,{Z:()=>t});const t=s.p+"assets/images/gws-timeline-a8fec9b507463b43232ac69f42472009.png"},4921:(e,o,s)=>{s.d(o,{Z:()=>t});const t=s.p+"assets/images/oauth_consent-5559900df621012819df41d4ed04e955.png"},6896:(e,o,s)=>{s.d(o,{Z:()=>t});const t=s.p+"assets/images/workspace_sdk1-d2b726512380e24ba91a434afba83490.png"},4217:(e,o,s)=>{s.d(o,{Z:()=>t});const t=s.p+"assets/images/workspace_sdk2-c8d56eb86d3932d907031721fbfaecab.png"},1151:(e,o,s)=>{s.d(o,{Z:()=>c,a:()=>r});var t=s(7294);const i={},n=t.createContext(i);function r(e){const o=t.useContext(n);return t.useMemo((function(){return"function"==typeof e?e(o):{...o,...e}}),[o,e])}function c(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),t.createElement(n.Provider,{value:o},e.children)}}}]);