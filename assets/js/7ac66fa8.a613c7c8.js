"use strict";(self.webpackChunkproduct_help=self.webpackChunkproduct_help||[]).push([[2713],{5959:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>o,toc:()=>d});var i=s(5893),n=s(1151);const a={title:"EC2 and EBS",hide_title:!0,sidebar_position:1},r="How to Import AWS EC2 and EBS Data into Cado",o={id:"cado/discovery-import/aws/aws-ec2",title:"EC2 and EBS",description:"Cado supports acquiring data from EC2 instances. Start by selecting the region, which will populate a list of available EC2 instances. You can filter this list by instance ID, name, state, or public IP address. Once you\u2019ve found the instance you want to acquire, select it.",source:"@site/docs/cado/discovery-import/aws/aws-ec2.md",sourceDirName:"cado/discovery-import/aws",slug:"/cado/discovery-import/aws/aws-ec2",permalink:"/cado/discovery-import/aws/aws-ec2",draft:!1,unlisted:!1,editUrl:"https://github.com/cado-security/product-help/tree/master/docs/cado/discovery-import/aws/aws-ec2.md",tags:[],version:"current",lastUpdatedAt:1730149204,formattedLastUpdatedAt:"Oct 28, 2024",sidebarPosition:1,frontMatter:{title:"EC2 and EBS",hide_title:!0,sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Automating collection from detections",permalink:"/cado/discovery-import/automation"},next:{title:"S3",permalink:"/cado/discovery-import/aws/aws-s3"}},c={},d=[{value:"Capture Options",id:"capture-options",level:2},{value:"Volume Capture",id:"volume-capture",level:3},{value:"Triage Capture",id:"triage-capture",level:3},{value:"Triage Capture with SSM Port Forwarding (Linux Only)",id:"triage-capture-with-ssm-port-forwarding-linux-only",level:4},{value:"Run Command",id:"run-command",level:3},{value:"Creating a Saved Script",id:"creating-a-saved-script",level:4},{value:"Running the Script",id:"running-the-script",level:4},{value:"Data Flow Diagram",id:"data-flow-diagram",level:3}];function l(e){const t={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,n.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h1,{id:"how-to-import-aws-ec2-and-ebs-data-into-cado",children:"How to Import AWS EC2 and EBS Data into Cado"}),"\n",(0,i.jsx)(t.p,{children:"Cado supports acquiring data from EC2 instances. Start by selecting the region, which will populate a list of available EC2 instances. You can filter this list by instance ID, name, state, or public IP address. Once you\u2019ve found the instance you want to acquire, select it."}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"AWS EC2 Import",src:s(120).Z+"",width:"1782",height:"682"})}),"\n",(0,i.jsxs)(t.p,{children:["Click ",(0,i.jsx)(t.strong,{children:"Continue"})," to proceed."]}),"\n",(0,i.jsx)(t.h2,{id:"capture-options",children:"Capture Options"}),"\n",(0,i.jsx)(t.h3,{id:"volume-capture",children:"Volume Capture"}),"\n",(0,i.jsx)(t.p,{children:"Set your options for what data to capture from the selected instance."}),"\n",(0,i.jsx)(t.h3,{id:"triage-capture",children:"Triage Capture"}),"\n",(0,i.jsxs)(t.p,{children:["For a faster triage collection on an EC2 instance, use ",(0,i.jsx)(t.strong,{children:"Triage Acquisition"})," via Cado Host. This requires that AWS Systems Manager (SSM) be enabled on the target instance and also supports memory collection on Linux systems."]}),"\n",(0,i.jsxs)(t.p,{children:["For more details about what Cado Host collects, refer to the ",(0,i.jsx)(t.a,{href:"/cado/discovery-import/cado-host/intro",children:"Collected Artifacts Documentation"}),"."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"AWS EC2 Triage Acquisition",src:s(5615).Z+"",width:"5112",height:"1674"})}),"\n",(0,i.jsxs)(t.p,{children:["Click ",(0,i.jsx)(t.strong,{children:"Continue"}),", review your selections, and click ",(0,i.jsx)(t.strong,{children:"Start Import"}),"."]}),"\n",(0,i.jsx)(t.h4,{id:"triage-capture-with-ssm-port-forwarding-linux-only",children:"Triage Capture with SSM Port Forwarding (Linux Only)"}),"\n",(0,i.jsxs)(t.p,{children:["When using ",(0,i.jsx)(t.strong,{children:"Triage Acquisition"})," for a Linux EC2 instance, you can enable the ",(0,i.jsx)(t.strong,{children:"SSM Port Forwarding"})," option. This is useful for instances with restricted network access, where downloading the Cado Host binary directly is not possible. The SSM Port Forwarding feature transfers the binary to the instance and retrieves the triage capture. To support transfering of files over the SSM port forwarding, we require Python 3.8+ to be installed on the instance."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"AWS EC2 Triage Acquisition Port Forwarding",src:s(730).Z+"",width:"2557",height:"836"})}),"\n",(0,i.jsx)(t.h3,{id:"run-command",children:"Run Command"}),"\n",(0,i.jsxs)(t.p,{children:["Cado allows you to execute scripts on target systems using the ",(0,i.jsx)(t.strong,{children:"Run Command"})," feature in the import wizard. This requires the ",(0,i.jsx)(t.a,{href:"https://docs.aws.amazon.com/systems-manager/latest/userguide/systems-manager-setting-up-ec2.html",children:"AWS Systems Manager Agent (SSM)"})," to be installed on the instance and admin privileges. To support transfering of files over the SSM port forwarding, we require Python 3.8+ to be installed on the instance."]}),"\n",(0,i.jsxs)(t.p,{children:["To use this feature, you must create a script in ",(0,i.jsx)(t.strong,{children:"/settings/scripts"}),"."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.em,{children:"Note: This feature is in Beta. To enable it, go to Settings > Experiments > Run Action."})}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"AWS EC2 Run Command",src:s(5027).Z+"",width:"3542",height:"1672"})}),"\n",(0,i.jsx)(t.h4,{id:"creating-a-saved-script",children:"Creating a Saved Script"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{children:["Go to ",(0,i.jsx)(t.strong,{children:"/settings/scripts"})," and click ",(0,i.jsx)(t.strong,{children:"Create Script"}),"."]}),"\n",(0,i.jsx)(t.li,{children:"Choose whether the script will run on Linux or Windows (reduced functionality for Windows). For this example, we\u2019ll choose Linux."}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Saved Script",src:s(3678).Z+"",width:"3260",height:"858"})}),"\n",(0,i.jsxs)(t.ol,{start:"3",children:["\n",(0,i.jsxs)(t.li,{children:["In Step 1, provide a ",(0,i.jsx)(t.strong,{children:"Name"})," and ",(0,i.jsx)(t.strong,{children:"Description"})," for the script."]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Saved Script - Step 1",src:s(4903).Z+"",width:"3804",height:"1082"})}),"\n",(0,i.jsxs)(t.ol,{start:"4",children:["\n",(0,i.jsx)(t.li,{children:"In Step 2, provide the location of the input file (valid S3 URI), which will be downloaded onto the target system. This step is not available for Windows scripts."}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Saved Script - Step 2",src:s(9125).Z+"",width:"3768",height:"952"})}),"\n",(0,i.jsxs)(t.ol,{start:"5",children:["\n",(0,i.jsx)(t.li,{children:"In Step 3, specify the location of the output file on the target system that will be uploaded to your Cado S3 bucket. This step is not available for Windows scripts."}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Saved Script - Step 3",src:s(4279).Z+"",width:"3782",height:"950"})}),"\n",(0,i.jsxs)(t.ol,{start:"6",children:["\n",(0,i.jsxs)(t.li,{children:["In Step 4, paste the script that will run on the target system. The input and output files can be referenced as ",(0,i.jsx)(t.code,{children:"${INPUT}"})," and ",(0,i.jsx)(t.code,{children:"${OUTPUT}"})," respectively. Windows scripts do not require these variables."]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"Example script:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:'mkdir -p /tmp/cado-volexity\ncp ${INPUT} /tmp/cado-volexity/surge-collect\nchmod 755 /tmp/cado-volexity/surge-collect\nmkdir -p /tmp/cado-volexity/out\n/tmp/cado-volexity/surge-collect example /tmp/cado-volexity/out\ntar -cvzf /tmp/cado-volexity/out.tar.gz /tmp/cado-volexity/out\ncp "/tmp/cado-volexity/out.tar.gz" ${OUTPUT}\nrm -rf /tmp/cado-volexity\n'})}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Saved Script - Step 4",src:s(5263).Z+"",width:"1571",height:"591"})}),"\n",(0,i.jsxs)(t.ol,{start:"7",children:["\n",(0,i.jsxs)(t.li,{children:["Click ",(0,i.jsx)(t.strong,{children:"Continue"})," and you\u2019ll see your script listed in the scripts table."]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Saved Script - Table",src:s(7296).Z+"",width:"3856",height:"704"})}),"\n",(0,i.jsx)(t.h4,{id:"running-the-script",children:"Running the Script"}),"\n",(0,i.jsxs)(t.p,{children:["Use the Import Wizard to select an EC2 instance with the SSM agent installed. Choose ",(0,i.jsx)(t.strong,{children:"Run Command"})," as the action type, and you\u2019ll see the script created earlier. Complete the import as usual."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"AWS EC2 Run Command - Selecting Saved Script",src:s(5661).Z+"",width:"2557",height:"766"})}),"\n",(0,i.jsx)(t.h3,{id:"data-flow-diagram",children:"Data Flow Diagram"}),"\n",(0,i.jsx)(t.p,{children:"Below are diagrams illustrating how EC2 disk acquisitions work:"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"EC2 Disk Acquisition",src:s(1419).Z+"",width:"1962",height:"1044"})}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"EC2 Role Acquisition",src:s(4303).Z+"",width:"1910",height:"970"})}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"EBS Direct Acquisition",src:s(4454).Z+"",width:"960",height:"540"})}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"EC2 SSM Acquisition",src:s(9720).Z+"",width:"1674",height:"1056"})}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"EC2 Tunnel Acquisition",src:s(296).Z+"",width:"960",height:"540"})})]})}function h(e={}){const{wrapper:t}={...(0,n.a)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},5027:(e,t,s)=>{s.d(t,{Z:()=>i});const i=s.p+"assets/images/aws-ec2-runcommand1-7764e292a16eb3d98940f9a32d65ca25.png"},3678:(e,t,s)=>{s.d(t,{Z:()=>i});const i=s.p+"assets/images/aws-ec2-runcommand2-288f66be5d4fb261f6207c93743a543f.png"},4903:(e,t,s)=>{s.d(t,{Z:()=>i});const i=s.p+"assets/images/aws-ec2-runcommand3-7257948f4bdb99d8aa66a885272d748e.png"},9125:(e,t,s)=>{s.d(t,{Z:()=>i});const i=s.p+"assets/images/aws-ec2-runcommand4-fceb04cb187da005d1315bab4eaf3312.png"},4279:(e,t,s)=>{s.d(t,{Z:()=>i});const i=s.p+"assets/images/aws-ec2-runcommand5-d2b458182764d522153cad1d21737b13.png"},5263:(e,t,s)=>{s.d(t,{Z:()=>i});const i=s.p+"assets/images/aws-ec2-runcommand6-6639a15695b4a1c2c390bac386602bb0.png"},7296:(e,t,s)=>{s.d(t,{Z:()=>i});const i=s.p+"assets/images/aws-ec2-runcommand7-a9f5882a4a8593e57c7cc2d7d573397d.png"},5661:(e,t,s)=>{s.d(t,{Z:()=>i});const i=s.p+"assets/images/aws-ec2-runcommand8-086d386919e813238dd77de5830563d0.png"},730:(e,t,s)=>{s.d(t,{Z:()=>i});const i=s.p+"assets/images/aws-ec2-triage-acquisition-ssm-port-forwarding-170c58d02a54ae9e2b41e8c1435e6abc.png"},5615:(e,t,s)=>{s.d(t,{Z:()=>i});const i=s.p+"assets/images/aws-ec2-triage-acquisition-4000535f4a0f1d726d46d8e287a22bf0.png"},120:(e,t,s)=>{s.d(t,{Z:()=>i});const i=s.p+"assets/images/aws-ec2-90029871d7a092c458840a666b860193.png"},4454:(e,t,s)=>{s.d(t,{Z:()=>i});const i=s.p+"assets/images/ebs-direct-912f116a66d654c805c822aa53205f47.png"},9720:(e,t,s)=>{s.d(t,{Z:()=>i});const i=s.p+"assets/images/ec2-ssm-d9a42580843ce87b725c9b3ebc71fb27.png"},296:(e,t,s)=>{s.d(t,{Z:()=>i});const i=s.p+"assets/images/ec2-tunnel-b1d9d799120c1f73992d72672da59c5f.png"},1419:(e,t,s)=>{s.d(t,{Z:()=>i});const i=s.p+"assets/images/import-aws-ec2-cross-758df5780c02d9c03b57e6c3daabd5a2.png"},4303:(e,t,s)=>{s.d(t,{Z:()=>i});const i=s.p+"assets/images/import-aws-ec2-role-cb06da4ab775408d7a98a21af1fe4da6.png"},1151:(e,t,s)=>{s.d(t,{Z:()=>o,a:()=>r});var i=s(7294);const n={},a=i.createContext(n);function r(e){const t=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:r(e.components),i.createElement(a.Provider,{value:t},e.children)}}}]);