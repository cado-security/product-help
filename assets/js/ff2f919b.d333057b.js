"use strict";(self.webpackChunkproduct_help=self.webpackChunkproduct_help||[]).push([[8866],{3905:function(e,t,r){r.d(t,{Zo:function(){return p},kt:function(){return d}});var n=r(7294);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var l=n.createContext({}),m=function(e){var t=n.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},p=function(e){var t=m(e.components);return n.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var r=e.components,o=e.mdxType,a=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),c=m(r),d=o,y=c["".concat(l,".").concat(d)]||c[d]||u[d]||a;return r?n.createElement(y,i(i({ref:t},p),{},{components:r})):n.createElement(y,i({ref:t},p))}));function d(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=r.length,i=new Array(a);i[0]=c;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:o,i[1]=s;for(var m=2;m<a;m++)i[m]=r[m];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}c.displayName="MDXCreateElement"},7770:function(e,t,r){r.r(t),r.d(t,{assets:function(){return p},contentTitle:function(){return l},default:function(){return d},frontMatter:function(){return s},metadata:function(){return m},toc:function(){return u}});var n=r(7462),o=r(3366),a=(r(7294),r(3905)),i=["components"],s={title:"Memory Analysis",hide_title:!0,sidebar_position:3},l="Memory Analysis",m={unversionedId:"cado-response/importing-data/memory",id:"cado-response/importing-data/memory",title:"Memory Analysis",description:"Memory analysis support is currently in beta. You can enable it under the Advanced tab of the Settings page:",source:"@site/docs/cado-response/importing-data/memory.md",sourceDirName:"cado-response/importing-data",slug:"/cado-response/importing-data/memory",permalink:"/cado-response/importing-data/memory",draft:!1,editUrl:"https://github.com/cado-security/product-help/tree/master/docs/cado-response/importing-data/memory.md",tags:[],version:"current",lastUpdatedAt:1657554944,formattedLastUpdatedAt:"7/11/2022",sidebarPosition:3,frontMatter:{title:"Memory Analysis",hide_title:!0,sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"File Types",permalink:"/cado-response/importing-data/filetypes"},next:{title:"AWS KMS Support",permalink:"/cado-response/importing-data/aws-kms"}},p={},u=[{value:"Structured Memory Analysis",id:"structured-memory-analysis",level:2},{value:"Unstructured Memory Analysis",id:"unstructured-memory-analysis",level:2}],c={toc:u};function d(e){var t=e.components,r=(0,o.Z)(e,i);return(0,a.kt)("wrapper",(0,n.Z)({},c,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"memory-analysis"},"Memory Analysis"),(0,a.kt)("p",null,"Memory analysis support is currently in beta. You can enable it under the ",(0,a.kt)("strong",{parentName:"p"},"Advanced")," tab of the ",(0,a.kt)("strong",{parentName:"p"},"Settings")," page:"),(0,a.kt)("p",null,"Once enabled, there are several options for acquiring memory:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"To acquire memory from a running AWS EC2 instance, browse to ",(0,a.kt)("inlineCode",{parentName:"li"},"Import > AWS EC2 Instance")," find the EC2 you wish to acquire memory from and click the  ",(0,a.kt)("strong",{parentName:"li"},"Import Memory")," button.  If you do not see the ",(0,a.kt)("strong",{parentName:"li"},"Import Memory")," button, please enable Memory Capture under 'Settings > Advanced > Memory Capture'.")),(0,a.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,a.kt)("div",{parentName:"div",className:"admonition-heading"},(0,a.kt)("h5",{parentName:"div"},(0,a.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,a.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,a.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,a.kt)("div",{parentName:"div",className:"admonition-content"},(0,a.kt)("p",{parentName:"div"},"Note that importing memory via ",(0,a.kt)("inlineCode",{parentName:"p"},"Import > AWS EC2 Instance")," requires the AWS SSM agent to be running on the EC2 and registered within the AWS Systems Manager."))),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},"Alternatively, you can perform a memory acquisition of a Windows or Linux system by clicking ",(0,a.kt)("inlineCode",{parentName:"li"},"Import > Memory Collection")," and running the pre-generated script on the host device."),(0,a.kt)("li",{parentName:"ol"},"Lastly, for importing externally acquired memory, ensure the memory dump is named with a ",(0,a.kt)("inlineCode",{parentName:"li"},".mem")," file extension so it is recognized as a memory file and upload the memory file to an S3 bucket to which Cado Response has access.  Then click ",(0,a.kt)("inlineCode",{parentName:"li"},"Import > AWS S3 Bucket")," within Cado Response, navigate to the S3 bucket where the .mem file resides, and import it.    ")),(0,a.kt)("p",null,"It will take approximately 30 minutes for smaller memory files to process - more for those with large amounts of memory. Once processed, you will be able to browse the file system including the contents of files (if they were in memory at the time) and view information from running processes and network connections.  "),(0,a.kt)("h2",{id:"structured-memory-analysis"},"Structured Memory Analysis"),(0,a.kt)("p",null,"As a first step in memory analysis, Cado Response will attempt to perform structured memory analysis. If it is not possible, it will fall back to unstructured memory analysis."),(0,a.kt)("p",null,"Under the hood, Cado Response is using Volatility 2 (",(0,a.kt)("a",{parentName:"p",href:"https://github.com/volatilityfoundation/volatility/"},"https://github.com/volatilityfoundation/volatility/"),") which supports structured analysis of memory dumps. A limitation is that it generally only works on older operating systems:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Up to Win10x64_19041"),(0,a.kt)("li",{parentName:"ul"},"For Linux systems, we attempt to dynamically generate a profile."),(0,a.kt)("li",{parentName:"ul"},"Up to OSX 10.15.x Catalina (these .mem files would need to be collected seperately, using other tools. Cado Response does not collect memory dumps from OSX systems at the moment)")),(0,a.kt)("h2",{id:"unstructured-memory-analysis"},"Unstructured Memory Analysis"),(0,a.kt)("p",null,"Unstructured memory analysis allows Cado Response to extract key log data and perform Yara/Anti-Virus scans of memory regardless of the operating system. For this, we use an optimised version of our public Rip Raw tool (",(0,a.kt)("a",{parentName:"p",href:"https://github.com/cado-security/rip_raw"},"https://github.com/cado-security/rip_raw"),")"))}d.isMDXComponent=!0}}]);