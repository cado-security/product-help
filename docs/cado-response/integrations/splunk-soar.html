<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.7">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-163801898-1","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script><title data-react-helmet="true">Splunk SOAR | Cado Security</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://cado-security.github.io/docs/cado-response/integrations/splunk-soar"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Splunk SOAR | Cado Security"><meta data-react-helmet="true" name="description" content="Splunk SOAR is a Security Orchestration, Automation, and Response (SOAR) system. The Splunk SOAR platform combines security infrastructure orchestration, playbook automation, and case management capabilities to integrate your team, processes, and tools together including integrating with Cado Response."><meta data-react-helmet="true" property="og:description" content="Splunk SOAR is a Security Orchestration, Automation, and Response (SOAR) system. The Splunk SOAR platform combines security infrastructure orchestration, playbook automation, and case management capabilities to integrate your team, processes, and tools together including integrating with Cado Response."><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://cado-security.github.io/docs/cado-response/integrations/splunk-soar"><link data-react-helmet="true" rel="alternate" href="https://cado-security.github.io/docs/cado-response/integrations/splunk-soar" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://cado-security.github.io/docs/cado-response/integrations/splunk-soar" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.f76486d1.css">
<link rel="preload" href="/assets/js/runtime~main.2f4fd427.js" as="script">
<link rel="preload" href="/assets/js/main.8b6e7a05.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/cado.png" alt="Cado Logo" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/img/cado-dark.png" alt="Cado Logo" class="themedImage_1VuW themedImage--dark_hz6m"></div><b class="navbar__title"> </b></a></div><div class="navbar__items navbar__items--right"><div class="toggle_71bT toggle_3Zt9 toggleDisabled_3cF-"><div class="toggleTrack_32Fl" role="button" tabindex="-1"><div class="toggleTrackCheck_3lV7"><span class="toggleIcon_O4iE" style="margin-left:2px">ðŸŒ™</span></div><div class="toggleTrackX_S2yS"><span class="toggleIcon_O4iE" style="margin-left:1px">â˜€</span></div><div class="toggleTrackThumb_xI_Z"></div></div><input type="checkbox" class="toggleScreenReader_28Tw" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Cado Response</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cado-response/intro">Summary</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Getting Started</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Projects and Users</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Importing</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Investigating</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Settings</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Integrations</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cado-response/integrations/api-overview">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cado-response/integrations/siem">SIEM</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cado-response/integrations/sentinelone">SentinelOne</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cado-response/integrations/tines">Tines</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/cado-response/integrations/splunk-soar">Splunk SOAR</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Single Sign On</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Guides</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Cado Host</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Troubleshooting</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Splunk SOAR Integration</h1></header><p>Splunk SOAR is a Security Orchestration, Automation, and Response (SOAR) system. The Splunk SOAR platform combines security infrastructure orchestration, playbook automation, and case management capabilities to integrate your team, processes, and tools together including integrating with Cado Response.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="getting-started">Getting Started<a aria-hidden="true" class="hash-link" href="#getting-started" title="Direct link to heading">â€‹</a></h2><p>Before getting started, please see the <strong><a href="/docs/cado-response/integrations/api-overview">Integrations Overview &gt;</a></strong> page for general instructions on setting up the Cado Response platform for integration with third-party tools.</p><p>Below are the instructions for setting up the Cado Response and Splunk SOAR integration:</p><ol><li><strong><a href="#create-an-api-access-key">Create an API Access Key</a></strong></li><li><strong><a href="#install-and-configure-the-cado-response-app">Install and configure the Cado Response app in Splunk SOAR</a></strong></li><li><strong><a href="#configuration-variables">Set your configuration variables</a></strong></li><li><strong><a href="#test-your-connection">Test your connection</a></strong></li><li><strong><a href="#playbooks">Setup your Playbooks</a></strong></li></ol><h3 class="anchor anchorWithStickyNavbar_31ik" id="create-an-api-access-key">Create an API Access Key<a aria-hidden="true" class="hash-link" href="#create-an-api-access-key" title="Direct link to heading">â€‹</a></h3><p>In order to allow third-party services to authenticate and interact with a Cado Response instance, you will need to <strong><a href="/docs/cado-response/integrations/api-overview#creating-and-storing-an-api-access-key">Create an API Access Key</a></strong> for use within Splunk SOAR.</p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p>In addition to the API Access Key, please ensure that the Splunk SOAR platform has access (network, firewall, etc) to make API calls to the Cado Response platform.</p></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="install-and-configure-the-cado-response-app">Install and Configure the Cado Response App<a aria-hidden="true" class="hash-link" href="#install-and-configure-the-cado-response-app" title="Direct link to heading">â€‹</a></h3><p>In order to install and configure the Cado Response Splunk SOAR App, you will need the below information:</p><ul><li>The latest version of the Cado Response Splunk SOAR App Add-on from the <a href="https://splunkbase.splunk.com/app/6181/" target="_blank" rel="noopener noreferrer"><strong>Splunkbase Marketplace</strong></a></li><li>The URL to Cado Response, followed by <code>/api/v2</code></li><li>The API Access Key</li></ul><p>To install the Cado Response App, from within Splunk SOAR, navigate to <strong>Apps</strong> and click the <strong>INSTALL APP</strong> button in the top right of the page, then upload the Cado Response tarball and click <strong>INSTALL</strong>.</p><p>If you have successfully installed the Cado Response App you will see it appear under your <strong>Unconfigured Apps</strong>. Next, do the following:</p><ol><li>Click <strong>CONFIGURE NEW ASSET</strong> on the Cado Response App. </li><li>Fill in the Asset Info fields with a name and description. </li><li>Navigate to Asset Settings </li><li>input your URL for the Cado Response platform</li><li>input your <strong>Access token</strong> you generated earlier. </li><li>Click <strong>SAVE</strong> and <strong>TEST CONNECTIVITY</strong>. </li></ol><p>If all is successful, you should see a <code>Test Connectivity Passed</code> message.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="configuration-variables">Configuration Variables<a aria-hidden="true" class="hash-link" href="#configuration-variables" title="Direct link to heading">â€‹</a></h4><p>The below configuration variables are required to operate Cado Response via the Splunk SOAR App. These are specified when configuring an asset in Splunk SOAR.</p><table><thead><tr><th>VARIABLE</th><th>REQUIRED</th><th>TYPE</th><th>DESCRIPTION</th></tr></thead><tbody><tr><td>base_url</td><td>required</td><td>string</td><td>URL for the Cado Response Platform e.g. <code>https://cadoresponseurl/api/v2</code></td></tr><tr><td>access_token</td><td>required</td><td>password</td><td>Access token</td></tr><tr><td>default_project</td><td>optional</td><td>numeric</td><td>A project ID in Cado Response that can be used if a project ID is not specified in an action.</td></tr><tr><td>default_bucket</td><td>optional</td><td>string</td><td>A default bucket in Cado Response</td></tr><tr><td>default_region</td><td>optional</td><td>string</td><td>AWS region, e.g. us-east-1, that can be used if a region is not specified in an action.</td></tr></tbody></table><p>When running Actions, if the above inputs are required, they would be entered automatically into the response fields, but you are still able to replace them if you wish to use different values.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="test-your-connection">Test your connection<a aria-hidden="true" class="hash-link" href="#test-your-connection" title="Direct link to heading">â€‹</a></h3><p>When Cado Response is configured, you can validate your connection to make sure everything is set up correctly.</p><p>Navigate to <strong>Home -&gt; Apps -&gt; Cado Response Asset -&gt; Asset Settings</strong>. If you haven&#x27;t already, Edit and enter the Cado Response URL and Secret Key. Save and Test Connectivity to ensure everything is connected as expected.</p><p>If the following was successful, then you have correctly setup Splunk SOAR to interact with the Cado Response API.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="atomic-actions">Atomic Actions<a aria-hidden="true" class="hash-link" href="#atomic-actions" title="Direct link to heading">â€‹</a></h2><p>Atomic Actions are the basic actions that can be chained together in <em>Playbooks</em> that can be run to perform a specific task or workflow.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="list-projects">List Projects<a aria-hidden="true" class="hash-link" href="#list-projects" title="Direct link to heading">â€‹</a></h3><ul><li>Name: <code>list projects</code></li><li>Identifier: list_projects</li><li>Type: Investigate</li><li>Description: List projects that are currently active in the Cado Response platform.</li></ul><p><strong>Action Parameters</strong></p><p>No Parameters required for this action.</p><p><strong>Action Output</strong></p><table><thead><tr><th>DATA PATH</th><th>TYPE</th><th>EXAMPLE VALUE</th></tr></thead><tbody><tr><td>action_result.data.<!-- -->*<!-- -->.<!-- -->*<!-- -->.id</td><td>string</td><td>1</td></tr><tr><td>action_result.data.<!-- -->*<!-- -->.<!-- -->*<!-- -->.case_name</td><td>string</td><td>My First Project</td></tr><tr><td>action_result.status</td><td>string</td><td>success</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_31ik" id="list-ec2-instances">List EC2 instances<a aria-hidden="true" class="hash-link" href="#list-ec2-instances" title="Direct link to heading">â€‹</a></h3><ul><li>Name: <code>list instances</code></li><li>Identifier: list_instances</li><li>Type: Investigate</li><li>Description: List EC2 instances that are currently visible in the Cado Response platform.</li></ul><p><strong>Action Parameters</strong></p><table><thead><tr><th>PARAMETER</th><th>REQUIRED</th><th>DESCRIPTION</th><th>TYPE</th><th>EXAMPLE VALUE</th></tr></thead><tbody><tr><td>project_id</td><td>required</td><td>Project identifier as listed in the output of &quot;list projects&quot; action</td><td>numeric</td><td>1</td></tr></tbody></table><p><strong>Action Output</strong></p><table><thead><tr><th>DATA PATH</th><th>TYPE</th><th>EXAMPLE VALUE</th></tr></thead><tbody><tr><td>action_result.data.<!-- -->*<!-- -->.<!-- -->*<!-- -->.region</td><td>string</td><td>us-east-1</td></tr><tr><td>action_result.data.<!-- -->*<!-- -->.<!-- -->*<!-- -->.id</td><td>string</td><td>i-1234567890abcdef0</td></tr><tr><td>action_result.data.<!-- -->*<!-- -->.<!-- -->*<!-- -->.instance_name</td><td>string</td><td>CadoResponse-Test</td></tr><tr><td>action_result.data.<!-- -->*<!-- -->.<!-- -->*<!-- -->.instance_type</td><td>string</td><td>t3a.2xlarge</td></tr><tr><td>action_result.status</td><td>string</td><td>success</td></tr><tr><td>action_result.parameter.project_id</td><td>numeric</td><td>1</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_31ik" id="list-s3-buckets">List S3 buckets<a aria-hidden="true" class="hash-link" href="#list-s3-buckets" title="Direct link to heading">â€‹</a></h3><ul><li>Name: <code>list buckets</code></li><li>Identifier: list_buckets</li><li>Type: Investigate</li><li>Description: List S3 buckets that are currently visible to the Cado Response platform.</li></ul><p><strong>Action Parameters</strong></p><table><thead><tr><th>PARAMETER</th><th>REQUIRED</th><th>DESCRIPTION</th><th>TYPE</th><th>EXAMPLE VALUE</th></tr></thead><tbody><tr><td>project_id</td><td>required</td><td>Project identifier as listed in the output of &quot;list projects&quot; action</td><td>numeric</td><td>1</td></tr></tbody></table><p><strong>Action Output</strong></p><table><thead><tr><th>DATA PATH</th><th>TYPE</th><th>EXAMPLE VALUE</th></tr></thead><tbody><tr><td>action_result.data.<em>.</em>.bucket_name</td><td>string</td><td>test-bucket</td></tr><tr><td>action_result.parameter.project_id</td><td>numeric</td><td>1</td></tr><tr><td>action_result.status</td><td>string</td><td>success</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_31ik" id="list-pipelines">List Pipelines<a aria-hidden="true" class="hash-link" href="#list-pipelines" title="Direct link to heading">â€‹</a></h3><ul><li>Name: <code>list pipelines</code></li><li>Identifier: list_pipelines</li><li>Type: Investigate</li><li>Description: List pipelines for specified project in Cado Response platform.</li></ul><p><strong>Action Parameters</strong></p><table><thead><tr><th>PARAMETER</th><th>REQUIRED</th><th>DESCRIPTION</th><th>TYPE</th><th>EXAMPLE VALUE</th></tr></thead><tbody><tr><td>pipeline_id</td><td>required</td><td>Pipeline identifier as listed in the output of &quot;list pipelines&quot; action</td><td>numeric</td><td>6</td></tr></tbody></table><p><strong>Action Output</strong></p><table><thead><tr><th>DATA PATH</th><th>TYPE</th><th>EXAMPLE VALUE</th></tr></thead><tbody><tr><td>action_result.data.<!-- -->*<!-- -->.<!-- -->*<!-- -->.pipeline_id</td><td>numeric</td><td>6</td></tr><tr><td>action_result.data.<!-- -->*<!-- -->.<!-- -->*<!-- -->.name</td><td>string</td><td>Acquiring i-1234567890abcdef0</td></tr><tr><td>action_result.data.<!-- -->*<!-- -->.<!-- -->*<!-- -->.pipeline_type</td><td>string</td><td>Acquisition</td></tr><tr><td>action_result.data.<!-- -->*<!-- -->.<!-- -->*<!-- -->.evidence_id</td><td>numeric</td><td>4</td></tr><tr><td>action_result.data.<!-- -->*<!-- -->.<!-- -->*<!-- -->.summary.total</td><td>numeric</td><td>18</td></tr><tr><td>action_result.data.<!-- -->*<!-- -->.<!-- -->*<!-- -->.summary.failure</td><td>numeric</td><td>0</td></tr><tr><td>action_result.data.<!-- -->*<!-- -->.<!-- -->*<!-- -->.summary.pending</td><td>numeric</td><td>0</td></tr><tr><td>action_result.data.<!-- -->*<!-- -->.<!-- -->*<!-- -->.summary.running</td><td>numeric</td><td>0</td></tr><tr><td>action_result.data.<!-- -->*<!-- -->.<!-- -->*<!-- -->.summary.success</td><td>numeric</td><td>18</td></tr><tr><td>action_result.data.<!-- -->*<!-- -->.<!-- -->*<!-- -->.summary.cancelled</td><td>numeric</td><td>0</td></tr><tr><td>action_result.data.<!-- -->*<!-- -->.<!-- -->*<!-- -->.terminated</td><td>string</td><td>true</td></tr><tr><td>action_result.parameter.project_id</td><td>numeric</td><td>1</td></tr><tr><td>action_result.status</td><td>string</td><td>success</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_31ik" id="get-a-pipeline">Get a pipeline<a aria-hidden="true" class="hash-link" href="#get-a-pipeline" title="Direct link to heading">â€‹</a></h3><ul><li>Name: <code>get pipeline</code></li><li>Identifier: get_pipeline</li><li>Type: Investigate</li><li>Description: Get pipeline details for specified pipeline ID in Cado Response platform.</li></ul><p><strong>Action Parameters</strong></p><table><thead><tr><th>PARAMETER</th><th>REQUIRED</th><th>DESCRIPTION</th><th>TYPE</th><th>EXAMPLE VALUE</th></tr></thead><tbody><tr><td>pipeline_id</td><td>required</td><td>Pipeline identifier as listed in the output of &quot;get pipelines&quot; action</td><td>numeric</td><td>6</td></tr></tbody></table><p><strong>Action Output</strong></p><table><thead><tr><th>DATA PATH</th><th>TYPE</th><th>EXAMPLE VALUE</th></tr></thead><tbody><tr><td>action_result.data.<!-- -->*<!-- -->.<!-- -->*<!-- -->.pipeline_id</td><td>numeric</td><td>6</td></tr><tr><td>action_result.data.<!-- -->*<!-- -->.<!-- -->*<!-- -->.subtasks.<!-- -->*<!-- -->.name</td><td>string</td><td>Acquisition: Create a processing pipeline for each copied EC2 volume</td></tr><tr><td>action_result.data.<!-- -->*<!-- -->.<!-- -->*<!-- -->.subtasks.<!-- -->*<!-- -->.start_time</td><td>numeric</td><td>1633025565.147805</td></tr><tr><td>action_result.data.<!-- -->*<!-- -->.<!-- -->*<!-- -->.subtasks.<!-- -->*<!-- -->.finish_time</td><td>numeric</td><td>1633031638.334756</td></tr><tr><td>action_result.data.<!-- -->*<!-- -->.<!-- -->*<!-- -->.subtasks.<!-- -->*<!-- -->.execution_duration</td><td>numeric</td><td>6073</td></tr><tr><td>action_result.data.<!-- -->*<!-- -->.<!-- -->*<!-- -->.subtasks.<!-- -->*<!-- -->.state</td><td>string</td><td>SUCCESS</td></tr><tr><td>action_result.parameter.pipeline_id</td><td>numeric</td><td>6</td></tr><tr><td>action_result.status</td><td>string</td><td>success</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_31ik" id="loop-until-terminated">Loop Until Terminated<a aria-hidden="true" class="hash-link" href="#loop-until-terminated" title="Direct link to heading">â€‹</a></h3><ul><li>Name: <code>loop pipeline</code></li><li>Identifier: loop_pipeline</li><li>Type: Investigate</li><li>Description: Get pipeline details every 60 seconds for specified pipeline ID in Cado Response platform until it is terminated.</li></ul><p><strong>Action Parameters</strong></p><table><thead><tr><th>PARAMETER</th><th>REQUIRED</th><th>DESCRIPTION</th><th>TYPE</th><th>EXAMPLE VALUE</th></tr></thead><tbody><tr><td>pipeline_id</td><td>required</td><td>Pipeline identifier as listed in the output of &quot;get pipelines&quot; action</td><td>numeric</td><td>6</td></tr></tbody></table><p><strong>Action Output</strong></p><table><thead><tr><th>DATA PATH</th><th>TYPE</th><th>EXAMPLE VALUE</th></tr></thead><tbody><tr><td>action_result.data.<!-- -->*<!-- -->.<!-- -->*<!-- -->.pipeline_id</td><td>numeric</td><td>6</td></tr><tr><td>action_result.data.<!-- -->*<!-- -->.<!-- -->*<!-- -->.subtasks.<!-- -->*<!-- -->.name</td><td>string</td><td>Acquisition: Create a processing pipeline for each copied EC2 volume</td></tr><tr><td>action_result.data.<!-- -->*<!-- -->.<!-- -->*<!-- -->.subtasks.<!-- -->*<!-- -->.start_time</td><td>numeric</td><td>1633025565.147805</td></tr><tr><td>action_result.data.<!-- -->*<!-- -->.<!-- -->*<!-- -->.subtasks.<!-- -->*<!-- -->.finish_time</td><td>numeric</td><td>1633031638.334756</td></tr><tr><td>action_result.data.<!-- -->*<!-- -->.<!-- -->*<!-- -->.subtasks.<!-- -->*<!-- -->.execution_duration</td><td>numeric</td><td>6073</td></tr><tr><td>action_result.data.<!-- -->*<!-- -->.<!-- -->*<!-- -->.subtasks.<!-- -->*<!-- -->.state</td><td>string</td><td>SUCCESS</td></tr><tr><td>action_result.parameter.pipeline_id</td><td>numeric</td><td>6</td></tr><tr><td>action_result.status</td><td>string</td><td>success</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_31ik" id="create-project">Create Project<a aria-hidden="true" class="hash-link" href="#create-project" title="Direct link to heading">â€‹</a></h3><ul><li>Name: <code>create project</code></li><li>Identifier: create_project</li><li>Type: n/a</li><li>Description: Create a project in Cado Response platform.</li></ul><p><strong>Action Parameters</strong></p><table><thead><tr><th>PARAMETER</th><th>REQUIRED</th><th>DESCRIPTION</th><th>TYPE</th><th>EXAMPLE VALUE</th></tr></thead><tbody><tr><td>project_name</td><td>required</td><td>User provided Project name</td><td>string</td><td>My First Project</td></tr></tbody></table><p><strong>Action Output</strong></p><table><thead><tr><th>DATA PATH</th><th>TYPE</th><th>EXAMPLE VALUE</th></tr></thead><tbody><tr><td>action_result.status</td><td>string</td><td>success</td></tr><tr><td>action_result.data.*.id</td><td>numeric</td><td>1</td></tr><tr><td>action_result.parameter.project_name</td><td>string</td><td>My First Project</td></tr><tr><td>action_result.data.*.msg</td><td>string</td><td>Created</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_31ik" id="capture-ec2-instance">Capture EC2 instance<a aria-hidden="true" class="hash-link" href="#capture-ec2-instance" title="Direct link to heading">â€‹</a></h3><ul><li>Name: <code>capture instance</code></li><li>Identifier: capture_instance</li><li>Type: n/a</li><li>Description: Capture a specific EC2 instance for processing and analysis on the Cado Response platform.</li></ul><p><strong>Action Parameters</strong></p><table><thead><tr><th>PARAMETER</th><th>REQUIRED</th><th>DESCRIPTION</th><th>TYPE</th><th>EXAMPLE VALUE</th></tr></thead><tbody><tr><td>bucket</td><td>required</td><td>S3 bucket name as listed in the output of &quot;list bucket&quot; action</td><td>string</td><td>test-bucket</td></tr><tr><td>region</td><td>required</td><td>AWS instance region as listed in the output of &quot;list instances&quot; action</td><td>string</td><td>us-east-1</td></tr><tr><td>project_id</td><td>required</td><td>Project identifier as listed in the output of &quot;list projects&quot; action</td><td>numeric</td><td>1</td></tr><tr><td>instance_id</td><td>required</td><td>AWS instance ID as listed in the output of &quot;list instances&quot; action</td><td>string</td><td>i-1234567890abcdef0</td></tr></tbody></table><p><strong>Action Output</strong></p><table><thead><tr><th>DATA PATH</th><th>TYPE</th><th>EXAMPLE VALUE</th></tr></thead><tbody><tr><td>action_result.data.<!-- -->*<!-- -->.name</td><td>string</td><td>Acquiring i-1234567890abcdef0</td></tr><tr><td>action_result.parameter.project_id</td><td>numeric</td><td>1</td></tr><tr><td>action_result.parameter.region</td><td>string</td><td>us-east-1</td></tr><tr><td>action_result.parameter.instance_id</td><td>string</td><td>i-1234567890abcdef0</td></tr><tr><td>action_result.parameter.bucket</td><td>string</td><td>test-bucket</td></tr><tr><td>action_result.status</td><td>string</td><td>success</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_31ik" id="capture-s3-bucket">Capture S3 bucket<a aria-hidden="true" class="hash-link" href="#capture-s3-bucket" title="Direct link to heading">â€‹</a></h3><ul><li>Name: <code>capture bucket</code></li><li>Identifier: capture_bucket</li><li>Type: n/a</li><li>Description: Capture contents of a specific S3 bucket processing and analysis on the Cado Response platform.</li></ul><p><strong>Action Parameters</strong></p><table><thead><tr><th>PARAMETER</th><th>REQUIRED</th><th>DESCRIPTION</th><th>TYPE</th><th>EXAMPLE VALUE</th></tr></thead><tbody><tr><td>bucket</td><td>required</td><td>S3 bucket name as listed in the output of &quot;list bucket&quot; action</td><td>string</td><td>example-bucket</td></tr><tr><td>project_id</td><td>required</td><td>Project identifier as listed in the output of &quot;list projects&quot; action</td><td>numeric</td><td>1</td></tr></tbody></table><p><strong>Action Output</strong></p><table><thead><tr><th>DATA PATH</th><th>TYPE</th><th>EXAMPLE VALUE</th></tr></thead><tbody><tr><td>action_result.data.<!-- -->*<!-- -->.<!-- -->*<!-- -->.pipelines.pipeline_id</td><td>string</td><td>6</td></tr><tr><td>action_result.data.<!-- -->*<!-- -->.<!-- -->*<!-- -->.pipelines.project_id</td><td>string</td><td>1</td></tr><tr><td>action_result.data.<!-- -->*<!-- -->.<!-- -->*<!-- -->.pipelines.evidence_id</td><td>string</td><td>4</td></tr><tr><td>action_result.data.<!-- -->*<!-- -->.<!-- -->*<!-- -->.pipelines.pipeline_type</td><td>string</td><td>acquisition</td></tr><tr><td>action_result.status</td><td>string</td><td>success</td></tr><tr><td>action_result.parameter.bucket</td><td>string</td><td>test-bucket</td></tr><tr><td>action_result.parameter.project_id</td><td>numeric</td><td>1</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_31ik" id="playbooks">Playbooks<a aria-hidden="true" class="hash-link" href="#playbooks" title="Direct link to heading">â€‹</a></h2><p><em>If you have a good grasp of the basics of Splunk SOAR, feel free to skip this section.</em></p><p>To create a new playbook, navigate to Playbooks from the Splunk SOAR dashboard. Click the <strong>+ PLAYBOOK</strong> button in the top right.</p><p>Using the graphic playbook editor, you can drag and drop the required elements into place from the blue nodes, and configure them one by one as you place them, until you have a playbook ready.</p><p><img alt="Splunk SOAR Playbook" src="/assets/images/phantom-playbook-75c99069a3e66ac4d5d564309f5f7045.png"></p><p>Playbooks are made up of multiple blocks that carry out a workflow. There are 3 main types of blocks:</p><ul><li>Execute actions (these include the atomic actions detailed above)</li><li>Process filters</li><li>Human input</li></ul><p>The example below makes use of both execute actions and human input. Prompts pop up and asks the user for an input. This input can then be passed to the actions as action parameters and act accordingly.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="capture-ec2-instance-1">Capture EC2 Instance<a aria-hidden="true" class="hash-link" href="#capture-ec2-instance-1" title="Direct link to heading">â€‹</a></h3><p>This section covers a quick tutorial in creating a basic workflow (or playbook in Splunk SOAR terms) that:</p><ul><li>Creates a new Project</li><li>Triggers an EC2 Disk Acquisition</li><li>Loops over a pipeline until it has been terminated</li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="prompt-set-project-name">Prompt: Set Project Name<a aria-hidden="true" class="hash-link" href="#prompt-set-project-name" title="Direct link to heading">â€‹</a></h4><p>From the START block you can drag the blue node to add a new block. Select the Prompt option. Under the <strong>Advance Settings</strong> -&gt; <strong>General Settings</strong> you can set a custom name, i.e. <code>Set Project Name</code>. You can include a Message, so the user knows what to include.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="action-creating-the-project">Action: Creating the Project<a aria-hidden="true" class="hash-link" href="#action-creating-the-project" title="Direct link to heading">â€‹</a></h4><p>Drag the blue node from the prompt you just added to add an action. Select your configured Cado Response App to view the available actions you can carry out. You will want the <strong>create project</strong> action. Again here you can change the action name under <strong>Advanced Settings</strong>.</p><p>You can configure the action by clicking the Cado Response Asset and entering the output from the previous prompt into the <strong>project_name</strong> field. Do this by clicking on the field where a sidebar will pop up with a list of blocks currently used in the playbook. Select the prompt you just created, e.g. <code>Set_Project_Name</code>. This will open another sidebar with the data path outputs generated from the prompt. Select <code>summary.responses.0</code>. SAVE and the action will be created.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="action-list-s3-buckets">Action: List S3 Buckets<a aria-hidden="true" class="hash-link" href="#action-list-s3-buckets" title="Direct link to heading">â€‹</a></h4><p>From the last action add the <strong>list bucket</strong> action. Configure the project_id to be the ID output from the <strong>create project</strong> action, i.e. <code>create_project_1:action_result.data.*.id</code></p><h4 class="anchor anchorWithStickyNavbar_31ik" id="prompt-set-s3-bucket">Prompt: Set S3 Bucket<a aria-hidden="true" class="hash-link" href="#prompt-set-s3-bucket" title="Direct link to heading">â€‹</a></h4><p>Add a new prompt block from the previous action called <code>Set S3</code>. Click the <strong>ADD MESSAGE PARAMETERS</strong> button. This will add <strong>{0}</strong> to the message which acts as a placeholder for a message parameter. In the message parameter field select the list bucket action you just created followed by the bucket_name action results i.e. <code>list_bucket_1:action_result.data.*.*.bucket_name</code>.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="action-list-ec2-instances">Action: List EC2 Instances<a aria-hidden="true" class="hash-link" href="#action-list-ec2-instances" title="Direct link to heading">â€‹</a></h4><p>Add the list instances action next with the project_id field containing the ID output from the <strong>create project</strong> action, i.e. <code>create_project_1:action_result.data.*.id</code>.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="prompt-set-ec2-instance">Prompt: Set EC2 Instance<a aria-hidden="true" class="hash-link" href="#prompt-set-ec2-instance" title="Direct link to heading">â€‹</a></h4><p>Similar to the <strong>Set S3</strong> prompt, add a new prompt block with 2 message parameters. The first being the list instances region (<code>list_instances_1:action_result.data.*.*.region</code>) and the second being the list instances instance ID (<code>list_instances_1:action_result.data.*.*.id</code>).</p><p>In the responses part of the configuration for the action add the first to be <code>Region</code> and the second to be <code>Instance ID</code>.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="action-capture-ec2-instance">Action: Capture EC2 Instance<a aria-hidden="true" class="hash-link" href="#action-capture-ec2-instance" title="Direct link to heading">â€‹</a></h4><p>Next add the <strong>capture instance</strong> action, this will need 4 parameters configured. <strong>project_id</strong> will take the ID result from the create project action. Instance ID and region will take their respective responses from the previous prompt and bucket will take the response from the set S3 prompt.</p><ul><li>project_id: <code>create_project_1:action_result.data.*.id</code></li><li>instance_id: <code>Set_EC2:action_result.summary.responses.1</code></li><li>region: <code>Set_EC2:action_result.summary.responses.0</code></li><li>bucket: <code>Set_S3:action_result.summary.responses.0</code></li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="action-loop-pipeline-until-terminated">Action: Loop Pipeline until Terminated<a aria-hidden="true" class="hash-link" href="#action-loop-pipeline-until-terminated" title="Direct link to heading">â€‹</a></h4><p>Add the final action which will be the <strong>loop pipeline</strong> action. Fill in the <strong>pipeline_id</strong> field with the name result from the capture instance action: <code>capture_instance_1:action_result.data.*.name</code>.</p><p>Connect this final action block to the <strong>END</strong> block and the playbook is complete. Be sure to <strong>SAVE</strong> using the top right button, and then you can run your playbook.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/cado-security/product-help/tree/master/docs/cado-response/integrations/splunk-soar.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2021-11-29T15:34:50.000Z">11/29/2021</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/cado-response/integrations/tines"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« <!-- -->Tines</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/cado-response/sso/azure-ad"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Azure AD Integration (beta)<!-- --> Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#getting-started" class="table-of-contents__link toc-highlight">Getting Started</a><ul><li><a href="#create-an-api-access-key" class="table-of-contents__link toc-highlight">Create an API Access Key</a></li><li><a href="#install-and-configure-the-cado-response-app" class="table-of-contents__link toc-highlight">Install and Configure the Cado Response App</a></li><li><a href="#test-your-connection" class="table-of-contents__link toc-highlight">Test your connection</a></li></ul></li><li><a href="#atomic-actions" class="table-of-contents__link toc-highlight">Atomic Actions</a><ul><li><a href="#list-projects" class="table-of-contents__link toc-highlight">List Projects</a></li><li><a href="#list-ec2-instances" class="table-of-contents__link toc-highlight">List EC2 instances</a></li><li><a href="#list-s3-buckets" class="table-of-contents__link toc-highlight">List S3 buckets</a></li><li><a href="#list-pipelines" class="table-of-contents__link toc-highlight">List Pipelines</a></li><li><a href="#get-a-pipeline" class="table-of-contents__link toc-highlight">Get a pipeline</a></li><li><a href="#loop-until-terminated" class="table-of-contents__link toc-highlight">Loop Until Terminated</a></li><li><a href="#create-project" class="table-of-contents__link toc-highlight">Create Project</a></li><li><a href="#capture-ec2-instance" class="table-of-contents__link toc-highlight">Capture EC2 instance</a></li><li><a href="#capture-s3-bucket" class="table-of-contents__link toc-highlight">Capture S3 bucket</a></li></ul></li><li><a href="#playbooks" class="table-of-contents__link toc-highlight">Playbooks</a><ul><li><a href="#capture-ec2-instance-1" class="table-of-contents__link toc-highlight">Capture EC2 Instance</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/cadosecurity" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/cado-security" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 | Cado Security</div></div></div></footer></div>
<script src="/assets/js/runtime~main.2f4fd427.js"></script>
<script src="/assets/js/main.8b6e7a05.js"></script>
</body>
</html>