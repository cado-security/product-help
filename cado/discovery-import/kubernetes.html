<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-cado/discovery-import/kubernetes" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">Kubernetes | Cado Security</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.cadosecurity.com/cado/discovery-import/kubernetes"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="google-site-verification" content="j1fUKfw-LfBrYqXusMAoBbmCW8nSNobe8nOyfDl6xAY"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Kubernetes | Cado Security"><meta data-rh="true" name="description" content="How Does / Forensic Acquisition and Investigation Import Data from EKS, ECS, AKS, and GKE?"><meta data-rh="true" property="og:description" content="How Does / Forensic Acquisition and Investigation Import Data from EKS, ECS, AKS, and GKE?"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.cadosecurity.com/cado/discovery-import/kubernetes"><link data-rh="true" rel="alternate" href="https://docs.cadosecurity.com/cado/discovery-import/kubernetes" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.cadosecurity.com/cado/discovery-import/kubernetes" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9BVXSKWB6Z"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-9BVXSKWB6Z",{})</script><link rel="stylesheet" href="/assets/css/styles.33fc834b.css">
<script src="/assets/js/runtime~main.4327dfc9.js" defer="defer"></script>
<script src="/assets/js/main.377b97f7.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/cado.png" alt="Cado Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/cado-dark.png" alt="Cado Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"> </b></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/cado/intro">Darktrace / Forensic Acquisition and Investigation</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cado/intro">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado/deploy/aws/overview">Deployment</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/cado/discovery-import/overview">Import</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cado/discovery-import/overview">Import Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cado/discovery-import/intro">Import data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cado/discovery-import/import-from-cloud">Import from cloud</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cado/discovery-import/automation">Automating collection from detections</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado/discovery-import/aws/aws-ec2">AWS</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado/discovery-import/azure/azure-compute">Azure</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado/discovery-import/gcp/engine-instance">GCP</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado/discovery-import/cado-host/intro">Cado Host for on-premise</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cado/discovery-import/virtual-machine">Oracle Cloud Virtual Machines</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cado/discovery-import/xdr">XDR platforms</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cado/discovery-import/openshift">RedHat Openshift</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/cado/discovery-import/kubernetes">Kubernetes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cado/discovery-import/google-workspace-logs">Google Workspace logs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cado/discovery-import/m365-logs">Microsoft 365 and Entra ID</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cado/discovery-import/third-party">Third party disk images &amp; triage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cado/discovery-import/chain_of_custody">Chain of custody</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado/discovery-import/data-types/filetypes">Data types</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cado/discovery-import/investigations">Managing investigations</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado/integrations/overview">Integrations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado/investigate/over">Investigating</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado/manage/overview">Manage</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/troubleshooting/get-support">Help and support</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/release-notes">Release Notes</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Darktrace / Forensic Acquisition and Investigation</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Import</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Kubernetes</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>How to Import Data from Kubernetes</h1>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-does--forensic-acquisition-and-investigation-import-data-from-eks-ecs-aks-and-gke">How Does / Forensic Acquisition and Investigation Import Data from EKS, ECS, AKS, and GKE?<a href="#how-does--forensic-acquisition-and-investigation-import-data-from-eks-ecs-aks-and-gke" class="hash-link" aria-label="Direct link to How Does / Forensic Acquisition and Investigation Import Data from EKS, ECS, AKS, and GKE?" title="Direct link to How Does / Forensic Acquisition and Investigation Import Data from EKS, ECS, AKS, and GKE?">​</a></h2>
<p>When acquiring data from Kubernetes containers, / Forensic Acquisition and Investigation follows these steps by default:</p>
<ul>
<li>Executes a shell script to download the Host binary.</li>
<li>Runs the binary to collect forensic artifacts.</li>
<li>Uploads the collected files to cloud storage for processing.</li>
</ul>
<p>The method used to execute the script depends on the environment. For example, ECS uses ECS execute, while EKS, AKS, and GKE use the Kubernetes control plane API, as explained <a href="https://www.cadosecurity.com/how-we-sped-up-acquiring-forensic-data-from-aws-kubernetes-and-azure-kubernetes-services-by-10-times/" target="_blank" rel="noopener noreferrer">here</a>.</p>
<p>Authentication to the Kubernetes API may require IAM permissions, which are described in service-specific documentation.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="configuring-the-cluster-rbac-for-use-with--forensic-acquisition-and-investigation">Configuring the Cluster RBAC for Use with / Forensic Acquisition and Investigation<a href="#configuring-the-cluster-rbac-for-use-with--forensic-acquisition-and-investigation" class="hash-link" aria-label="Direct link to Configuring the Cluster RBAC for Use with / Forensic Acquisition and Investigation" title="Direct link to Configuring the Cluster RBAC for Use with / Forensic Acquisition and Investigation">​</a></h2>
<p>To acquire artifacts from a container, the following Kubernetes permissions must be enabled for each cluster:</p>
<ul>
<li><code>pods</code> - <code>get</code>, <code>list</code></li>
<li><code>pods/exec</code> - <code>create</code>, <code>get</code></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rbac-clusterrole-and-clusterrolebinding">RBAC ClusterRole and ClusterRoleBinding<a href="#rbac-clusterrole-and-clusterrolebinding" class="hash-link" aria-label="Direct link to RBAC ClusterRole and ClusterRoleBinding" title="Direct link to RBAC ClusterRole and ClusterRoleBinding">​</a></h3>
<p>We recommend adding the following ClusterRole and ClusterRoleBinding to your cluster’s RBAC configuration with the permissions listed above.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> rbac.authorization.k8s.io/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ClusterRole</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> cado</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">eks</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">cluster</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">role</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">rules</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">apiGroups</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">resources</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;pods&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">verbs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;get&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;list&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">apiGroups</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">resources</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;pods/exec&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">verbs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;create&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;get&quot;</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> rbac.authorization.k8s.io/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ClusterRoleBinding</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> cado</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">eks</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">cluster</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">role</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">binding</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">subjects</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Group</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> cado</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">apiGroup</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> rbac.authorization.k8s.io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">roleRef</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ClusterRole</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> cado</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">eks</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">cluster</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">role</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">apiGroup</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> rbac.authorization.k8s.io</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="alternate-collection-by-acquiring-the-volume-of-the-node">Alternate Collection by Acquiring the Volume of the Node<a href="#alternate-collection-by-acquiring-the-volume-of-the-node" class="hash-link" aria-label="Direct link to Alternate Collection by Acquiring the Volume of the Node" title="Direct link to Alternate Collection by Acquiring the Volume of the Node">​</a></h2>
<p>If executing code inside the container or connecting over the network is not possible, you can acquire the volume of the node running the container. For example, this approach works for EKS running on EC2 nodes.</p>
<ul>
<li>If using the Docker container runtime, container file systems are usually available at <code>/var/lib/docker/overlay2</code>.</li>
<li>If using the Containerd runtime (which is now the default for EKS), the container file system is not immediately visible. / Forensic Acquisition and Investigation is working on supporting containerd-based volume acquisitions.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="alternate-collection-by-using-host-with-a-sidecar-container">Alternate Collection by Using Host with a Sidecar Container<a href="#alternate-collection-by-using-host-with-a-sidecar-container" class="hash-link" aria-label="Direct link to Alternate Collection by Using Host with a Sidecar Container" title="Direct link to Alternate Collection by Using Host with a Sidecar Container">​</a></h2>
<p>/ Forensic Acquisition and Investigation supports collecting from private clusters and distroless containers by using a <a href="https://kubernetes.io/docs/reference/kubectl/generated/kubectl_debug/" target="_blank" rel="noopener noreferrer">debug container</a>.</p>
<p>To acquire data:</p>
<ul>
<li>Navigate to <strong>Import &gt; / Forensic Acquisition and Investigation Host</strong>.</li>
<li>Select <strong>Kubernetes</strong> and follow the prompts.</li>
</ul>
<p><img loading="lazy" alt="Cado Host K8s UI" src="/assets/images/cado-host-k8s-9104fa210ad3e4b85816262656d9ace6.png" width="479" height="569" class="img_ev3q"></p>
<p>This will use a command such as the following to start a debug container and execute / Forensic Acquisition and Investigation Host:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl debug -it pod-name --image=debian:latest --target=target-container -n pod-namespace -- sh -c</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The diagram below provides a high-level overview of how this works:</p>
<p><img loading="lazy" alt="Cado Host K8s Flow" src="/assets/images/kubernetes-flow-5c256c91fb8e5356f9e86195d367fa54.png" width="2200" height="1212" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-a-custom-image">Using a Custom Image<a href="#using-a-custom-image" class="hash-link" aria-label="Direct link to Using a Custom Image" title="Direct link to Using a Custom Image">​</a></h3>
<p>In environments where the default <code>debian:latest</code> image is not supported, you can use a custom image. The custom image must have the latest / Forensic Acquisition and Investigation Host Linux binary located at <code>/tmp/cado-host-static/cado-host</code>. However, / Forensic Acquisition and Investigation recommends using the default <code>debian:latest</code> image for supportability.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="root-access">Root Access<a href="#root-access" class="hash-link" aria-label="Direct link to Root Access" title="Direct link to Root Access">​</a></h3>
<p>By default, / Forensic Acquisition and Investigation Host requires root access to access the underlying container file system (usually under <code>/proc/{PID}/root</code>). The <code>runuser</code> command with the root user is also required to give the / Forensic Acquisition and Investigation Host process the appropriate UID and GID.</p>
<p>For Kubernetes v1.30 or later, you can optionally use the &quot;Run as non-root user&quot; option, which leverages the <a href="https://kubernetes.io/docs/tasks/debug/debug-application/debug-running-pod/" target="_blank" rel="noopener noreferrer">sysadmin</a> profile to access the container file system.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="private-clusters-with-no-network-access">Private Clusters with No Network Access<a href="#private-clusters-with-no-network-access" class="hash-link" aria-label="Direct link to Private Clusters with No Network Access" title="Direct link to Private Clusters with No Network Access">​</a></h2>
<p>/ Forensic Acquisition and Investigation requires access to the Kubernetes control plane API to acquire containers via the user interface. If network access to the Kubernetes API is not available, alternate options for acquiring data are needed.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="private-aks-clusters">Private AKS Clusters<a href="#private-aks-clusters" class="hash-link" aria-label="Direct link to Private AKS Clusters" title="Direct link to Private AKS Clusters">​</a></h3>
<p>/ Forensic Acquisition and Investigation can acquire private AKS clusters using the normal user interface, thanks to Azure&#x27;s &quot;command invoke&quot; feature for private clusters.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="private-gke-clusters">Private GKE Clusters<a href="#private-gke-clusters" class="hash-link" aria-label="Direct link to Private GKE Clusters" title="Direct link to Private GKE Clusters">​</a></h3>
<p>Please use the <strong>Alternate Private EKS Cluster Access</strong> method described above.</p>
<p>/ Forensic Acquisition and Investigation is exploring support for private GKE clusters through public endpoints on private clusters via the &quot;normal&quot; method.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="private-eks-clusters">Private EKS Clusters<a href="#private-eks-clusters" class="hash-link" aria-label="Direct link to Private EKS Clusters" title="Direct link to Private EKS Clusters">​</a></h3>
<p>Private EKS clusters can be configured to be accessible only from within the VPC they reside in or connected networks (e.g., peered VPCs). If the cluster is configured with &quot;Private endpoint only,&quot; you will need to use a method like VPC peering or another connection option to access the API.</p>
<p>If / Forensic Acquisition and Investigation cannot access the cluster endpoint, you can use the <strong>Alternate Private EKS Cluster Access</strong> method described above.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="alternate-private-eks-cluster-access">Alternate Private EKS Cluster Access<a href="#alternate-private-eks-cluster-access" class="hash-link" aria-label="Direct link to Alternate Private EKS Cluster Access" title="Direct link to Alternate Private EKS Cluster Access">​</a></h4>
<p>If the / Forensic Acquisition and Investigation platform does not have access to the cluster endpoint, you can acquire data by deploying the Host acquisition script.</p>
<p>To do this, connect to your EKS cluster using a command like:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">aws eks update-kubeconfig --region $Region --name $ClusterName</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Follow AWS’s instructions <a href="https://docs.aws.amazon.com/eks/latest/userguide/install-kubectl.html" target="_blank" rel="noopener noreferrer">here</a>.</p>
<p>Then execute the <code>kubectl</code> script generated at <strong>Import &gt; / Forensic Acquisition and Investigation Host &gt; Kubernetes</strong>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="methods-for-executing-kubernetes-api-commands-inside-a-private-cluster-vpc">Methods for Executing Kubernetes API Commands Inside a Private Cluster VPC<a href="#methods-for-executing-kubernetes-api-commands-inside-a-private-cluster-vpc" class="hash-link" aria-label="Direct link to Methods for Executing Kubernetes API Commands Inside a Private Cluster VPC" title="Direct link to Methods for Executing Kubernetes API Commands Inside a Private Cluster VPC">​</a></h3>
<p>Various methods can be used to access the Kubernetes API in a private VPC, including:</p>
<ul>
<li><strong>Bastion Hosts</strong></li>
<li><strong>SSM</strong> (AWS Systems Manager)</li>
<li><strong>AWS PrivateLink</strong></li>
<li><strong>AWS Cloud9</strong></li>
<li><strong>VPN/Direct Connect</strong></li>
</ul>
<p>For details on these methods, refer to the following resources:</p>
<ul>
<li>
<p><strong>Bastion Hosts</strong>:</p>
<ul>
<li><a href="https://cloudtipss.com/Create-Private-EKS-With-Bastion/" target="_blank" rel="noopener noreferrer">How to connect using a Bastion Host</a></li>
<li><a href="https://medium.com/@muppedaanvesh/jump-box-setup-on-eks-cluster-383ca92f51ef" target="_blank" rel="noopener noreferrer">Terraform setup for a Bastion Host</a></li>
</ul>
</li>
<li>
<p><strong>SSM</strong>:</p>
<ul>
<li><a href="https://awstip.com/securely-connect-to-a-private-eks-cluster-using-aws-ssm-session-forwarding-systems-manager-5d0767edea61" target="_blank" rel="noopener noreferrer">Securely connect to a private EKS cluster using AWS SSM</a></li>
</ul>
</li>
<li>
<p><strong>VPN/Direct Connect</strong>:</p>
<ul>
<li><a href="https://docs.aws.amazon.com/whitepapers/latest/aws-vpc-connectivity-options/aws-direct-connect.html" target="_blank" rel="noopener noreferrer">AWS VPC Connectivity Options</a></li>
<li><a href="https://hodovi.cc/blog/private-eks-api-endpoint-behind-openvpn/" target="_blank" rel="noopener noreferrer">OpenVPN setup for private EKS API endpoint</a></li>
</ul>
</li>
<li>
<p><strong>PrivateLink</strong>:</p>
<ul>
<li><a href="https://docs.zeet.co/guides/advanced/eks-privatelink/" target="_blank" rel="noopener noreferrer">Using PrivateLink with EKS</a></li>
<li><a href="https://docs.aws.amazon.com/eks/latest/userguide/vpc-interface-endpoints.html" target="_blank" rel="noopener noreferrer">EKS VPC Interface Endpoints</a></li>
</ul>
</li>
<li>
<p><strong>Cloud9</strong>:</p>
<ul>
<li><a href="https://stackoverflow.com/questions/65049271/how-to-connect-to-eks-cluster-from-cloud-9-instance-using-kubectl" target="_blank" rel="noopener noreferrer">Connecting to an EKS Cluster from Cloud9</a></li>
</ul>
</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/cado-security/product-help/tree/master/docs/cado/discovery-import/kubernetes.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-10-29T15:27:48.000Z">Oct 29, 2025</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/cado/discovery-import/openshift"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">RedHat Openshift</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/cado/discovery-import/google-workspace-logs"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Google Workspace logs</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#how-does--forensic-acquisition-and-investigation-import-data-from-eks-ecs-aks-and-gke" class="table-of-contents__link toc-highlight">How Does / Forensic Acquisition and Investigation Import Data from EKS, ECS, AKS, and GKE?</a></li><li><a href="#configuring-the-cluster-rbac-for-use-with--forensic-acquisition-and-investigation" class="table-of-contents__link toc-highlight">Configuring the Cluster RBAC for Use with / Forensic Acquisition and Investigation</a><ul><li><a href="#rbac-clusterrole-and-clusterrolebinding" class="table-of-contents__link toc-highlight">RBAC ClusterRole and ClusterRoleBinding</a></li></ul></li><li><a href="#alternate-collection-by-acquiring-the-volume-of-the-node" class="table-of-contents__link toc-highlight">Alternate Collection by Acquiring the Volume of the Node</a></li><li><a href="#alternate-collection-by-using-host-with-a-sidecar-container" class="table-of-contents__link toc-highlight">Alternate Collection by Using Host with a Sidecar Container</a><ul><li><a href="#using-a-custom-image" class="table-of-contents__link toc-highlight">Using a Custom Image</a></li><li><a href="#root-access" class="table-of-contents__link toc-highlight">Root Access</a></li></ul></li><li><a href="#private-clusters-with-no-network-access" class="table-of-contents__link toc-highlight">Private Clusters with No Network Access</a><ul><li><a href="#private-aks-clusters" class="table-of-contents__link toc-highlight">Private AKS Clusters</a></li><li><a href="#private-gke-clusters" class="table-of-contents__link toc-highlight">Private GKE Clusters</a></li><li><a href="#private-eks-clusters" class="table-of-contents__link toc-highlight">Private EKS Clusters</a></li><li><a href="#methods-for-executing-kubernetes-api-commands-inside-a-private-cluster-vpc" class="table-of-contents__link toc-highlight">Methods for Executing Kubernetes API Commands Inside a Private Cluster VPC</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/cadosecurity" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/cado-security" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 | Cado Security</div></div></div></footer></div>
</body>
</html>