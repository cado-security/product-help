<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-cado/discovery-import/aws/run-command" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">AWS EC2 Run Command | Cado Security</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.cadosecurity.com/cado/discovery-import/aws/run-command"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="google-site-verification" content="j1fUKfw-LfBrYqXusMAoBbmCW8nSNobe8nOyfDl6xAY"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="AWS EC2 Run Command | Cado Security"><meta data-rh="true" name="description" content="Cado allows you to execute scripts on target systems using the Run Command feature in the import wizard."><meta data-rh="true" property="og:description" content="Cado allows you to execute scripts on target systems using the Run Command feature in the import wizard."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.cadosecurity.com/cado/discovery-import/aws/run-command"><link data-rh="true" rel="alternate" href="https://docs.cadosecurity.com/cado/discovery-import/aws/run-command" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.cadosecurity.com/cado/discovery-import/aws/run-command" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9BVXSKWB6Z"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-9BVXSKWB6Z",{})</script><link rel="stylesheet" href="/assets/css/styles.33fc834b.css">
<script src="/assets/js/runtime~main.418b6325.js" defer="defer"></script>
<script src="/assets/js/main.2b7f2887.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/cado.png" alt="Cado Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/cado-dark.png" alt="Cado Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"> </b></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/cado/intro">Darktrace / Forensic Acquisition and Investigation</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cado/intro">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado/deploy/aws/overview">Deployment</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/cado/discovery-import/overview">Import</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cado/discovery-import/overview">Import Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cado/discovery-import/intro">Import data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cado/discovery-import/import-from-cloud">Import from cloud</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cado/discovery-import/automation">Automating collection from detections</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/cado/discovery-import/aws/aws-ec2">AWS</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/cado/discovery-import/aws/aws-ec2">EC2 and EBS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/cado/discovery-import/aws/aws-ami">AMI, EBS Snapshot and Volume</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/cado/discovery-import/aws/aws-s3">S3</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/cado/discovery-import/aws/aws-ecs">ECS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/cado/discovery-import/aws/aws-eks">EKS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/cado/discovery-import/aws/aws-lambda">Lambda</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/cado/discovery-import/aws/memory">EC2 Triage Analysis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/cado/discovery-import/aws/aws-lightsail">Lightsail</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/cado/discovery-import/aws/aws-china">AWS China</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/cado/discovery-import/aws/large-aws-imports">Import large EC2 instances</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/cado/discovery-import/aws/ebs-create-volume">EBS Create Volume Acquisition</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/cado/discovery-import/aws/ebs-direct-acquisition">EBS Direct Acquisition</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/cado/discovery-import/aws/run-command">AWS EC2 Run Command</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado/discovery-import/azure/azure-compute">Azure</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado/discovery-import/gcp/engine-instance">GCP</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado/discovery-import/cado-host/intro">Cado Host for on-premise</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cado/discovery-import/virtual-machine">Oracle Cloud Virtual Machines</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cado/discovery-import/xdr">XDR platforms</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cado/discovery-import/openshift">RedHat Openshift</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cado/discovery-import/kubernetes">Kubernetes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cado/discovery-import/google-workspace-logs">Google Workspace logs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cado/discovery-import/m365-logs">Microsoft 365 and Entra ID</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cado/discovery-import/third-party">Third party disk images &amp; triage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cado/discovery-import/chain_of_custody">Chain of custody</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado/discovery-import/data-types/filetypes">Data types</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cado/discovery-import/investigations">Managing investigations</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado/integrations/overview">Integrations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado/investigate/over">Investigating</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado/manage/overview">Manage</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/troubleshooting/get-support">Help and support</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/release-notes">Release Notes</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Darktrace / Forensic Acquisition and Investigation</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Import</span><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">AWS</span><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">AWS EC2 Run Command</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>AWS EC2 Run Command</h1>
<p>Cado allows you to execute scripts on target systems using the <strong>Run Command</strong> feature in the import wizard.</p>
<p>This requires the <a href="https://docs.aws.amazon.com/systems-manager/latest/userguide/systems-manager-setting-up-ec2.html" target="_blank" rel="noopener noreferrer">AWS Systems Manager Agent (SSM)</a> to be installed on the instance and admin privileges within Cado.
To support transferring of files over the SSM port forwarding, we require Python 3.8+ to be installed on the instance.</p>
<p>To use this feature, you must create a script at Settings &gt; Scripts.</p>
<p>For more information on the AWS IAM permissions for SSM required, please see <a href="/cado/deploy/aws/iam/ssm">here</a>.</p>
<p><em>Note: This feature is in Beta. To enable it, go to Settings &gt; Experiments &gt; Run Action.</em></p>
<p><img loading="lazy" alt="AWS EC2 Run Command" src="/assets/images/aws-ec2-runcommand1-6a682e02432fcd47b25e0df8167cf22a.png" width="1487" height="702" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="creating-a-saved-script">Creating a Saved Script<a href="#creating-a-saved-script" class="hash-link" aria-label="Direct link to Creating a Saved Script" title="Direct link to Creating a Saved Script">​</a></h2>
<ol>
<li>Go to <strong>/settings/scripts</strong> and click <strong>Create Script</strong>.</li>
<li>Choose whether the script will run on Linux or Windows (reduced functionality for Windows). For this example, we’ll choose Linux.</li>
</ol>
<p><img loading="lazy" alt="Saved Script" src="/assets/images/aws-ec2-runcommand2-b11e4dc54efaca6f07ebc1e92cb869ff.png" width="3260" height="858" class="img_ev3q"></p>
<ol start="3">
<li>In Step 1, provide a <strong>Name</strong> and <strong>Description</strong> for the script.</li>
</ol>
<p><img loading="lazy" alt="Saved Script - Step 1" src="/assets/images/aws-ec2-runcommand3-0e82deea582dd231aac3dce8b07a8311.png" width="3804" height="1082" class="img_ev3q"></p>
<ol start="4">
<li>In Step 2, provide the location of the input file (valid S3 URI), which will be downloaded onto the target system. This step is not available for Windows scripts.</li>
</ol>
<p><img loading="lazy" alt="Saved Script - Step 2" src="/assets/images/aws-ec2-runcommand4-35fa40b42dafc5e3ae7f4d6edaf8e9ff.png" width="3768" height="952" class="img_ev3q"></p>
<ol start="5">
<li>In Step 3, specify the location of the output file on the target system that will be uploaded to your Cado S3 bucket. This step is not available for Windows scripts.</li>
</ol>
<p><img loading="lazy" alt="Saved Script - Step 3" src="/assets/images/aws-ec2-runcommand5-8309b0a6ecfa58beffcf97bc2c28a2c8.png" width="3782" height="950" class="img_ev3q"></p>
<ol start="6">
<li>In Step 4, paste the script that will run on the target system. The input and output files can be referenced as <code>${INPUT}</code> and <code>${OUTPUT}</code> respectively. Windows scripts do not require these variables.</li>
</ol>
<p>Example script for Volexity Surge Collect:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir -p /tmp/cado-volexity</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cp ${INPUT} /tmp/cado-volexity/surge-collect</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chmod 755 /tmp/cado-volexity/surge-collect</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir -p /tmp/cado-volexity/out</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/tmp/cado-volexity/surge-collect $password --format=zip --pagefiles temp_out</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">find temp_out -type f -name &#x27;*.zip&#x27; -exec mv {} ${OUTPUT} \;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(sleep 30; rm -rf /tmp/cado-volexity) &amp;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" alt="Saved Script - Step 4" src="/assets/images/aws-ec2-runcommand6-6299ae48dc8f4a167c4fafc3fcae2283.png" width="1571" height="591" class="img_ev3q"></p>
<ol start="7">
<li>Click <strong>Continue</strong> and you’ll see your script listed in the scripts table.</li>
</ol>
<p><img loading="lazy" alt="Saved Script - Table" src="/assets/images/aws-ec2-runcommand7-3fe3e4fe0b44a67e3d0db7cb22f6c481.png" width="3856" height="704" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="running-the-script">Running the Script<a href="#running-the-script" class="hash-link" aria-label="Direct link to Running the Script" title="Direct link to Running the Script">​</a></h2>
<p>Use the Import Wizard to select an EC2 instance with the SSM agent installed. Choose <strong>Run Command</strong> as the action type, and you’ll see the script created earlier. Complete the import as usual.</p>
<p><img loading="lazy" alt="AWS EC2 Run Command - Selecting Saved Script" src="/assets/images/aws-ec2-runcommand8-59785809f6dbe0694417240d98e31f84.png" width="2557" height="766" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-does-the-run-command-feature-work">How does the Run Command feature work?<a href="#how-does-the-run-command-feature-work" class="hash-link" aria-label="Direct link to How does the Run Command feature work?" title="Direct link to How does the Run Command feature work?">​</a></h2>
<p>When you execute a saved script via Run Command, Cado leverages AWS Systems Manager (SSM) to remotely execute your script on the target EC2.</p>
<ol>
<li>
<p><strong>Preparation and Validation</strong></p>
<ul>
<li><strong>Platform Verification:</strong> The process begins by verifying that the target instance is a Linux system.</li>
<li><strong>Script Selection:</strong> The command will either use a pre-saved script you have created from your Cado settings, or the script used to import through Cado Host.</li>
<li><strong>Port Selection:</strong> A specific port (by default, the SSM port 9999) is used to establish the port forwarding session between your local worker and the target instance.</li>
</ul>
</li>
<li>
<p><strong>Input File Handling</strong></p>
<ul>
<li><strong>Downloading the Input File:</strong> If your script requires an input file (specified as an S3 URI or a designated Cado host URL), the file is first downloaded to a temporary location on the main Cado instance.</li>
<li><strong>Transferring to the Instance:</strong> Once the input file is available locally, it is transferred securely to the target EC2 instance over the SSM port forwarding session.</li>
</ul>
</li>
<li>
<p><strong>Command Execution on the EC2 Instance</strong></p>
<ul>
<li><strong>File Path Substitution:</strong> The command is automatically updated so that the placeholders for the input and output files (<code>${INPUT}</code> and <code>${OUTPUT}</code>) point to the temporary file locations on the target instance - as per the examples above.</li>
<li><strong>Remote Execution:</strong> The command is then executed on the target instance via SSM. During execution, the script reads the transferred input file and writes its results to an output file on the instance.</li>
</ul>
</li>
<li>
<p><strong>Retrieving the Output File</strong></p>
<ul>
<li><strong>Downloading the Output File:</strong> After the command has executed successfully, the system retrieves the output file from the instance using the same SSM port forwarding mechanism.</li>
<li><strong>Uploading to S3:</strong> Once the output file is securely transferred back to the controlling system, it is automatically uploaded to your designated Cado S3 bucket.</li>
</ul>
</li>
<li>
<p><strong>Cleanup</strong></p>
<ul>
<li><strong>Instance Cleanup:</strong> To maintain a clean environment, temporary files on the target instance (such as the transferred output file) are removed after the successful upload to S3. Any process running on the port forwarding session is also terminated, determined by the port number used.</li>
</ul>
</li>
</ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/cado-security/product-help/tree/master/docs/cado/discovery-import/aws/run-command.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-10-24T13:40:45.000Z">Oct 24, 2025</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/cado/discovery-import/aws/ebs-direct-acquisition"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">EBS Direct Acquisition</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/cado/discovery-import/azure/azure-compute"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Azure Compute</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#creating-a-saved-script" class="table-of-contents__link toc-highlight">Creating a Saved Script</a></li><li><a href="#running-the-script" class="table-of-contents__link toc-highlight">Running the Script</a></li><li><a href="#how-does-the-run-command-feature-work" class="table-of-contents__link toc-highlight">How does the Run Command feature work?</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/cadosecurity" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/cado-security" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 | Cado Security</div></div></div></footer></div>
</body>
</html>