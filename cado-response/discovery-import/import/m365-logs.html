<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-cado-response/discovery-import/import/m365-logs" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">Microsoft SaaS Logs | Cado Security</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.cadosecurity.com/cado-response/discovery-import/import/m365-logs"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="google-site-verification" content="j1fUKfw-LfBrYqXusMAoBbmCW8nSNobe8nOyfDl6xAY"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Microsoft SaaS Logs | Cado Security"><meta data-rh="true" name="description" content="Introduction"><meta data-rh="true" property="og:description" content="Introduction"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.cadosecurity.com/cado-response/discovery-import/import/m365-logs"><link data-rh="true" rel="alternate" href="https://docs.cadosecurity.com/cado-response/discovery-import/import/m365-logs" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.cadosecurity.com/cado-response/discovery-import/import/m365-logs" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9BVXSKWB6Z"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-9BVXSKWB6Z",{})</script><link rel="stylesheet" href="/assets/css/styles.41c6a14a.css">
<script src="/assets/js/runtime~main.460540d4.js" defer="defer"></script>
<script src="/assets/js/main.92e02904.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/cado.png" alt="Cado Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/cado-dark.png" alt="Cado Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"> </b></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/cado-response/intro">Cado Platform</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/intro">Summary</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/key-concepts">Key Concepts</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado-response/deploy/intro">Deployment</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/cado-response/discovery-import/intro">Import</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/intro">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/projects">Managing Projects</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/automation">Automation Rules (Beta)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/readiness">Readiness (Beta)</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/cado-response/discovery-import/import/intro">Importing Data</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/import/intro">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/import/import-from-cloud">Import from Cloud</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado-response/discovery-import/import/data-types/filetypes">Data Types</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado-response/discovery-import/import/aws/aws-ec2">AWS</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado-response/discovery-import/import/azure/azure-compute">Azure</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado-response/discovery-import/import/gcp/engine-instance">GCP</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado-response/discovery-import/import/oracle/virtual-machine">Oracle</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/import/openshift">OpenShift</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/import/xdr">XDR Integrations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/cado-response/discovery-import/import/m365-logs">Microsoft SaaS Logs</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado-response/export/intro">Export</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado-response/investigate/intro">Investigating</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado-response/manage/logging-in">Manage</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado-response/community-edition/community-intro">Community Edition</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cado-host/intro">Cado Host</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/troubleshooting/faq">Troubleshooting</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/eula/commercial-eula">License Agreements</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/support-bulletins/role-update">Support Bulletins</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/release-notes">Release Notes</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Cado Platform</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Import</span><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Importing Data</span><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Microsoft SaaS Logs</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Microsoft 365 and Entra ID Logs</h1>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h3>
<p>The Cado platform supports acquisition and processing of the following Microsoft 365 and Entra ID logs:</p>
<ul>
<li>Microsoft 365 Unified Audit Log (UAL)</li>
<li>Entra ID Audit logs</li>
<li>Entra ID Sign-in logs</li>
</ul>
<p>Note: the feature is currently in Beta, so the ‘SaaS Imports’ feature needs to be enabled in the /settings/experiments page.</p>
<p>Before these logs can be acquired using the Cado platform, a Microsoft Entra application and service principal needs to be set-up and configured in the Azure portal, which is explained in the following section. For more information, please refer to <a href="https://learn.microsoft.com/en-us/entra/identity-platform/howto-create-service-principal-portal" target="_blank" rel="noopener noreferrer">Microsoft documentation</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="service-principal-set-up">Service Principal Set-up<a href="#service-principal-set-up" class="hash-link" aria-label="Direct link to Service Principal Set-up" title="Direct link to Service Principal Set-up">​</a></h3>
<p>To support the acquisition of Microsoft 365 and Entra ID logs, a service principal needs to be set-up/configured. Instructions can be found here: <a href="https://learn.microsoft.com/en-us/entra/identity-platform/howto-create-service-principal-portal#set-up-authentication" target="_blank" rel="noopener noreferrer">Create a Microsoft Entra application and service principal that can access resources</a>.</p>
<p>For each section linked below please follow the Microsoft instructions. We have added additional configuration information for each section to help with the setup.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="register-an-application-with-microsoft-entra-id-and-create-a-service-principal"><a href="https://learn.microsoft.com/en-us/entra/identity-platform/howto-create-service-principal-portal#register-an-application-with-microsoft-entra-id-and-create-a-service-principal" target="_blank" rel="noopener noreferrer">Register an application with Microsoft Entra ID and create a service principal</a><a href="#register-an-application-with-microsoft-entra-id-and-create-a-service-principal" class="hash-link" aria-label="Direct link to register-an-application-with-microsoft-entra-id-and-create-a-service-principal" title="Direct link to register-an-application-with-microsoft-entra-id-and-create-a-service-principal">​</a></h4>
<ul>
<li>In our testing, we did not use a redirect URL while setting up the service principal. This is optional.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="entra-id-roles-and-administrators">Entra ID Roles and administrators<a href="#entra-id-roles-and-administrators" class="hash-link" aria-label="Direct link to Entra ID Roles and administrators" title="Direct link to Entra ID Roles and administrators">​</a></h4>
<p>These steps are required to pull logs from Exchange:</p>
<ol>
<li>Open Entra ID.</li>
<li>Click on the Roles and administrators</li>
</ol>
<p><img loading="lazy" alt="Roles and administrators" src="/assets/images/Entra-Roles-d5b08a7de5b8e3667b75fdf9172218ae.png" width="257" height="427" class="img_ev3q"></p>
<ol start="3">
<li>In the search bar, type Exchange admin. Now click on the “Exchange administrator” role.</li>
</ol>
<p><img loading="lazy" alt="Roles and administrators - Exchange Admin" src="/assets/images/Entra-Roles-Exchange-7062c04a4b32d72e18c2be6caa599900.png" width="1213" height="539" class="img_ev3q"></p>
<ol start="4">
<li>Choose the Add Assignments button.</li>
<li>In the window that appears, type in the name of the app registration that is assigned to the Exchange connector.  When there are multiple connectors, add the name of each app registration that is assigned to each Exchange connector.</li>
</ol>
<p><img loading="lazy" alt="Roles and administrators - Exchange Admin - Assignments" src="/assets/images/Entra-Roles-Exchange-Assignments-68efa616372baab716ec77428aac0f8a.png" width="753" height="321" class="img_ev3q"></p>
<ol start="6">
<li>Save the change.</li>
<li>Allow this to take effect and try the connector again within a few minutes.</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="assign-a-role-to-the-application"><a href="https://learn.microsoft.com/en-us/entra/identity-platform/howto-create-service-principal-portal#assign-a-role-to-the-application" target="_blank" rel="noopener noreferrer">Assign a role to the application</a><a href="#assign-a-role-to-the-application" class="hash-link" aria-label="Direct link to assign-a-role-to-the-application" title="Direct link to assign-a-role-to-the-application">​</a></h4>
<ul>
<li>In our testing, we assigned the application to one of our subscriptions</li>
<li>We applied the “Security Reader” role assignment to our application.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="sign-in-to-the-application"><a href="https://learn.microsoft.com/en-us/entra/identity-platform/howto-create-service-principal-portal#sign-in-to-the-application" target="_blank" rel="noopener noreferrer">Sign in to the application</a><a href="#sign-in-to-the-application" class="hash-link" aria-label="Direct link to sign-in-to-the-application" title="Direct link to sign-in-to-the-application">​</a></h4>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="set-up-authentication"><a href="https://learn.microsoft.com/en-us/entra/identity-platform/howto-create-service-principal-portal#option-3-create-a-new-client-secret" target="_blank" rel="noopener noreferrer">Set up Authentication</a><a href="#set-up-authentication" class="hash-link" aria-label="Direct link to set-up-authentication" title="Direct link to set-up-authentication">​</a></h4>
<ul>
<li>In our testing, we used option 3 “Create a new client secret”</li>
<li>We did not use “key vault”. We stored our secret keys securely elsewhere.</li>
<li>Please note: If any changes are made to the service principal a new set of secrets need to be created/used</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="grant-tenant-wide-admin-consent-to-an-application"><a href="https://learn.microsoft.com/en-us/entra/identity/enterprise-apps/grant-admin-consent?pivots=portal" target="_blank" rel="noopener noreferrer">Grant tenant-wide admin consent to an application</a><a href="#grant-tenant-wide-admin-consent-to-an-application" class="hash-link" aria-label="Direct link to grant-tenant-wide-admin-consent-to-an-application" title="Direct link to grant-tenant-wide-admin-consent-to-an-application">​</a></h4>
<ol>
<li>Navigate to to the <a href="https://entra.microsoft.com/#home" target="_blank" rel="noopener noreferrer">Microsoft Entra admin centre</a></li>
<li>In the left hand panel select “Applications” then “App registrations”</li>
<li>Under “All applications” search for your newly created application (Service principal) and click on it.</li>
<li>Click “API permissions” from the sidebar, then click “Add a permission”</li>
<li>On the pop up screen under “Microsoft APIs” select “Microsoft Graph”, then select “Application permissions”. Select and add the Audit log permission “AuditLog.Read.All”.</li>
</ol>
<p><img loading="lazy" alt="Request API Permissions - MS Graph" src="/assets/images/Entra-API-Permissions1-b690ff91c116bb18d10b9cc8e1f2cc7e.png" width="844" height="475" class="img_ev3q"></p>
<ol start="6">
<li>To add permissions for Office 365  Click “Add a permission”
under “Microsoft APIs”, select “Office 365 Management APIs”, then select “Application permissions”. Select and add the ”ActivityFeed.Read” permission.</li>
</ol>
<p><img loading="lazy" alt="Request API Permissions - Office 365" src="/assets/images/Entra-API-Permissions2-4ab86de8aa085cc452da2833c5a7e88a.png" width="841" height="524" class="img_ev3q"></p>
<ol start="7">
<li>To add permissions for Office 365 Exchange Online. Click “Add a permission”
under “APIs my organisation uses” search for “Office 365 Exchange Online”, then select “Application permissions”. Select and add the following permissions: ”full_access_as_app” &amp; “Exchange.ManageAsApp”.</li>
</ol>
<p><img loading="lazy" alt="Request API Permissions - Office 365 Exchange Online" src="/assets/images/Entra-API-Permissions3-62e396a22969073af8924d841c1f9ef3.png" width="466" height="370" class="img_ev3q"></p>
<p><img loading="lazy" alt="Request API Permissions - Office 365 Exchange Online" src="/assets/images/Entra-API-Permissions4-21da59f7d85044f656658cf7f19b6d78.png" width="841" height="669" class="img_ev3q"></p>
<ol start="8">
<li>How your permissions should look once added:</li>
</ol>
<p><img loading="lazy" alt="Request API Permissions - Configured Permissions" src="/assets/images/Entra-API-Configured-Permissions-76daf989812225a9dcf0de759037f3e4.png" width="1036" height="422" class="img_ev3q"></p>
<ol start="9">
<li>Once permissions are added you will need to “Grant Admin Consent”. This is done under Entra Admin Center &gt; Enterprise Applications. For further instructions see: <a href="https://learn.microsoft.com/en-us/entra/identity/enterprise-apps/grant-admin-consent?pivots=portal#grant-tenant-wide-admin-consent-in-enterprise-apps-pane" target="_blank" rel="noopener noreferrer">Grant Tenant-wide Admin Consent</a></li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="log-acquisition">Log Acquisition<a href="#log-acquisition" class="hash-link" aria-label="Direct link to Log Acquisition" title="Direct link to Log Acquisition">​</a></h3>
<p>Once the Microsoft Entra application and service principal has been set-up and configured in the Azure portal, these credentials need to be added to the Cado platform. To do this, navigate to ‘Settings’ &gt; ‘Integrations’ &gt; ‘Microsoft SaaS’ (/settings/integrations/microsoft) and select ‘Add Credential’. Enter the following details:</p>
<ul>
<li>Name (give this any friendly name, for example ‘MS SaaS’)</li>
<li>Tenant ID (this can be found in the ‘Directory (tenant) ID’ field in Azure app registration)</li>
<li>Client ID (this can be found in the ‘Application (client) ID’ field in Azure app registration)</li>
<li>Client Secret (this can be found in the ‘Client credentials’ field in Azure app registration)</li>
<li>Organization (organization value ending in .onmicrosoft.com)</li>
</ul>
<p><img loading="lazy" alt="MS SaaS - Add Creds" src="/assets/images/Microsoft-SaaS-Add-Creds-66b136364d7423f6f287cd03a4537e7d.png" width="3852" height="1808" class="img_ev3q"></p>
<p>We are now ready to acquire Microsoft 365 and Entra ID logs. Use the import wizard from within an investigation and select ‘SaaS’. The user will be presented with two options:</p>
<ul>
<li>Microsoft 365 Logs</li>
<li>Microsoft Entra ID</li>
</ul>
<p><img loading="lazy" alt="MS SaaS - Import" src="/assets/images/Microsoft-SaaS-Import-4d21c2b0df74f905be84cd26499ba408.png" width="1564" height="1122" class="img_ev3q"></p>
<p>Once a SaaS application is selected, the user will be required to select the credentials entered in the integrations page.</p>
<p><img loading="lazy" alt="MS SaaS - Import - Select Creds" src="/assets/images/Microsoft-SaaS-Import-Select-Creds-edcd199d04c64452ecc10e1e821f2340.png" width="5092" height="1116" class="img_ev3q"></p>
<p>Depending on the SaaS applications selected, the user will be presented with various options to refine the acquisition. For example, for M365 UAL acquisition, the user is able to refine by timeframe, user, IP, or workload.</p>
<p><img loading="lazy" alt="MS SaaS - Import - Config" src="/assets/images/Microsoft-SaaS-Import-Config-80234ed5c5835043fd3b46937bc1b674.png" width="3130" height="1498" class="img_ev3q"></p>
<p>Finally, the user is requested to review their selections and proceed with the import.</p>
<p>When the acquisition and processing is completed, the logs will be available to view and search in the main timeline page. To help users with their search and analysis, we have mapped the following fields to Cado fields:</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="m365-ual">M365 UAL<a href="#m365-ual" class="hash-link" aria-label="Direct link to M365 UAL" title="Direct link to M365 UAL">​</a></h4>
<table><thead><tr><th>UAL Field</th><th>Cado Field</th><th>Cado Facet Name</th></tr></thead><tbody><tr><td>ClientIP</td><td>source_hostname</td><td>Source Hostname</td></tr><tr><td>UserID</td><td>user</td><td>Users</td></tr><tr><td>Workload</td><td>sourcetype</td><td>Datatype</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="entra-id-audit-logs">Entra ID Audit Logs<a href="#entra-id-audit-logs" class="hash-link" aria-label="Direct link to Entra ID Audit Logs" title="Direct link to Entra ID Audit Logs">​</a></h4>
<table><thead><tr><th>Audit log field</th><th>Cado Field</th><th>Cado Facet Name</th></tr></thead><tbody><tr><td>InitiatedBy.User.IPAddress</td><td>source_hostname</td><td>Source Hostname</td></tr><tr><td>InitiatedBy.User.UserPrincipalName</td><td>user</td><td>Users</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="entra-id-sign-in-logs">Entra ID Sign-in Logs<a href="#entra-id-sign-in-logs" class="hash-link" aria-label="Direct link to Entra ID Sign-in Logs" title="Direct link to Entra ID Sign-in Logs">​</a></h4>
<table><thead><tr><th>Sign-in log field</th><th>Cado Field</th><th>Cado Facet Name</th></tr></thead><tbody><tr><td>IPAddress</td><td>source_hostname</td><td>Source Hostname</td></tr><tr><td>UserPrincipalName</td><td>user</td><td>Users</td></tr><tr><td>ResourceDisplayName</td><td>sourcetype</td><td>Datatype</td></tr></tbody></table>
<p>For example, the user is able to filter the dataset by the ‘AzureActiveDirectory’ workload by selecting this value in the ‘Datatype’ facet.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/cado-security/product-help/tree/master/docs/cado-response/discovery-import/import/m365-logs.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2024-06-13T15:04:08.000Z">Jun 13, 2024</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/cado-response/discovery-import/import/xdr"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">XDR Integrations</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/cado-response/export/intro"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Exporting Data</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#service-principal-set-up" class="table-of-contents__link toc-highlight">Service Principal Set-up</a></li><li><a href="#log-acquisition" class="table-of-contents__link toc-highlight">Log Acquisition</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/cadosecurity" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/cado-security" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 | Cado Security</div></div></div></footer></div>
</body>
</html>