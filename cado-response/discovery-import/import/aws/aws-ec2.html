<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-cado-response/discovery-import/import/aws/aws-ec2" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">EC2 and EBS | Cado Security</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.cadosecurity.com/cado-response/discovery-import/import/aws/aws-ec2"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="google-site-verification" content="j1fUKfw-LfBrYqXusMAoBbmCW8nSNobe8nOyfDl6xAY"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="EC2 and EBS | Cado Security"><meta data-rh="true" name="description" content="Cado supports acquisition of EC2 instances. Select the region, and this will populate a list of EC2 instances available. You can filter the list of instances and buckets by instance ID, name, state or public IP address. Select the instance you wish to acquire."><meta data-rh="true" property="og:description" content="Cado supports acquisition of EC2 instances. Select the region, and this will populate a list of EC2 instances available. You can filter the list of instances and buckets by instance ID, name, state or public IP address. Select the instance you wish to acquire."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.cadosecurity.com/cado-response/discovery-import/import/aws/aws-ec2"><link data-rh="true" rel="alternate" href="https://docs.cadosecurity.com/cado-response/discovery-import/import/aws/aws-ec2" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.cadosecurity.com/cado-response/discovery-import/import/aws/aws-ec2" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9BVXSKWB6Z"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-9BVXSKWB6Z",{})</script><link rel="stylesheet" href="/assets/css/styles.41c6a14a.css">
<script src="/assets/js/runtime~main.8c203d82.js" defer="defer"></script>
<script src="/assets/js/main.abff9436.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/cado.png" alt="Cado Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/cado-dark.png" alt="Cado Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"> </b></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/cado-response/intro">Cado Platform</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/intro">Summary</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/key-concepts">Key Concepts</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado-response/deploy/intro">Deployment</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/cado-response/discovery-import/intro">Import</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/intro">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/investigations">Managing Investigations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/automation">Detection Integrations (Beta)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/readiness">Readiness (Beta)</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/cado-response/discovery-import/import/intro">Importing Data</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/import/intro">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/import/import-from-cloud">Import from Cloud</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado-response/discovery-import/import/data-types/filetypes">Data Types</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/cado-response/discovery-import/import/aws/aws-ec2">AWS</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/cado-response/discovery-import/import/aws/aws-ec2">EC2 and EBS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/import/aws/aws-s3">S3</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/import/aws/aws-ami">AMI, EBS Snapshot and Volume</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/import/aws/aws-ecs">ECS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/import/aws/aws-eks">EKS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/import/aws/aws-lambda">Lambda</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/import/aws/memory">AWS Memory Analysis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/import/aws/aws-lightsail">Lightsail</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/import/aws/monitoring">Monitoring for Snapshots and Volumes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/import/aws/aws-china">AWS China</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado-response/discovery-import/import/azure/azure-compute">Azure</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado-response/discovery-import/import/gcp/engine-instance">GCP</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado-response/discovery-import/import/oracle/virtual-machine">Oracle</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/import/openshift">OpenShift</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/import/xdr">XDR Integrations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/import/google-workspace-logs">Google Workspace Logs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/import/m365-logs">Microsoft SaaS Logs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/import/third-party">Third Party Tools</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/chain_of_custody">Chain of Custody</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado-response/export/intro">Export</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado-response/investigate/intro">Investigating</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado-response/manage/logging-in">Manage</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado-response/community-edition/community-intro">Community Edition</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cado-host/intro">Cado Host</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/troubleshooting/faq">Troubleshooting</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/eula/commercial-eula">License Agreements</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/support-bulletins/role-update">Support Bulletins</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/release-notes">Release Notes</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Cado Platform</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Import</span><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Importing Data</span><meta itemprop="position" content="3"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">AWS</span><meta itemprop="position" content="4"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">EC2 and EBS</span><meta itemprop="position" content="5"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>AWS EC2 and EBS Support</h1>
<p>Cado supports acquisition of EC2 instances. Select the region, and this will populate a list of EC2 instances available. You can filter the list of instances and buckets by instance ID, name, state or public IP address. Select the instance you wish to acquire.</p>
<p><img loading="lazy" alt="AWS EC2 Import" src="/assets/images/aws-ec2-90029871d7a092c458840a666b860193.png" width="1782" height="682" class="img_ev3q"></p>
<p>Click on &quot;Continue&quot; .</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="capture-options">Capture Options<a href="#capture-options" class="hash-link" aria-label="Direct link to Capture Options" title="Direct link to Capture Options">​</a></h2>
<p>For volume capture, set the options for what data you want to capture.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="triage-capture">Triage Capture<a href="#triage-capture" class="hash-link" aria-label="Direct link to Triage Capture" title="Direct link to Triage Capture">​</a></h3>
<p>To perform a faster triage collection on an EC2 instance using Cado Host, select the button &#x27;Triage Acquisition&#x27;. Please note that this requires that SSM be enabled on the target instance. This will also collect memory from Linux systems.</p>
<p>For more information about about what Cado Host collects see <a href="/cado-host/artifacts">Collected Artifacts</a></p>
<p><img loading="lazy" alt="AWS EC2 Triage Acquisition " src="/assets/images/aws-ec2-triage-acquisition-4000535f4a0f1d726d46d8e287a22bf0.png" width="5112" height="1674" class="img_ev3q"></p>
<p>Click &#x27;Continue&#x27;, review your selections and click &#x27;Start Import&#x27;.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="triage-capture-using-use-ssm-port-forwarding-feature-linux-only">Triage Capture using Use SSM Port Forwarding feature (Linux only)<a href="#triage-capture-using-use-ssm-port-forwarding-feature-linux-only" class="hash-link" aria-label="Direct link to Triage Capture using Use SSM Port Forwarding feature (Linux only)" title="Direct link to Triage Capture using Use SSM Port Forwarding feature (Linux only)">​</a></h4>
<p>When selecting the ‘Triage Acquisition’ acquisition type for an EC2 instance, there is now an option to select ‘Use SSM Port Forwarding’. This is useful for EC2 instances (Linux only) that have restricted network access, meaning it’s problematic for them to download the Cado Host binary and transfer the resulting triage capture to the Cado S3 bucket. Using the SSM Port Forwarding feature means Cado will facilitate the transfer of the Cado Host binary onto the target resource and the resulting triage capture off the resource.</p>
<p><img loading="lazy" alt="AWS EC2 Triage Acquisition Port Forwarding" src="/assets/images/aws-ec2-triage-acquisition-ssm-port-forwarding-170c58d02a54ae9e2b41e8c1435e6abc.png" width="2557" height="836" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="run-command">Run Command<a href="#run-command" class="hash-link" aria-label="Direct link to Run Command" title="Direct link to Run Command">​</a></h3>
<p>The Cado platform allows you to execute a script on a target system using the ‘Run command’ action type in the import wizard. This functionality uses the <a href="https://docs.aws.amazon.com/systems-manager/latest/userguide/systems-manager-setting-up-ec2.html" target="_blank" rel="noopener noreferrer">AWS Systems Manager Agent (SSM)</a> and requires admin privileges. A script must be created in /settings/scripts to use this feature.</p>
<p><em>Note: This feature is in Beta - to enable the feature go to Settings &gt; Experiments &gt; Run Action</em></p>
<p><img loading="lazy" alt="AWS EC2 Run Command" src="/assets/images/aws-ec2-runcommand1-7764e292a16eb3d98940f9a32d65ca25.png" width="3542" height="1672" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="creating-a-saved-script">Creating a saved script<a href="#creating-a-saved-script" class="hash-link" aria-label="Direct link to Creating a saved script" title="Direct link to Creating a saved script">​</a></h4>
<p>To create a saved script, navigate to /settings/scripts and select the ‘Create script’ button. You will be prompted to choose whether the script is to be executed against a Linux or Windows system. For the purpose of the following example, we will choose Linux. <em>Note, there is reduced functionality for Windows scripts - more details can be found below.</em></p>
<p><img loading="lazy" alt="Saved Script" src="/assets/images/aws-ec2-runcommand2-288f66be5d4fb261f6207c93743a543f.png" width="3260" height="858" class="img_ev3q"></p>
<p>In this example, we will:</p>
<ul>
<li>Instruct Cado to download Volexity Surge from a predefined S3 location by specifying an “Input” file (Step 2)</li>
<li>Instruct Cado to upload the output of Volexity Surge to the Cado S3 bucket, by telling Cado where the “Output” file resides on the target system (Step 3)</li>
<li>Run Volexity Surge with the appropriate command line arguments by specifying a “Script” (Step 4)</li>
</ul>
<p>In Step 1, provide the script with a Name and Description.</p>
<p><img loading="lazy" alt="Saved Script - Step 1" src="/assets/images/aws-ec2-runcommand3-7257948f4bdb99d8aa66a885272d748e.png" width="3804" height="1082" class="img_ev3q"></p>
<p>In Step 2, provide the location of the file (valid S3 URI) that is to be downloaded onto the target system. In this example, it is the Volexity Surge binary, which is required to run the script. Cado will transfer this file onto the target system and this file can be referenced in the script using the variable <code>$INPUT</code>. <em>Note, this step is not available for Windows scripts.</em></p>
<p><img loading="lazy" alt="Saved Script - Step 2" src="/assets/images/aws-ec2-runcommand4-fceb04cb187da005d1315bab4eaf3312.png" width="3768" height="952" class="img_ev3q"></p>
<p>In Step 3, provide the location of a file which exists on the target system that is to be transferred to your Cado S3 bucket. In this example, it is the memory dump created by Volexity Surge. The file can be referenced in the script using the variable <code>$OUTPUT</code>. Note, this step is not available for Windows scripts.</p>
<p><img loading="lazy" alt="Saved Script - Step 3" src="/assets/images/aws-ec2-runcommand5-d2b458182764d522153cad1d21737b13.png" width="3782" height="950" class="img_ev3q"></p>
<p>In Step 4, paste the script that is to be executed on the target system. The input and output files from Steps 2 and 3 can be referenced using <code>${INPUT}</code> and <code>${OUTPUT}</code> respectively. Given input and output file support is only available for Linux scripts, reference of these variables is not required for Windows scripts.</p>
<p>The script included in the below screenshot is as follows:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir -p /tmp/cado-volexity</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cp ${INPUT} /tmp/cado-volexity/surge-collect</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chmod 755 /tmp/cado-volexity/surge-collect</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir -p /tmp/cado-volexity/out</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/tmp/cado-volexity/surge-collect seamlesstransaction /tmp/cado-volexity/out</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tar -cvzf /tmp/cado-volexity/out.tar.gz /tmp/cado-volexity/out</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cp &quot;/tmp/cado-volexity/out.tar.gz&quot; ${OUTPUT}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rm -rf /tmp/cado-volexity</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" alt="Saved Script - Step 4" src="/assets/images/aws-ec2-runcommand6-6639a15695b4a1c2c390bac386602bb0.png" width="1571" height="591" class="img_ev3q"></p>
<p>Finally, select ‘Continue’ and you should see the newly created script in the scripts table.</p>
<p><img loading="lazy" alt="Saved Script - Table" src="/assets/images/aws-ec2-runcommand7-a9f5882a4a8593e57c7cc2d7d573397d.png" width="3856" height="704" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="executing-the-script-using-run-command">Executing the script using Run command<a href="#executing-the-script-using-run-command" class="hash-link" aria-label="Direct link to Executing the script using Run command" title="Direct link to Executing the script using Run command">​</a></h4>
<p>Use the Import wizard to select an EC2 that has the SSM agent installed. Select the ‘Run command’ action type and you should now see the script that was created in the previous step. Continue with the import as normal.</p>
<p><img loading="lazy" alt="AWS EC2 Run Command - Selecting Saved Script" src="/assets/images/aws-ec2-runcommand8-086d386919e813238dd77de5830563d0.png" width="2557" height="766" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="data-flow-diagram">Data Flow Diagram<a href="#data-flow-diagram" class="hash-link" aria-label="Direct link to Data Flow Diagram" title="Direct link to Data Flow Diagram">​</a></h3>
<p>For a diagram of how our EC2 disk acquisitions operate, please see our <a href="https://cadosecurity.zendesk.com/hc/en-gb/articles/23258594209681-How-do-EC2-acquisitions-work-including-cross-account-and-the-IAM-role" target="_blank" rel="noopener noreferrer">Knowledge Base</a>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/cado-security/product-help/tree/master/docs/cado-response/discovery-import/import/aws/aws-ec2.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2024-10-07T10:52:02.000Z">Oct 7, 2024</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/cado-response/discovery-import/import/data-types/import-types"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Supported Import Types</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/cado-response/discovery-import/import/aws/aws-s3"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">S3</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#capture-options" class="table-of-contents__link toc-highlight">Capture Options</a><ul><li><a href="#triage-capture" class="table-of-contents__link toc-highlight">Triage Capture</a></li><li><a href="#run-command" class="table-of-contents__link toc-highlight">Run Command</a></li><li><a href="#data-flow-diagram" class="table-of-contents__link toc-highlight">Data Flow Diagram</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/cadosecurity" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/cado-security" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 | Cado Security</div></div></div></footer></div>
</body>
</html>