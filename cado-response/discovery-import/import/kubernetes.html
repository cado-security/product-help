<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-cado-response/discovery-import/import/kubernetes" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">Kubernetes imports | Cado Security</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.cadosecurity.com/cado-response/discovery-import/import/kubernetes"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="google-site-verification" content="j1fUKfw-LfBrYqXusMAoBbmCW8nSNobe8nOyfDl6xAY"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Kubernetes imports | Cado Security"><meta data-rh="true" name="description" content="How does Cado import data from EKS/ECS/AKS/GKE by default?"><meta data-rh="true" property="og:description" content="How does Cado import data from EKS/ECS/AKS/GKE by default?"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.cadosecurity.com/cado-response/discovery-import/import/kubernetes"><link data-rh="true" rel="alternate" href="https://docs.cadosecurity.com/cado-response/discovery-import/import/kubernetes" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.cadosecurity.com/cado-response/discovery-import/import/kubernetes" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9BVXSKWB6Z"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-9BVXSKWB6Z",{})</script><link rel="stylesheet" href="/assets/css/styles.97fa28ad.css">
<script src="/assets/js/runtime~main.bf4c4281.js" defer="defer"></script>
<script src="/assets/js/main.b47c5066.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/cado.png" alt="Cado Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/cado-dark.png" alt="Cado Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"> </b></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/cado-response/intro">Cado Platform</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/intro">What is Cado</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado-response/deploy/aws/cloudformation">Deployment</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/cado-response/discovery-import/intro">Import</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/intro">Import Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/investigations">Managing Investigations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/automation">Detection Integrations (Beta)</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/cado-response/discovery-import/import/intro">Importing Data</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/import/intro">Import Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/import/import-from-cloud">Import from Cloud</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado-response/discovery-import/import/data-types/filetypes">Data Types</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado-response/discovery-import/import/aws/aws-ec2">AWS</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado-response/discovery-import/import/azure/azure-compute">Azure</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado-response/discovery-import/import/gcp/engine-instance">GCP</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado-response/discovery-import/import/oracle/virtual-machine">Oracle</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/import/openshift">OpenShift</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/cado-response/discovery-import/import/kubernetes">Kubernetes imports</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/import/xdr">XDR integrations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/import/google-workspace-logs">Google Workspace logs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/import/m365-logs">Microsoft SaaS logs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/import/third-party">Third party tools</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cado-response/discovery-import/chain_of_custody">Chain of Custody</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado-response/export/intro">Export</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado-response/investigate/intro">Investigating</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado-response/manage/logging-in">Manage</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cado-response/community-edition/community-intro">Community Edition</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cado-host/intro">Cado Host</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/troubleshooting/get-support">Help &amp; Support</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/eula/commercial-eula">License Agreements</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/release-notes">Release Notes</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Cado Platform</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Import</span><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Importing Data</span><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Kubernetes imports</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>How to import data from Kubernetes</h1>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-does-cado-import-data-from-eksecsaksgke-by-default">How does Cado import data from EKS/ECS/AKS/GKE by default?<a href="#how-does-cado-import-data-from-eksecsaksgke-by-default" class="hash-link" aria-label="Direct link to How does Cado import data from EKS/ECS/AKS/GKE by default?" title="Direct link to How does Cado import data from EKS/ECS/AKS/GKE by default?">​</a></h2>
<p>When acquiring data from Kubernetes containers:</p>
<ul>
<li>Cado executes a shell script to download the Cado Host binary; then</li>
<li>Runs it to collect forensic artifacts; then</li>
<li>Uploads the collected files to cloud storage for processing.</li>
</ul>
<p>How this shell script is executed will depend upon the environment.
For example ECS utilizes ECS execute, whereas EKS/AKS/GKE <a href="https://www.cadosecurity.com/how-we-sped-up-acquiring-forensic-data-from-aws-kubernetes-and-azure-kubernetes-services-by-10-times/" target="_blank" rel="noopener noreferrer">utilize</a> the Kubernetes control plane API.</p>
<p>Depending upon the service, authenticating to the Kubernetes API may require both IAM and Kubernetes RBAC permissions.
These permissions are described on the service specific documentation pages.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="alternate-collection-by-acquiring-the-volume-of-the-node">Alternate Collection by Acquiring the Volume of the Node<a href="#alternate-collection-by-acquiring-the-volume-of-the-node" class="hash-link" aria-label="Direct link to Alternate Collection by Acquiring the Volume of the Node" title="Direct link to Alternate Collection by Acquiring the Volume of the Node">​</a></h2>
<p>If you cannot execute code inside the container, or cannot connect over the network, you may be able to process the Volume of the node running the container.
For example, this approach is possible for EKS running on a cluster of EC2 nodes.
If using the Docker container runtime, the file system of containers will normally be available at /var/lib/docker/overlay2.
If using the Containerd runtime (which the latest versions of EKS now uses), the file system will not be immediately visible on the Volume.
We are currently working on a method to support containerd Volume acquisitions of containerd based Nodes.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="alternate-collection-by-using-cado-host-with-a-sidecar-container">Alternate Collection by using Cado Host with a sidecar container<a href="#alternate-collection-by-using-cado-host-with-a-sidecar-container" class="hash-link" aria-label="Direct link to Alternate Collection by using Cado Host with a sidecar container" title="Direct link to Alternate Collection by using Cado Host with a sidecar container">​</a></h2>
<p>The Cado platform now supports collections from private cluster and distroless containers, by using a <a href="https://kubernetes.io/docs/reference/kubectl/generated/kubectl_debug/" target="_blank" rel="noopener noreferrer">debug container</a>.</p>
<p>To acquire:</p>
<ul>
<li>Navigate to ‘Import’ then ‘Cado Host’.</li>
<li>Select ‘Kubernetes’ and follow the prompts to acquire:</li>
</ul>
<p><img loading="lazy" alt="Cado Host K8s UI" src="/assets/images/cado-host-k8s-23084060a6831b74364501915fb14261.png" width="479" height="569" class="img_ev3q"></p>
<p>Please see the diagram below for a high-level flow of how this works:</p>
<p><img loading="lazy" alt="Cado Host K8s Flow" src="/assets/images/kubernetes-flow-18ae17c971f13d1b240b72e76b9126ac.png" width="1600" height="861" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="kubernetes-rbac-requirements">Kubernetes RBAC Requirements<a href="#kubernetes-rbac-requirements" class="hash-link" aria-label="Direct link to Kubernetes RBAC Requirements" title="Direct link to Kubernetes RBAC Requirements">​</a></h3>
<p>Cado requires both write and execute access to containers, in order to download and execute the Cado Host binary to collect forensic artifacts from side containers.
In particular, Cado requires ‘get’ and ‘list’ for the ‘pods’ resource, and ‘get’ and ‘create’ for the ‘pods/exec’ resource.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-a-custom-image">Using A Custom Image<a href="#using-a-custom-image" class="hash-link" aria-label="Direct link to Using A Custom Image" title="Direct link to Using A Custom Image">​</a></h3>
<p>In environments that don’t support using the default debian<!-- -->:latest<!-- --> container image, you can choose to use a custom image instead. This expects the latest Cado Host Linux binary to exist at /tmp/cado-host-static/cado-host.
We strongly recommend using the default debian<!-- -->:latest<!-- --> image as Cado can provide support if you encounter issues when acquiring using the default debian<!-- -->:latest<!-- --> image - we are unable to provide support for custom images.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="root-access">Root Access<a href="#root-access" class="hash-link" aria-label="Direct link to Root Access" title="Direct link to Root Access">​</a></h3>
<p>By default, Cado Host requires root access in order to access the underlying container filesystem, usually under <code>/proc/{PID}/root</code>. The use of <code>runuser</code> with the root user is also required as to give the Cado Host process the appropriate UID and GID to access the container filesystem.</p>
<p>If you are running Kubernetes v1.30 or later, you can optionally use the &quot;Run as non-root user&quot; option to instead use the <a href="https://kubernetes.io/docs/tasks/debug/debug-application/debug-running-pod/" target="_blank" rel="noopener noreferrer">sysadmin</a> profile, which has the necessary permissions to access the container filesystem.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="private-clusters-with-no-network-access">Private Clusters with No Network Access<a href="#private-clusters-with-no-network-access" class="hash-link" aria-label="Direct link to Private Clusters with No Network Access" title="Direct link to Private Clusters with No Network Access">​</a></h2>
<p>As the Cado platform requires access to the Kubernetes control plane API for normal acquisition methods, acquiring containers via the user interface requires a valid route at the network level from the Cado instance to the Kubernetes API.
See below for alternate options for acquiring data where the Cado platform cannot access the Kubernetes API.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="private-aks-clusters">Private AKS Clusters<a href="#private-aks-clusters" class="hash-link" aria-label="Direct link to Private AKS Clusters" title="Direct link to Private AKS Clusters">​</a></h3>
<p>Cado can acquire private AKS environments using the normal user interface, as Azure has created the “command invoke” command to execute commands against private AKS clusters.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="private-gke-clusters">Private GKE Clusters<a href="#private-gke-clusters" class="hash-link" aria-label="Direct link to Private GKE Clusters" title="Direct link to Private GKE Clusters">​</a></h3>
<p>We are investigating support for private GKE clusters using the normal user interface, through public endpoints on private clusters.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="private-eks-clusters">Private EKS Clusters<a href="#private-eks-clusters" class="hash-link" aria-label="Direct link to Private EKS Clusters" title="Direct link to Private EKS Clusters">​</a></h3>
<p>As of March 2019, you can now also configure your EKS cluster to be only accessible from private networks such as the VPC the cluster resides in or any peered VPCs.</p>
<p>If you create an EKS cluster with the “Private endpoint only” option (<a href="https://aws.amazon.com/blogs/containers/de-mystifying-cluster-networking-for-amazon-eks-worker-nodes/" target="_blank" rel="noopener noreferrer">https://aws.amazon.com/blogs/containers/de-mystifying-cluster-networking-for-amazon-eks-worker-nodes/</a>), all traffic to your cluster API server must come from within your cluster’s VPC or a connected network.
There is no public access to your API server from the internet.
Any kubectl commands must come from within the VPC or a connected network.</p>
<p>The default Cado EKS acquisition interface requires access to the Cluster endpoint from the Cado platform.
If the Cado platform doesn&#x27;t have access to the Cluster endpoint via a public endpoint or another method such as peered VPCs (<a href="https://docs.aws.amazon.com/vpc/latest/userguide/vpc-peering.html" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/vpc/latest/userguide/vpc-peering.html</a>), you can use the option &quot;Alternate Private EKS Cluster Access&quot; below.
Note that if you are running EKS on EC2 nodes, it may be easier to use the &quot;Alternate Collection by Acquiring the Volume of the Node&quot; option above.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="alternate-private-eks-cluster-access">Alternate Private EKS Cluster Access<a href="#alternate-private-eks-cluster-access" class="hash-link" aria-label="Direct link to Alternate Private EKS Cluster Access" title="Direct link to Alternate Private EKS Cluster Access">​</a></h4>
<p>If the Cado platform cannot access the Cluster endpoint, you can instead acquire via deploying the Cado Host acquisition script.</p>
<p>First connect to your EKS cluster with a command such as:</p>
<ul>
<li>aws eks update-kubeconfig --region $Region --name $ClusterName
To execute this command, please follow the instructions from AWS <a href="https://docs.aws.amazon.com/eks/latest/userguide/install-kubectl.html" target="_blank" rel="noopener noreferrer">here</a>.</li>
</ul>
<p>Then, execute the kubectl script generated at Import &gt; Cado Host &gt; Kubernetes.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="methods-for-executing-kubernetes-api-commands-inside-a-private-cluster-vpc">Methods for Executing Kubernetes API Commands Inside a Private Cluster VPC<a href="#methods-for-executing-kubernetes-api-commands-inside-a-private-cluster-vpc" class="hash-link" aria-label="Direct link to Methods for Executing Kubernetes API Commands Inside a Private Cluster VPC" title="Direct link to Methods for Executing Kubernetes API Commands Inside a Private Cluster VPC">​</a></h4>
<p>Alternate options include Bastion Hosts, SSM, AWS Private link, AWS Cloud9, AWS VPN, AWS Direct Connect.
See the links below for options for accessin the Kubernetes API within the Private Cluster VPC.</p>
<p>How to connect using a Bastion Host:</p>
<ul>
<li><a href="https://cloudtipss.com/Create-Private-EKS-With-Bastion/" target="_blank" rel="noopener noreferrer">https://cloudtipss.com/Create-Private-EKS-With-Bastion/</a></li>
<li><a href="https://medium.com/@muppedaanvesh/jump-box-setup-on-eks-cluster-383ca92f51ef" target="_blank" rel="noopener noreferrer">https://medium.com/@muppedaanvesh/jump-box-setup-on-eks-cluster-383ca92f51ef</a> (Terraform)</li>
<li><a href="https://stackoverflow.com/questions/75207618/how-is-eks-cluster-accessible-when-deployed-in-a-private-subnet" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/75207618/how-is-eks-cluster-accessible-when-deployed-in-a-private-subnet</a></li>
</ul>
<p>How to connect using SSM, optionally via a Bastion host or direct to the Node:</p>
<ul>
<li><a href="https://awstip.com/securely-connect-to-a-private-eks-cluster-using-aws-ssm-session-forwarding-systems-manager-5d0767edea61" target="_blank" rel="noopener noreferrer">https://awstip.com/securely-connect-to-a-private-eks-cluster-using-aws-ssm-session-forwarding-systems-manager-5d0767edea61</a></li>
<li><a href="https://stackoverflow.com/questions/70827578/how-do-we-access-the-kubernetes-api-server-with-kubectl-from-a-private-eks-clust" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/70827578/how-do-we-access-the-kubernetes-api-server-with-kubectl-from-a-private-eks-clust</a></li>
<li><a href="https://help.gopaddle.io/manage-pre-existing-clusters/register-pre-existing-cluster/register-aws-eks-cluster/eks-cluster-with-private-access-endpoint-and-a-bastion-host" target="_blank" rel="noopener noreferrer">https://help.gopaddle.io/manage-pre-existing-clusters/register-pre-existing-cluster/register-aws-eks-cluster/eks-cluster-with-private-access-endpoint-and-a-bastion-host</a></li>
</ul>
<p>How to connect to the VPC using via VPN or similar:</p>
<ul>
<li><a href="https://docs.aws.amazon.com/vpc/latest/userguide/vpn-connections.html" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/vpc/latest/userguide/vpn-connections.html</a></li>
<li><a href="https://hodovi.cc/blog/private-eks-api-endpoint-behind-openvpn/" target="_blank" rel="noopener noreferrer">https://hodovi.cc/blog/private-eks-api-endpoint-behind-openvpn/</a> (OpenVPN)</li>
<li><a href="https://docs.aws.amazon.com/whitepapers/latest/aws-vpc-connectivity-options/aws-direct-connect.html" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/whitepapers/latest/aws-vpc-connectivity-options/aws-direct-connect.html</a> (DirectConnect)</li>
</ul>
<p>How to connect using Private Link:</p>
<ul>
<li><a href="https://docs.zeet.co/guides/advanced/eks-privatelink/" target="_blank" rel="noopener noreferrer">https://docs.zeet.co/guides/advanced/eks-privatelink/</a></li>
<li><a href="https://docs.aws.amazon.com/eks/latest/userguide/vpc-interface-endpoints.html" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/eks/latest/userguide/vpc-interface-endpoints.html</a></li>
</ul>
<p>How to connect using Cloud9:</p>
<ul>
<li><a href="https://stackoverflow.com/questions/65049271/how-to-connect-to-eks-cluster-from-cloud-9-instance-using-kubectl" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/65049271/how-to-connect-to-eks-cluster-from-cloud-9-instance-using-kubectl</a></li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/cado-security/product-help/tree/master/docs/cado-response/discovery-import/import/kubernetes.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2024-10-09T16:00:38.000Z">Oct 9, 2024</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/cado-response/discovery-import/import/openshift"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">RedHat Openshift</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/cado-response/discovery-import/import/xdr"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">XDR integrations</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#how-does-cado-import-data-from-eksecsaksgke-by-default" class="table-of-contents__link toc-highlight">How does Cado import data from EKS/ECS/AKS/GKE by default?</a></li><li><a href="#alternate-collection-by-acquiring-the-volume-of-the-node" class="table-of-contents__link toc-highlight">Alternate Collection by Acquiring the Volume of the Node</a></li><li><a href="#alternate-collection-by-using-cado-host-with-a-sidecar-container" class="table-of-contents__link toc-highlight">Alternate Collection by using Cado Host with a sidecar container</a><ul><li><a href="#kubernetes-rbac-requirements" class="table-of-contents__link toc-highlight">Kubernetes RBAC Requirements</a></li><li><a href="#using-a-custom-image" class="table-of-contents__link toc-highlight">Using A Custom Image</a></li><li><a href="#root-access" class="table-of-contents__link toc-highlight">Root Access</a></li></ul></li><li><a href="#private-clusters-with-no-network-access" class="table-of-contents__link toc-highlight">Private Clusters with No Network Access</a><ul><li><a href="#private-aks-clusters" class="table-of-contents__link toc-highlight">Private AKS Clusters</a></li><li><a href="#private-gke-clusters" class="table-of-contents__link toc-highlight">Private GKE Clusters</a></li><li><a href="#private-eks-clusters" class="table-of-contents__link toc-highlight">Private EKS Clusters</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/cadosecurity" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/cado-security" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 | Cado Security</div></div></div></footer></div>
</body>
</html>